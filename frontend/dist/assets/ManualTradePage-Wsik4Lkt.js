import{d8 as f,d9 as Y,da as Z,db as ee,cW as i,cX as t}from"./index-ZNJTT0gP.js";var z={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},W=f.createContext&&f.createContext(z),te=["attr","size","title"];function re(e,r){if(e==null)return{};var a=ae(e,r),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function ae(e,r){if(e==null)return{};var a={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(r.indexOf(n)>=0)continue;a[n]=e[n]}return a}function j(){return j=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},j.apply(this,arguments)}function H(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),a.push.apply(a,n)}return a}function v(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?H(Object(a),!0).forEach(function(n){ne(e,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):H(Object(a)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))})}return e}function ne(e,r,a){return r=se(r),r in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function se(e){var r=ie(e,"string");return typeof r=="symbol"?r:r+""}function ie(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var n=a.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function X(e){return e&&e.map((r,a)=>f.createElement(r.tag,v({key:a},r.attr),X(r.child)))}function le(e){return r=>f.createElement(oe,j({attr:v({},e.attr)},r),X(e.child))}function oe(e){var r=a=>{var{attr:n,size:o,title:l}=e,w=re(e,te),u=o||a.size||"1em",h;return a.className&&(h=a.className),e.className&&(h=(h?h+" ":"")+e.className),f.createElement("svg",j({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},a.attr,n,w,{className:h,style:v(v({color:e.color||a.color},a.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),l&&f.createElement("title",null,l),e.children)};return W!==void 0?f.createElement(W.Consumer,null,a=>r(a)):r(z)}function ce(e){return le({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]}]})(e)}const $="https://arbitrage-app1.fly.dev",de=`${$}/api/simulate-trade`,ue=`${$}/api/prepare-trade`,pe={"base-mainnet":"https://basescan.org","base-sepolia":"https://sepolia.basescan.org"},N={base:{WETH:"0x4200000000000000000000000000000000000006",USDC:"0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913",cbBTC:"0xcbB7C0000aB88B473b1f5aFd9ef808440eed33Bf",DAI:"0x50c5725949a6f0c72e6c4a641f24049a917db0cb",DEGEN:"0x4ed4e862860bed51a9570b96d89af5e1b0efefed",BRETT:"0x532f27101965dd16442e59d40670faf2ebb144e4",AERO:"0x940181a94a35a4569e4529a3cdfb74e38fd98631"}},m=["Aerodrome","PancakeSwap"],he=()=>{var L,I,U;const{network:e}=Y(),{user:r}=Z(),{wallets:a}=ee(),[n,o]=i.useState(((L=N[e])==null?void 0:L.USDC)||""),[l,w]=i.useState(""),[u,h]=i.useState("1000"),[b,M]=i.useState(m[0]),[x,F]=i.useState(m[1]),[T,C]=i.useState(!1),[D,y]=i.useState(null),[E,P]=i.useState(null),[A,R]=i.useState(!1),[c,k]=i.useState(null),[_,O]=i.useState(null),G=s=>{const p=s.target.value;M(p),F(p===m[0]?m[1]:m[0])},J=i.useCallback(async()=>{if(!n||!l||!u){O("Please fill in all fields.");return}R(!0),O(null),k(null);try{const p=await fetch(de,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({network:e,tokenA:n,tokenB:l,loanAmount:u,dex1:b,dex2:x})});if(!p.ok){const d=await p.json();throw new Error(d.message||"Simulation failed")}const g=await p.json();k(g)}catch(s){O(s.message)}finally{R(!1)}},[e,n,l,u,b,x]),K=async()=>{if(!c||!c.isProfitable){y("No profitable trade to execute.");return}C(!0),y(null),P(null);try{const s=a[0];if(!s)throw new Error("No wallet connected.");const p={network:e,tokenA:n,tokenB:l,loanAmount:u,userAddress:r.wallet.address,dex1:b,dex2:x},g=await fetch(ue,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!g.ok){const Q=await g.json();throw new Error(Q.message||"Failed to prepare trade")}const{unsignedTx:d}=await g.json(),q=await(await s.getEthersProvider()).getSigner();d.gasPrice&&(d.gasPrice=BigInt(d.gasPrice)),d.gasLimit&&(d.gasLimit=BigInt(d.gasLimit));const S=await q.sendTransaction(d);P({txHash:S.hash,status:"pending"}),await S.wait(),P({txHash:S.hash,status:"success",profit:"View on explorer"})}catch(s){console.error("Execution Error:",s),y(s.message||"An unexpected error occurred.")}finally{C(!1)}},B=c&&c.isProfitable,V=pe[e]||"https://basescan.org";return t.jsxs("div",{className:"manual-trade-container",children:[t.jsxs("div",{className:"manual-trade-header",children:[t.jsx("h3",{children:"Manual Arbitrage"}),(r==null?void 0:r.wallet)&&t.jsxs("p",{className:"wallet-address",children:[r.wallet.address.substring(0,6),"...",r.wallet.address.substring(r.wallet.address.length-4)]})]}),t.jsxs("div",{className:"trade-form",children:[t.jsxs("div",{className:"input-group",children:[t.jsx("label",{children:"Borrow"}),t.jsxs("div",{className:"token-input",children:[t.jsxs("select",{value:n,onChange:s=>o(s.target.value),children:[t.jsx("option",{value:(I=N[e])==null?void 0:I.USDC,children:"USDC"}),t.jsx("option",{value:(U=N[e])==null?void 0:U.WETH,children:"WETH"})]}),t.jsx("input",{type:"number",value:u,onChange:s=>h(s.target.value),placeholder:"Amount"})]})]}),t.jsxs("div",{className:"input-group",children:[t.jsx("label",{children:"Target Token"}),t.jsxs("div",{className:"token-input",children:[t.jsx("input",{type:"text",value:l,onChange:s=>w(s.target.value),placeholder:"Paste token address"}),t.jsx("button",{onClick:J,disabled:A,className:"search-button",children:t.jsx(ce,{})})]})]}),t.jsxs("div",{className:"dex-selection",children:[t.jsxs("div",{className:"input-group",children:[t.jsx("label",{children:"Input DEX"}),t.jsx("select",{value:b,onChange:G,children:m.map(s=>t.jsx("option",{value:s,children:s},s))})]}),t.jsxs("div",{className:"input-group",children:[t.jsx("label",{children:"Output DEX"}),t.jsx("select",{value:x,disabled:!0,children:t.jsx("option",{value:x,children:x})})]})]})]}),A&&t.jsx("div",{className:"loading-message",children:"Scanning for opportunities..."}),_&&t.jsx("div",{className:"error-message",children:_}),c&&t.jsxs("div",{className:"trade-info",children:[t.jsx("h4",{children:"Arbitrage Opportunity"}),t.jsxs("p",{children:[t.jsx("span",{children:"Path:"})," ",t.jsx("span",{children:c.bestDexPath})]}),t.jsxs("p",{children:[t.jsx("span",{children:"Estimated Profit:"})," ",t.jsx("span",{className:B?"text-success":"text-danger",children:c.estimatedProfit})]}),t.jsxs("p",{children:[t.jsx("span",{children:"Gas Cost:"})," ",t.jsx("span",{children:c.gasCost})]}),t.jsxs("p",{children:[t.jsx("span",{children:"Slippage:"})," ",t.jsx("span",{children:c.slippage})]}),t.jsx("button",{onClick:K,disabled:T||!B,className:"trade-button",children:T?"Executing...":"Execute Trade"})]}),D&&t.jsx("div",{className:"error-message",children:D}),E&&t.jsxs("div",{className:"trade-info",children:[t.jsx("h4",{children:E.status==="pending"?"Transaction Sent!":"Trade Executed!"}),t.jsxs("p",{children:[t.jsx("span",{children:"Transaction:"})," ",t.jsx("a",{href:`${V}/tx/${E.txHash}`,target:"_blank",rel:"noopener noreferrer",children:"View on Explorer"})]})]})]})},me=()=>t.jsx(he,{});export{me as default};
