import{u as G,n as K,b as W,r as n,j as e}from"./index.DdH5x3BZ.js";const R=void 0;throw new Error("Fatal Error: VITE_API_URL is not set in the production environment.");const Y=`${R}/api/simulate-trade`,q=`${R}/api/prepare-trade`,z={"base-mainnet":"https://basescan.org","base-sepolia":"https://sepolia.basescan.org"},C={base:{WETH:"0x4200000000000000000000000000000000000006",USDC:"0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913",cbBTC:"0xcbB7C0000aB88B473b1f5aFd9ef808440eed33Bf",DAI:"0x50c5725949a6f0c72e6c4a641f24049a917db0cb",DEGEN:"0x4ed4e862860bed51a9570b96d89af5e1b0efefed",BRETT:"0x532f27101965dd16442e59d40670faf2ebb144e4",AERO:"0x940181a94a35a4569e4529a3cdfb74e38fd98631"}},u=["Aerodrome","PancakeSwap"],Q=()=>{const{network:h}=G(),{user:L}=K(),{wallets:$}=W(),[i,F]=n.useState(C[h]?.USDC||""),[o,O]=n.useState(""),[l,N]=n.useState("1000"),[x,B]=n.useState(u[0]),[p,w]=n.useState(u[1]),[f,I]=n.useState(!0),[v,P]=n.useState(!1),[T,j]=n.useState(null),[g,S]=n.useState(null),[y,A]=n.useState(!1),[a,k]=n.useState(null),[D,E]=n.useState(null),b=t=>{const s=Object.entries(C[h]||{});for(const[r,c]of s)if(c.toLowerCase()===t.toLowerCase())return r;return t.substring(0,6)},_=t=>{const s=t.target.value;B(s),w(s===u[0]?u[1]:u[0])},U=n.useCallback(async()=>{if(!i||!o||!l){E("Please fill in all fields.");return}A(!0),E(null),k(null);try{const s=await fetch(Y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({network:h,tokenA:i,tokenB:o,loanAmount:l,dex1:x,dex2:p,stable:f})});if(!s.ok){const c=await s.json();throw new Error(c.message||"Simulation failed")}const r=await s.json();k(r)}catch(t){E(t.message)}finally{A(!1)}},[h,i,o,l,x,p,f]),H=async()=>{if(!a||!a.isProfitable){j("No profitable trade to execute.");return}P(!0),j(null),S(null);const t=async s=>{try{await fetch("/api/manual-trade-history",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})}catch(r){console.error("Failed to save manual trade history:",r)}};try{const s=$[0];if(!s)throw new Error("No wallet connected.");const r={network:h,tokenA:i,tokenB:o,loanAmount:l,userAddress:L.wallet.address,dex1:x,dex2:p,bestFee1:a.bestFee1,bestFee2:a.bestFee2,stable:f},c=await fetch(q,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!c.ok){const J=await c.json();throw new Error(J.message||"Failed to prepare trade")}const{unsignedTx:d}=await c.json(),V=await(await s.getEthersProvider()).getSigner();d.gasPrice&&(d.gasPrice=BigInt(d.gasPrice)),d.gasLimit&&(d.gasLimit=BigInt(d.gasLimit));const m=await V.sendTransaction(d);S({txHash:m.hash,status:"pending"}),await m.wait(),S({txHash:m.hash,status:"success",profit:"View on explorer"}),await t({timestamp:new Date().toISOString(),pair:`${b(i)} -> ${b(o)}`,route:`${x} -> ${p}`,loanAmount:`${l} ${b(i)}`,status:"Success",actualProfit:a.estimatedProfit,txHash:m.hash,error:null})}catch(s){console.error("Execution Error:",s);const r=s.message||"An unexpected error occurred.";j(r),await t({timestamp:new Date().toISOString(),pair:`${b(i)} -> ${b(o)}`,route:`${x} -> ${p}`,loanAmount:`${l} ${b(i)}`,status:"Failed",actualProfit:"N/A",txHash:null,error:r})}finally{P(!1)}},X=a&&a.isProfitable,M=z[h]||"https://basescan.org";return e.jsxs("div",{id:"manual-trade-container",children:[e.jsx("h2",{id:"manual-trade-header",children:"Manual Arbitrage"}),e.jsxs("div",{id:"token-input-section-a",children:[e.jsx("label",{children:"Loan Token"}),e.jsx("input",{type:"text",value:i,onChange:t=>F(t.target.value)})]}),e.jsxs("div",{id:"token-input-section-b",children:[e.jsx("label",{children:"Target Token"}),e.jsx("input",{type:"text",value:o,onChange:t=>O(t.target.value)})]}),e.jsxs("div",{id:"loan-amount-section",children:[e.jsx("label",{children:"Loan Amount"}),e.jsx("input",{type:"text",value:l,onChange:t=>N(t.target.value)})]}),e.jsxs("div",{id:"dex-selection-section",children:[e.jsxs("div",{children:[e.jsx("label",{children:"DEX 1"}),e.jsx("select",{value:x,onChange:_,children:u.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{children:"DEX 2"}),e.jsx("select",{value:p,onChange:t=>w(t.target.value),children:u.map(t=>e.jsx("option",{value:t,children:t},t))})]})]}),e.jsxs("div",{id:"volatile-swap-section",children:[e.jsx("input",{type:"checkbox",id:"volatile-swap",checked:!f,onChange:t=>I(!t.target.checked)}),e.jsx("label",{htmlFor:"volatile-swap",children:"Volatile Swap"})]}),e.jsx("button",{onClick:U,disabled:y,id:"simulate-trade-button",children:y?"Simulating...":"Simulate Trade"}),D&&e.jsxs("p",{id:"simulation-error",children:["Simulation Error: ",D]}),a&&e.jsxs("div",{id:"simulation-result-container",children:[e.jsx("h3",{children:"Simulation Result"}),e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{children:"Estimated Profit:"})," ",e.jsx("span",{className:a.isProfitable?"text-success-color":"text-error-color",children:a.estimatedProfit})]}),e.jsxs("div",{children:[e.jsx("span",{children:"Is Profitable:"})," ",e.jsx("span",{className:a.isProfitable?"text-success-color":"text-error-color",children:a.isProfitable?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("span",{children:"Fee (DEX 1):"})," ",e.jsx("span",{children:a.bestFee1})]}),e.jsxs("div",{children:[e.jsx("span",{children:"Fee (DEX 2):"})," ",e.jsx("span",{children:a.bestFee2})]})]}),X&&e.jsx("button",{onClick:H,disabled:v,id:"execute-trade-button",children:v?"Executing...":"Execute Trade"})]}),T&&e.jsxs("p",{id:"execution-error",children:["Execution Error: ",T]}),g&&e.jsxs("div",{id:"result-container",children:[e.jsxs("p",{children:["Status: ",g.status]}),e.jsx("a",{href:`${M}/tx/${g.txH}`,children:"View on Explorer"})]})]})},te=()=>e.jsx(Q,{});export{te as default};
