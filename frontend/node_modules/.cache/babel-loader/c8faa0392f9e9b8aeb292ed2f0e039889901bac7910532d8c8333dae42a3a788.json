{"ast":null,"code":"import { getClientFetch } from \"../utils/fetch.js\";\nimport { resolveScheme } from \"../utils/ipfs.js\";\nimport { IS_TEST } from \"../utils/process.js\";\nimport { getFromMockStorage } from \"./mock.js\";\n/**\n * Downloads a file from the specified IPFS, Arweave, or HTTP URI.\n *\n * `download` will parse the provided URI based on its scheme (ipfs://, ar://, https://) and convert it to a URL to fetch the file from thirdweb's storage service.\n *\n * @param options - The download options.\n * @param options.client - The Thirdweb client. See [createThirdwebClient](https://portal.thirdweb.com/references/typescript/v5/createThirdwebClient).\n * @param options.uri - The URI of the file to download. Can be IPFS, Arweave, or HTTP.\n * @param [options.requestTimeoutMs] - The maximum time in milliseconds to wait for the request to complete. Defaults to 60 seconds (60,000 milliseconds).\n *\n * @returns Asynchronously returns the network response from fetching the file.\n * @throws An error if the URI scheme is invalid or if the request fails.\n *\n * @example\n * Download a file from IPFS:\n * ```ts\n * import { download } from \"thirdweb/storage\";\n * import { createThirdwebClient } from \"thirdweb\";\n *\n * const client = createThirdwebClient({ clientId: \"YOUR_CLIENT_ID\" });\n *\n * const file = await download({\n *  client,\n *  uri: \"ipfs://Qm...\",\n * });\n * ```\n *\n * Download a file from Arweave:\n * ```ts\n * import { download } from \"thirdweb/storage\";\n * import { createThirdwebClient } from \"thirdweb\";\n *\n * const client = createThirdwebClient({ clientId: \"YOUR_CLIENT_ID\" });\n *\n * const file = await download({\n *  client,\n *  uri: \"ar://{arweave-transaction-id}\",\n * });\n * ```\n *\n * Download a file from HTTP:\n * ```ts\n * import { download } from \"thirdweb/storage\";\n * import { createThirdwebClient } from \"thirdweb\";\n *\n * const client = createThirdwebClient({ clientId: \"YOUR_CLIENT_ID\" });\n *\n * const file = await download({\n *  client,\n *  uri: \"https://example.com/file.txt\",\n * });\n * ```\n *\n * @storage\n */\nexport async function download(options) {\n  var _options$client$confi, _options$client$confi2, _ref, _options$requestTimeo, _options$client$confi3;\n  if (IS_TEST) {\n    const hash = options.uri.split(\"://\")[1];\n    if (!hash) {\n      throw new Error(\"Invalid hash\");\n    }\n    const data = getFromMockStorage(hash);\n    if (data) {\n      return {\n        json: () => Promise.resolve(data),\n        ok: true,\n        status: 200\n      };\n    }\n  }\n  let url;\n  if (options.uri.startsWith(\"ar://\")) {\n    const {\n      resolveArweaveScheme\n    } = await import(\"../utils/arweave.js\");\n    url = resolveArweaveScheme(options);\n  } else {\n    url = resolveScheme(options);\n  }\n  const res = await getClientFetch(options.client)(url, {\n    headers: (_options$client$confi = options.client.config) === null || _options$client$confi === void 0 || (_options$client$confi = _options$client$confi.storage) === null || _options$client$confi === void 0 || (_options$client$confi = _options$client$confi.fetch) === null || _options$client$confi === void 0 ? void 0 : _options$client$confi.headers,\n    keepalive: (_options$client$confi2 = options.client.config) === null || _options$client$confi2 === void 0 || (_options$client$confi2 = _options$client$confi2.storage) === null || _options$client$confi2 === void 0 || (_options$client$confi2 = _options$client$confi2.fetch) === null || _options$client$confi2 === void 0 ? void 0 : _options$client$confi2.keepalive,\n    requestTimeoutMs: (_ref = (_options$requestTimeo = options.requestTimeoutMs) !== null && _options$requestTimeo !== void 0 ? _options$requestTimeo : (_options$client$confi3 = options.client.config) === null || _options$client$confi3 === void 0 || (_options$client$confi3 = _options$client$confi3.storage) === null || _options$client$confi3 === void 0 || (_options$client$confi3 = _options$client$confi3.fetch) === null || _options$client$confi3 === void 0 ? void 0 : _options$client$confi3.requestTimeoutMs) !== null && _ref !== void 0 ? _ref : 60000\n  });\n  if (!res.ok) {\n    const error = await res.text();\n    throw new Error(\"Failed to download file: \".concat(res.status, \" \").concat(res.statusText, \" \").concat(error || \"\"));\n  }\n  return res;\n}","map":{"version":3,"names":["getClientFetch","resolveScheme","IS_TEST","getFromMockStorage","download","options","_options$client$confi","_options$client$confi2","_ref","_options$requestTimeo","_options$client$confi3","hash","uri","split","Error","data","json","Promise","resolve","ok","status","url","startsWith","resolveArweaveScheme","res","client","headers","config","storage","fetch","keepalive","requestTimeoutMs","error","text","concat","statusText"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/storage/download.ts"],"sourcesContent":["import { getClientFetch } from \"../utils/fetch.js\";\nimport { type ResolveSchemeOptions, resolveScheme } from \"../utils/ipfs.js\";\nimport { IS_TEST } from \"../utils/process.js\";\nimport type { Prettify } from \"../utils/type-utils.js\";\nimport { getFromMockStorage } from \"./mock.js\";\n\nexport type DownloadOptions = Prettify<\n  ResolveSchemeOptions & {\n    requestTimeoutMs?: number;\n  }\n>;\n\n/**\n * Downloads a file from the specified IPFS, Arweave, or HTTP URI.\n *\n * `download` will parse the provided URI based on its scheme (ipfs://, ar://, https://) and convert it to a URL to fetch the file from thirdweb's storage service.\n *\n * @param options - The download options.\n * @param options.client - The Thirdweb client. See [createThirdwebClient](https://portal.thirdweb.com/references/typescript/v5/createThirdwebClient).\n * @param options.uri - The URI of the file to download. Can be IPFS, Arweave, or HTTP.\n * @param [options.requestTimeoutMs] - The maximum time in milliseconds to wait for the request to complete. Defaults to 60 seconds (60,000 milliseconds).\n *\n * @returns Asynchronously returns the network response from fetching the file.\n * @throws An error if the URI scheme is invalid or if the request fails.\n *\n * @example\n * Download a file from IPFS:\n * ```ts\n * import { download } from \"thirdweb/storage\";\n * import { createThirdwebClient } from \"thirdweb\";\n *\n * const client = createThirdwebClient({ clientId: \"YOUR_CLIENT_ID\" });\n *\n * const file = await download({\n *  client,\n *  uri: \"ipfs://Qm...\",\n * });\n * ```\n *\n * Download a file from Arweave:\n * ```ts\n * import { download } from \"thirdweb/storage\";\n * import { createThirdwebClient } from \"thirdweb\";\n *\n * const client = createThirdwebClient({ clientId: \"YOUR_CLIENT_ID\" });\n *\n * const file = await download({\n *  client,\n *  uri: \"ar://{arweave-transaction-id}\",\n * });\n * ```\n *\n * Download a file from HTTP:\n * ```ts\n * import { download } from \"thirdweb/storage\";\n * import { createThirdwebClient } from \"thirdweb\";\n *\n * const client = createThirdwebClient({ clientId: \"YOUR_CLIENT_ID\" });\n *\n * const file = await download({\n *  client,\n *  uri: \"https://example.com/file.txt\",\n * });\n * ```\n *\n * @storage\n */\nexport async function download(options: DownloadOptions) {\n  if (IS_TEST) {\n    const hash = options.uri.split(\"://\")[1];\n    if (!hash) {\n      throw new Error(\"Invalid hash\");\n    }\n    const data = getFromMockStorage(hash);\n    if (data) {\n      return {\n        json: () => Promise.resolve(data),\n        ok: true,\n        status: 200,\n      } as Response;\n    }\n  }\n\n  let url: string;\n  if (options.uri.startsWith(\"ar://\")) {\n    const { resolveArweaveScheme } = await import(\"../utils/arweave.js\");\n    url = resolveArweaveScheme(options);\n  } else {\n    url = resolveScheme(options);\n  }\n\n  const res = await getClientFetch(options.client)(url, {\n    headers: options.client.config?.storage?.fetch?.headers,\n    keepalive: options.client.config?.storage?.fetch?.keepalive,\n    requestTimeoutMs:\n      options.requestTimeoutMs ??\n      options.client.config?.storage?.fetch?.requestTimeoutMs ??\n      60000,\n  });\n\n  if (!res.ok) {\n    const error = await res.text();\n    throw new Error(\n      `Failed to download file: ${res.status} ${res.statusText} ${error || \"\"}`,\n    );\n  }\n  return res;\n}\n"],"mappings":"AAAA,SAASA,cAAc,QAAQ,mBAAmB;AAClD,SAAoCC,aAAa,QAAQ,kBAAkB;AAC3E,SAASC,OAAO,QAAQ,qBAAqB;AAE7C,SAASC,kBAAkB,QAAQ,WAAW;AAQ9C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuDA,OAAO,eAAeC,QAAQA,CAACC,OAAwB;EAAA,IAAAC,qBAAA,EAAAC,sBAAA,EAAAC,IAAA,EAAAC,qBAAA,EAAAC,sBAAA;EACrD,IAAIR,OAAO,EAAE;IACX,MAAMS,IAAI,GAAGN,OAAO,CAACO,GAAG,CAACC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IACxC,IAAI,CAACF,IAAI,EAAE;MACT,MAAM,IAAIG,KAAK,CAAC,cAAc,CAAC;IACjC;IACA,MAAMC,IAAI,GAAGZ,kBAAkB,CAACQ,IAAI,CAAC;IACrC,IAAII,IAAI,EAAE;MACR,OAAO;QACLC,IAAI,EAAEA,CAAA,KAAMC,OAAO,CAACC,OAAO,CAACH,IAAI,CAAC;QACjCI,EAAE,EAAE,IAAI;QACRC,MAAM,EAAE;OACG;IACf;EACF;EAEA,IAAIC,GAAW;EACf,IAAIhB,OAAO,CAACO,GAAG,CAACU,UAAU,CAAC,OAAO,CAAC,EAAE;IACnC,MAAM;MAAEC;IAAoB,CAAE,GAAG,MAAM,MAAM,CAAC,qBAAqB,CAAC;IACpEF,GAAG,GAAGE,oBAAoB,CAAClB,OAAO,CAAC;EACrC,CAAC,MAAM;IACLgB,GAAG,GAAGpB,aAAa,CAACI,OAAO,CAAC;EAC9B;EAEA,MAAMmB,GAAG,GAAG,MAAMxB,cAAc,CAACK,OAAO,CAACoB,MAAM,CAAC,CAACJ,GAAG,EAAE;IACpDK,OAAO,GAAApB,qBAAA,GAAED,OAAO,CAACoB,MAAM,CAACE,MAAM,cAAArB,qBAAA,gBAAAA,qBAAA,GAArBA,qBAAA,CAAuBsB,OAAO,cAAAtB,qBAAA,gBAAAA,qBAAA,GAA9BA,qBAAA,CAAgCuB,KAAK,cAAAvB,qBAAA,uBAArCA,qBAAA,CAAuCoB,OAAO;IACvDI,SAAS,GAAAvB,sBAAA,GAAEF,OAAO,CAACoB,MAAM,CAACE,MAAM,cAAApB,sBAAA,gBAAAA,sBAAA,GAArBA,sBAAA,CAAuBqB,OAAO,cAAArB,sBAAA,gBAAAA,sBAAA,GAA9BA,sBAAA,CAAgCsB,KAAK,cAAAtB,sBAAA,uBAArCA,sBAAA,CAAuCuB,SAAS;IAC3DC,gBAAgB,GAAAvB,IAAA,IAAAC,qBAAA,GACdJ,OAAO,CAAC0B,gBAAgB,cAAAtB,qBAAA,cAAAA,qBAAA,IAAAC,sBAAA,GACxBL,OAAO,CAACoB,MAAM,CAACE,MAAM,cAAAjB,sBAAA,gBAAAA,sBAAA,GAArBA,sBAAA,CAAuBkB,OAAO,cAAAlB,sBAAA,gBAAAA,sBAAA,GAA9BA,sBAAA,CAAgCmB,KAAK,cAAAnB,sBAAA,uBAArCA,sBAAA,CAAuCqB,gBAAgB,cAAAvB,IAAA,cAAAA,IAAA,GACvD;GACH,CAAC;EAEF,IAAI,CAACgB,GAAG,CAACL,EAAE,EAAE;IACX,MAAMa,KAAK,GAAG,MAAMR,GAAG,CAACS,IAAI,EAAE;IAC9B,MAAM,IAAInB,KAAK,6BAAAoB,MAAA,CACeV,GAAG,CAACJ,MAAM,OAAAc,MAAA,CAAIV,GAAG,CAACW,UAAU,OAAAD,MAAA,CAAIF,KAAK,IAAI,EAAE,CAAE,CAC1E;EACH;EACA,OAAOR,GAAG;AACZ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}