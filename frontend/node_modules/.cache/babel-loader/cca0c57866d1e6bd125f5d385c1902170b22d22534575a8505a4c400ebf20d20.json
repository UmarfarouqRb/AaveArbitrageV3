{"ast":null,"code":"import { getThirdwebBaseUrl } from \"../../../../utils/domains.js\";\nimport { getClientFetch } from \"../../../../utils/fetch.js\";\nimport { stringify } from \"../../../../utils/json.js\";\nexport async function signAuthorization(_ref) {\n  let {\n    client,\n    payload,\n    storage\n  } = _ref;\n  const authToken = await storage.getAuthCookie();\n  const ecosystem = storage.ecosystem;\n  const clientFetch = getClientFetch(client, ecosystem);\n  if (!authToken) {\n    throw new Error(\"No auth token found when signing message\");\n  }\n  const body = {\n    address: payload.address,\n    chainId: payload.chainId,\n    nonce: Number(payload.nonce)\n  };\n  const response = await clientFetch(\"\".concat(getThirdwebBaseUrl(\"inAppWallet\"), \"/api/v1/enclave-wallet/sign-authorization\"), {\n    body: stringify(body),\n    headers: {\n      Authorization: \"Bearer embedded-wallet-token:\".concat(authToken),\n      \"Content-Type\": \"application/json\",\n      \"x-thirdweb-client-id\": client.clientId\n    },\n    method: \"POST\"\n  });\n  if (!response.ok) {\n    throw new Error(\"Failed to sign message - \".concat(response.status, \" \").concat(response.statusText));\n  }\n  const signedAuthorization = await response.json();\n  return signedAuthorization;\n}","map":{"version":3,"names":["getThirdwebBaseUrl","getClientFetch","stringify","signAuthorization","_ref","client","payload","storage","authToken","getAuthCookie","ecosystem","clientFetch","Error","body","address","chainId","nonce","Number","response","concat","headers","Authorization","clientId","method","ok","status","statusText","signedAuthorization","json"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/wallets/in-app/core/actions/sign-authorization.enclave.ts"],"sourcesContent":["import type { ThirdwebClient } from \"../../../../client/client.js\";\nimport type { AuthorizationRequest } from \"../../../../transaction/actions/eip7702/authorization.js\";\nimport { getThirdwebBaseUrl } from \"../../../../utils/domains.js\";\nimport { getClientFetch } from \"../../../../utils/fetch.js\";\nimport { stringify } from \"../../../../utils/json.js\";\nimport type { ClientScopedStorage } from \"../authentication/client-scoped-storage.js\";\n\nexport async function signAuthorization({\n  client,\n  payload,\n  storage,\n}: {\n  client: ThirdwebClient;\n  payload: AuthorizationRequest;\n  storage: ClientScopedStorage;\n}) {\n  const authToken = await storage.getAuthCookie();\n  const ecosystem = storage.ecosystem;\n  const clientFetch = getClientFetch(client, ecosystem);\n\n  if (!authToken) {\n    throw new Error(\"No auth token found when signing message\");\n  }\n\n  const body = {\n    address: payload.address,\n    chainId: payload.chainId,\n    nonce: Number(payload.nonce),\n  };\n\n  const response = await clientFetch(\n    `${getThirdwebBaseUrl(\"inAppWallet\")}/api/v1/enclave-wallet/sign-authorization`,\n    {\n      body: stringify(body),\n      headers: {\n        Authorization: `Bearer embedded-wallet-token:${authToken}`,\n        \"Content-Type\": \"application/json\",\n        \"x-thirdweb-client-id\": client.clientId,\n      },\n      method: \"POST\",\n    },\n  );\n\n  if (!response.ok) {\n    throw new Error(\n      `Failed to sign message - ${response.status} ${response.statusText}`,\n    );\n  }\n\n  const signedAuthorization = (await response.json()) as {\n    r: string;\n    s: string;\n    yParity: string;\n    nonce: string;\n    address: string;\n    chainId: string;\n  };\n  return signedAuthorization;\n}\n"],"mappings":"AAEA,SAASA,kBAAkB,QAAQ,8BAA8B;AACjE,SAASC,cAAc,QAAQ,4BAA4B;AAC3D,SAASC,SAAS,QAAQ,2BAA2B;AAGrD,OAAO,eAAeC,iBAAiBA,CAAAC,IAAA,EAQtC;EAAA,IARuC;IACtCC,MAAM;IACNC,OAAO;IACPC;EAAO,CAKR,GAAAH,IAAA;EACC,MAAMI,SAAS,GAAG,MAAMD,OAAO,CAACE,aAAa,EAAE;EAC/C,MAAMC,SAAS,GAAGH,OAAO,CAACG,SAAS;EACnC,MAAMC,WAAW,GAAGV,cAAc,CAACI,MAAM,EAAEK,SAAS,CAAC;EAErD,IAAI,CAACF,SAAS,EAAE;IACd,MAAM,IAAII,KAAK,CAAC,0CAA0C,CAAC;EAC7D;EAEA,MAAMC,IAAI,GAAG;IACXC,OAAO,EAAER,OAAO,CAACQ,OAAO;IACxBC,OAAO,EAAET,OAAO,CAACS,OAAO;IACxBC,KAAK,EAAEC,MAAM,CAACX,OAAO,CAACU,KAAK;GAC5B;EAED,MAAME,QAAQ,GAAG,MAAMP,WAAW,IAAAQ,MAAA,CAC7BnB,kBAAkB,CAAC,aAAa,CAAC,gDACpC;IACEa,IAAI,EAAEX,SAAS,CAACW,IAAI,CAAC;IACrBO,OAAO,EAAE;MACPC,aAAa,kCAAAF,MAAA,CAAkCX,SAAS,CAAE;MAC1D,cAAc,EAAE,kBAAkB;MAClC,sBAAsB,EAAEH,MAAM,CAACiB;KAChC;IACDC,MAAM,EAAE;GACT,CACF;EAED,IAAI,CAACL,QAAQ,CAACM,EAAE,EAAE;IAChB,MAAM,IAAIZ,KAAK,6BAAAO,MAAA,CACeD,QAAQ,CAACO,MAAM,OAAAN,MAAA,CAAID,QAAQ,CAACQ,UAAU,CAAE,CACrE;EACH;EAEA,MAAMC,mBAAmB,GAAI,MAAMT,QAAQ,CAACU,IAAI,EAO/C;EACD,OAAOD,mBAAmB;AAC5B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}