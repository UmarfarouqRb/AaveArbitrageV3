{"ast":null,"code":"import { BaseError } from '../../errors/base.js';\nimport { fromHex, fromRlp, hexToBigInt, hexToNumber } from '../../utils/index.js';\nexport function parseEip712Transaction(transaction) {\n  const payload = fromHex(transaction, 'bytes');\n  if (payload[0] !== 113) throw new BaseError('transaction type must be eip712');\n  function validHex(value) {\n    if (!value || value === '0x') return '0x0';\n    return value;\n  }\n  function parsePaymasterArray(arr) {\n    if (arr.length === 0) return undefined;\n    if (arr.length !== 2) throw new BaseError(\"Invalid paymaster parameters, expected to have length of 2, found \".concat(arr.length, \"!\"));\n    return {\n      paymaster: arr[0],\n      paymasterInput: arr[1]\n    };\n  }\n  const raw = fromRlp(payload.slice(1));\n  const paymasterParams = parsePaymasterArray(raw[15]);\n  return {\n    type: 'eip712',\n    nonce: hexToNumber(validHex(raw[0])),\n    maxPriorityFeePerGas: hexToBigInt(validHex(raw[1])),\n    maxFeePerGas: hexToBigInt(validHex(raw[2])),\n    gas: hexToBigInt(validHex(raw[3])),\n    to: raw[4],\n    value: hexToBigInt(validHex(raw[5])),\n    data: raw[6],\n    v: hexToBigInt(validHex(raw[7])),\n    r: raw[8],\n    s: raw[9],\n    chainId: hexToNumber(validHex(raw[10])),\n    from: raw[11],\n    gasPerPubdata: hexToBigInt(validHex(raw[12])),\n    factoryDeps: raw[13],\n    customSignature: raw[14],\n    paymaster: paymasterParams === null || paymasterParams === void 0 ? void 0 : paymasterParams.paymaster,\n    paymasterInput: paymasterParams === null || paymasterParams === void 0 ? void 0 : paymasterParams.paymasterInput\n  };\n}","map":{"version":3,"names":["BaseError","fromHex","fromRlp","hexToBigInt","hexToNumber","parseEip712Transaction","transaction","payload","validHex","value","parsePaymasterArray","arr","length","undefined","concat","paymaster","paymasterInput","raw","slice","paymasterParams","type","nonce","maxPriorityFeePerGas","maxFeePerGas","gas","to","data","v","r","s","chainId","from","gasPerPubdata","factoryDeps","customSignature"],"sources":["/home/user/Arbitrage/frontend/node_modules/viem/zksync/utils/parseEip712Transaction.ts"],"sourcesContent":["import { BaseError } from '../../errors/base.js'\nimport type { Hex } from '../../types/misc.js'\nimport {\n  fromHex,\n  fromRlp,\n  hexToBigInt,\n  hexToNumber,\n} from '../../utils/index.js'\nimport type { ZksyncTransactionSerializableEIP712 } from '../types/transaction.js'\n\nexport function parseEip712Transaction(\n  transaction: Hex,\n): ZksyncTransactionSerializableEIP712 {\n  const payload = fromHex(transaction, 'bytes')\n  if (payload[0] !== 113) throw new BaseError('transaction type must be eip712')\n\n  function validHex(value: Hex): Hex {\n    if (!value || value === '0x') return '0x0'\n    return value\n  }\n\n  function parsePaymasterArray(arr: Hex[]) {\n    if (arr.length === 0) return undefined\n    if (arr.length !== 2)\n      throw new BaseError(\n        `Invalid paymaster parameters, expected to have length of 2, found ${arr.length}!`,\n      )\n\n    return {\n      paymaster: arr[0],\n      paymasterInput: arr[1],\n    }\n  }\n\n  const raw = fromRlp(payload.slice(1)) as Hex[]\n  const paymasterParams = parsePaymasterArray(raw[15] as unknown as Hex[])\n  return {\n    type: 'eip712',\n    nonce: hexToNumber(validHex(raw[0])),\n    maxPriorityFeePerGas: hexToBigInt(validHex(raw[1])),\n    maxFeePerGas: hexToBigInt(validHex(raw[2])),\n    gas: hexToBigInt(validHex(raw[3])),\n    to: raw[4],\n    value: hexToBigInt(validHex(raw[5])),\n    data: raw[6],\n    v: hexToBigInt(validHex(raw[7])),\n    r: raw[8],\n    s: raw[9],\n    chainId: hexToNumber(validHex(raw[10])),\n    from: raw[11],\n    gasPerPubdata: hexToBigInt(validHex(raw[12])),\n    factoryDeps: raw[13] as unknown as Hex[],\n    customSignature: raw[14],\n    paymaster: paymasterParams?.paymaster,\n    paymasterInput: paymasterParams?.paymasterInput,\n  }\n}\n"],"mappings":"AAAA,SAASA,SAAS,QAAQ,sBAAsB;AAEhD,SACEC,OAAO,EACPC,OAAO,EACPC,WAAW,EACXC,WAAW,QACN,sBAAsB;AAG7B,OAAM,SAAUC,sBAAsBA,CACpCC,WAAgB;EAEhB,MAAMC,OAAO,GAAGN,OAAO,CAACK,WAAW,EAAE,OAAO,CAAC;EAC7C,IAAIC,OAAO,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE,MAAM,IAAIP,SAAS,CAAC,iCAAiC,CAAC;EAE9E,SAASQ,QAAQA,CAACC,KAAU;IAC1B,IAAI,CAACA,KAAK,IAAIA,KAAK,KAAK,IAAI,EAAE,OAAO,KAAK;IAC1C,OAAOA,KAAK;EACd;EAEA,SAASC,mBAAmBA,CAACC,GAAU;IACrC,IAAIA,GAAG,CAACC,MAAM,KAAK,CAAC,EAAE,OAAOC,SAAS;IACtC,IAAIF,GAAG,CAACC,MAAM,KAAK,CAAC,EAClB,MAAM,IAAIZ,SAAS,sEAAAc,MAAA,CACoDH,GAAG,CAACC,MAAM,MAAG,CACnF;IAEH,OAAO;MACLG,SAAS,EAAEJ,GAAG,CAAC,CAAC,CAAC;MACjBK,cAAc,EAAEL,GAAG,CAAC,CAAC;KACtB;EACH;EAEA,MAAMM,GAAG,GAAGf,OAAO,CAACK,OAAO,CAACW,KAAK,CAAC,CAAC,CAAC,CAAU;EAC9C,MAAMC,eAAe,GAAGT,mBAAmB,CAACO,GAAG,CAAC,EAAE,CAAqB,CAAC;EACxE,OAAO;IACLG,IAAI,EAAE,QAAQ;IACdC,KAAK,EAAEjB,WAAW,CAACI,QAAQ,CAACS,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IACpCK,oBAAoB,EAAEnB,WAAW,CAACK,QAAQ,CAACS,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IACnDM,YAAY,EAAEpB,WAAW,CAACK,QAAQ,CAACS,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3CO,GAAG,EAAErB,WAAW,CAACK,QAAQ,CAACS,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAClCQ,EAAE,EAAER,GAAG,CAAC,CAAC,CAAC;IACVR,KAAK,EAAEN,WAAW,CAACK,QAAQ,CAACS,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IACpCS,IAAI,EAAET,GAAG,CAAC,CAAC,CAAC;IACZU,CAAC,EAAExB,WAAW,CAACK,QAAQ,CAACS,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAChCW,CAAC,EAAEX,GAAG,CAAC,CAAC,CAAC;IACTY,CAAC,EAAEZ,GAAG,CAAC,CAAC,CAAC;IACTa,OAAO,EAAE1B,WAAW,CAACI,QAAQ,CAACS,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;IACvCc,IAAI,EAAEd,GAAG,CAAC,EAAE,CAAC;IACbe,aAAa,EAAE7B,WAAW,CAACK,QAAQ,CAACS,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;IAC7CgB,WAAW,EAAEhB,GAAG,CAAC,EAAE,CAAqB;IACxCiB,eAAe,EAAEjB,GAAG,CAAC,EAAE,CAAC;IACxBF,SAAS,EAAEI,eAAe,aAAfA,eAAe,uBAAfA,eAAe,CAAEJ,SAAS;IACrCC,cAAc,EAAEG,eAAe,aAAfA,eAAe,uBAAfA,eAAe,CAAEH;GAClC;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}