{"ast":null,"code":"import { decodeEventLog, isAddressEqual } from '../../../utils/index.js';\nimport { zksyncAbi } from '../../constants/abis.js';\nimport { TxHashNotFoundInLogsError } from '../../errors/bridge.js';\n/**\n * Returns the hash of the L2 priority operation from a given L1 transaction receipt.\n *\n * @param receipt - The L1 transaction receipt.\n * @param zksync - The address of the ZKsync Era main contract.\n * @returns hash - The hash of the L2 priority operation.\n *\n * @example\n * import { createPublicClient, http } from 'viem'\n * import { zksync, mainnet } from 'viem/chains'\n * import { publicActionsL2, getL2HashFromPriorityOp } from 'viem/zksync'\n *\n * const client = createPublicClient({\n *   chain: mainnet,\n *   transport: http(),\n * })\n *\n * const zksyncClient = const client = createPublicClient({\n *   chain: zksync,\n *   transport: http(),\n * })\n *\n * const receipt = await client.waitForTransactionReceipt({hash: '0x...'})\n * const l2Hash = getL2HashFromPriorityOp(\n *   receipt,\n *   await zksyncClient.getMainContractAddress()\n * )\n */\nexport function getL2HashFromPriorityOp(receipt, zksync) {\n  let hash = null;\n  for (const log of receipt.logs) {\n    if (!isAddressEqual(log.address, zksync)) continue;\n    try {\n      const priorityQueueLog = decodeEventLog({\n        abi: zksyncAbi,\n        data: log.data,\n        topics: log.topics\n      });\n      if (priorityQueueLog && priorityQueueLog.args.txHash !== null) hash = priorityQueueLog.args.txHash;\n    } catch (_e) {}\n  }\n  if (!hash) {\n    throw new TxHashNotFoundInLogsError();\n  }\n  return hash;\n}","map":{"version":3,"names":["decodeEventLog","isAddressEqual","zksyncAbi","TxHashNotFoundInLogsError","getL2HashFromPriorityOp","receipt","zksync","hash","log","logs","address","priorityQueueLog","abi","data","topics","args","txHash","_e"],"sources":["/home/user/Arbitrage/frontend/node_modules/viem/zksync/utils/bridge/getL2HashFromPriorityOp.ts"],"sourcesContent":["import type { Address } from 'abitype'\nimport type { Hash } from '../../../types/misc.js'\nimport type { TransactionReceipt } from '../../../types/transaction.js'\nimport { decodeEventLog, isAddressEqual } from '../../../utils/index.js'\nimport { zksyncAbi } from '../../constants/abis.js'\nimport {\n  TxHashNotFoundInLogsError,\n  type TxHashNotFoundInLogsErrorType,\n} from '../../errors/bridge.js'\n\nexport type GetL2HashFromPriorityOpErrorType = TxHashNotFoundInLogsErrorType\n\n/**\n * Returns the hash of the L2 priority operation from a given L1 transaction receipt.\n *\n * @param receipt - The L1 transaction receipt.\n * @param zksync - The address of the ZKsync Era main contract.\n * @returns hash - The hash of the L2 priority operation.\n *\n * @example\n * import { createPublicClient, http } from 'viem'\n * import { zksync, mainnet } from 'viem/chains'\n * import { publicActionsL2, getL2HashFromPriorityOp } from 'viem/zksync'\n *\n * const client = createPublicClient({\n *   chain: mainnet,\n *   transport: http(),\n * })\n *\n * const zksyncClient = const client = createPublicClient({\n *   chain: zksync,\n *   transport: http(),\n * })\n *\n * const receipt = await client.waitForTransactionReceipt({hash: '0x...'})\n * const l2Hash = getL2HashFromPriorityOp(\n *   receipt,\n *   await zksyncClient.getMainContractAddress()\n * )\n */\nexport function getL2HashFromPriorityOp(\n  receipt: TransactionReceipt,\n  zksync: Address,\n): Address {\n  let hash: Hash | null = null\n  for (const log of receipt.logs) {\n    if (!isAddressEqual(log.address, zksync)) continue\n    try {\n      const priorityQueueLog = decodeEventLog({\n        abi: zksyncAbi,\n        data: log.data,\n        topics: log.topics,\n      })\n      if (priorityQueueLog && (priorityQueueLog.args as any).txHash !== null)\n        hash = (priorityQueueLog.args as any).txHash\n    } catch (_e) {}\n  }\n\n  if (!hash) {\n    throw new TxHashNotFoundInLogsError()\n  }\n  return hash\n}\n"],"mappings":"AAGA,SAASA,cAAc,EAAEC,cAAc,QAAQ,yBAAyB;AACxE,SAASC,SAAS,QAAQ,yBAAyB;AACnD,SACEC,yBAAyB,QAEpB,wBAAwB;AAI/B;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA,OAAM,SAAUC,uBAAuBA,CACrCC,OAA2B,EAC3BC,MAAe;EAEf,IAAIC,IAAI,GAAgB,IAAI;EAC5B,KAAK,MAAMC,GAAG,IAAIH,OAAO,CAACI,IAAI,EAAE;IAC9B,IAAI,CAACR,cAAc,CAACO,GAAG,CAACE,OAAO,EAAEJ,MAAM,CAAC,EAAE;IAC1C,IAAI;MACF,MAAMK,gBAAgB,GAAGX,cAAc,CAAC;QACtCY,GAAG,EAAEV,SAAS;QACdW,IAAI,EAAEL,GAAG,CAACK,IAAI;QACdC,MAAM,EAAEN,GAAG,CAACM;OACb,CAAC;MACF,IAAIH,gBAAgB,IAAKA,gBAAgB,CAACI,IAAY,CAACC,MAAM,KAAK,IAAI,EACpET,IAAI,GAAII,gBAAgB,CAACI,IAAY,CAACC,MAAM;IAChD,CAAC,CAAC,OAAOC,EAAE,EAAE,CAAC;EAChB;EAEA,IAAI,CAACV,IAAI,EAAE;IACT,MAAM,IAAIJ,yBAAyB,EAAE;EACvC;EACA,OAAOI,IAAI;AACb","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}