{"ast":null,"code":"import { getThirdwebBaseUrl } from \"../../../../utils/domains.js\";\nimport { getClientFetch } from \"../../../../utils/fetch.js\";\nimport { stringify } from \"../../../../utils/json.js\";\nexport async function signTransaction(_ref) {\n  let {\n    client,\n    payload,\n    storage\n  } = _ref;\n  const authToken = await storage.getAuthCookie();\n  const ecosystem = storage.ecosystem;\n  const clientFetch = getClientFetch(client, ecosystem);\n  if (!authToken) {\n    throw new Error(\"No auth token found when signing transaction\");\n  }\n  const response = await clientFetch(\"\".concat(getThirdwebBaseUrl(\"inAppWallet\"), \"/api/v1/enclave-wallet/sign-transaction\"), {\n    body: stringify({\n      transactionPayload: payload\n    }),\n    headers: {\n      Authorization: \"Bearer embedded-wallet-token:\".concat(authToken),\n      \"Content-Type\": \"application/json\",\n      \"x-thirdweb-client-id\": client.clientId\n    },\n    method: \"POST\"\n  });\n  if (!response.ok) {\n    throw new Error(\"Failed to sign transaction - \".concat(response.status, \" \").concat(response.statusText));\n  }\n  const signedTransaction = await response.json();\n  return signedTransaction.signature;\n}","map":{"version":3,"names":["getThirdwebBaseUrl","getClientFetch","stringify","signTransaction","_ref","client","payload","storage","authToken","getAuthCookie","ecosystem","clientFetch","Error","response","concat","body","transactionPayload","headers","Authorization","clientId","method","ok","status","statusText","signedTransaction","json","signature"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/wallets/in-app/core/actions/sign-transaction.enclave.ts"],"sourcesContent":["import type { ThirdwebClient } from \"../../../../client/client.js\";\nimport { getThirdwebBaseUrl } from \"../../../../utils/domains.js\";\nimport type { Hex } from \"../../../../utils/encoding/hex.js\";\nimport { getClientFetch } from \"../../../../utils/fetch.js\";\nimport { stringify } from \"../../../../utils/json.js\";\nimport type { ClientScopedStorage } from \"../authentication/client-scoped-storage.js\";\n\nexport async function signTransaction({\n  client,\n  payload,\n  storage,\n}: {\n  client: ThirdwebClient;\n  payload: Record<string, unknown>;\n  storage: ClientScopedStorage;\n}) {\n  const authToken = await storage.getAuthCookie();\n  const ecosystem = storage.ecosystem;\n  const clientFetch = getClientFetch(client, ecosystem);\n\n  if (!authToken) {\n    throw new Error(\"No auth token found when signing transaction\");\n  }\n\n  const response = await clientFetch(\n    `${getThirdwebBaseUrl(\"inAppWallet\")}/api/v1/enclave-wallet/sign-transaction`,\n    {\n      body: stringify({\n        transactionPayload: payload,\n      }),\n      headers: {\n        Authorization: `Bearer embedded-wallet-token:${authToken}`,\n        \"Content-Type\": \"application/json\",\n        \"x-thirdweb-client-id\": client.clientId,\n      },\n      method: \"POST\",\n    },\n  );\n\n  if (!response.ok) {\n    throw new Error(\n      `Failed to sign transaction - ${response.status} ${response.statusText}`,\n    );\n  }\n\n  const signedTransaction = (await response.json()) as {\n    r: string;\n    s: string;\n    v: number;\n    signature: string;\n    hash: string;\n  };\n  return signedTransaction.signature as Hex;\n}\n"],"mappings":"AACA,SAASA,kBAAkB,QAAQ,8BAA8B;AAEjE,SAASC,cAAc,QAAQ,4BAA4B;AAC3D,SAASC,SAAS,QAAQ,2BAA2B;AAGrD,OAAO,eAAeC,eAAeA,CAAAC,IAAA,EAQpC;EAAA,IARqC;IACpCC,MAAM;IACNC,OAAO;IACPC;EAAO,CAKR,GAAAH,IAAA;EACC,MAAMI,SAAS,GAAG,MAAMD,OAAO,CAACE,aAAa,EAAE;EAC/C,MAAMC,SAAS,GAAGH,OAAO,CAACG,SAAS;EACnC,MAAMC,WAAW,GAAGV,cAAc,CAACI,MAAM,EAAEK,SAAS,CAAC;EAErD,IAAI,CAACF,SAAS,EAAE;IACd,MAAM,IAAII,KAAK,CAAC,8CAA8C,CAAC;EACjE;EAEA,MAAMC,QAAQ,GAAG,MAAMF,WAAW,IAAAG,MAAA,CAC7Bd,kBAAkB,CAAC,aAAa,CAAC,8CACpC;IACEe,IAAI,EAAEb,SAAS,CAAC;MACdc,kBAAkB,EAAEV;KACrB,CAAC;IACFW,OAAO,EAAE;MACPC,aAAa,kCAAAJ,MAAA,CAAkCN,SAAS,CAAE;MAC1D,cAAc,EAAE,kBAAkB;MAClC,sBAAsB,EAAEH,MAAM,CAACc;KAChC;IACDC,MAAM,EAAE;GACT,CACF;EAED,IAAI,CAACP,QAAQ,CAACQ,EAAE,EAAE;IAChB,MAAM,IAAIT,KAAK,iCAAAE,MAAA,CACmBD,QAAQ,CAACS,MAAM,OAAAR,MAAA,CAAID,QAAQ,CAACU,UAAU,CAAE,CACzE;EACH;EAEA,MAAMC,iBAAiB,GAAI,MAAMX,QAAQ,CAACY,IAAI,EAM7C;EACD,OAAOD,iBAAiB,CAACE,SAAgB;AAC3C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}