{"ast":null,"code":"import { getClientFetch } from \"../../../../utils/fetch.js\";\nimport { stringify } from \"../../../../utils/json.js\";\nimport { randomBytesHex } from \"../../../../utils/random.js\";\nimport { getLoginCallbackUrl } from \"./getLoginPath.js\";\n/**\n * Does no real authentication, just issues a temporary token for the user.\n * @internal\n */\nexport async function guestAuthenticate(args) {\n  let sessionId = await args.storage.getGuestSessionId();\n  if (!sessionId) {\n    sessionId = randomBytesHex(32);\n    args.storage.saveGuestSessionId(sessionId);\n  }\n  const clientFetch = getClientFetch(args.client, args.ecosystem);\n  const path = getLoginCallbackUrl({\n    authOption: \"guest\",\n    client: args.client,\n    ecosystem: args.ecosystem\n  });\n  const res = await clientFetch(\"\".concat(path), {\n    body: stringify({\n      sessionId\n    }),\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    method: \"POST\"\n  });\n  if (!res.ok) {\n    const error = await res.text();\n    throw new Error(\"Failed to generate guest account: \".concat(res.status, \" \").concat(res.statusText, \" \").concat(error));\n  }\n  return await res.json();\n}","map":{"version":3,"names":["getClientFetch","stringify","randomBytesHex","getLoginCallbackUrl","guestAuthenticate","args","sessionId","storage","getGuestSessionId","saveGuestSessionId","clientFetch","client","ecosystem","path","authOption","res","concat","body","headers","method","ok","error","text","Error","status","statusText","json"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/wallets/in-app/core/authentication/guest.ts"],"sourcesContent":["import type { ThirdwebClient } from \"../../../../client/client.js\";\nimport { getClientFetch } from \"../../../../utils/fetch.js\";\nimport { stringify } from \"../../../../utils/json.js\";\nimport { randomBytesHex } from \"../../../../utils/random.js\";\nimport type { Ecosystem } from \"../wallet/types.js\";\nimport type { ClientScopedStorage } from \"./client-scoped-storage.js\";\nimport { getLoginCallbackUrl } from \"./getLoginPath.js\";\nimport type { AuthStoredTokenWithCookieReturnType } from \"./types.js\";\n\n/**\n * Does no real authentication, just issues a temporary token for the user.\n * @internal\n */\nexport async function guestAuthenticate(args: {\n  client: ThirdwebClient;\n  storage: ClientScopedStorage;\n  ecosystem?: Ecosystem;\n}): Promise<AuthStoredTokenWithCookieReturnType> {\n  let sessionId = await args.storage.getGuestSessionId();\n  if (!sessionId) {\n    sessionId = randomBytesHex(32);\n    args.storage.saveGuestSessionId(sessionId);\n  }\n\n  const clientFetch = getClientFetch(args.client, args.ecosystem);\n  const path = getLoginCallbackUrl({\n    authOption: \"guest\",\n    client: args.client,\n    ecosystem: args.ecosystem,\n  });\n  const res = await clientFetch(`${path}`, {\n    body: stringify({\n      sessionId,\n    }),\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    method: \"POST\",\n  });\n\n  if (!res.ok) {\n    const error = await res.text();\n    throw new Error(\n      `Failed to generate guest account: ${res.status} ${res.statusText} ${error}`,\n    );\n  }\n\n  return (await res.json()) satisfies AuthStoredTokenWithCookieReturnType;\n}\n"],"mappings":"AACA,SAASA,cAAc,QAAQ,4BAA4B;AAC3D,SAASC,SAAS,QAAQ,2BAA2B;AACrD,SAASC,cAAc,QAAQ,6BAA6B;AAG5D,SAASC,mBAAmB,QAAQ,mBAAmB;AAGvD;;;;AAIA,OAAO,eAAeC,iBAAiBA,CAACC,IAIvC;EACC,IAAIC,SAAS,GAAG,MAAMD,IAAI,CAACE,OAAO,CAACC,iBAAiB,EAAE;EACtD,IAAI,CAACF,SAAS,EAAE;IACdA,SAAS,GAAGJ,cAAc,CAAC,EAAE,CAAC;IAC9BG,IAAI,CAACE,OAAO,CAACE,kBAAkB,CAACH,SAAS,CAAC;EAC5C;EAEA,MAAMI,WAAW,GAAGV,cAAc,CAACK,IAAI,CAACM,MAAM,EAAEN,IAAI,CAACO,SAAS,CAAC;EAC/D,MAAMC,IAAI,GAAGV,mBAAmB,CAAC;IAC/BW,UAAU,EAAE,OAAO;IACnBH,MAAM,EAAEN,IAAI,CAACM,MAAM;IACnBC,SAAS,EAAEP,IAAI,CAACO;GACjB,CAAC;EACF,MAAMG,GAAG,GAAG,MAAML,WAAW,IAAAM,MAAA,CAAIH,IAAI,GAAI;IACvCI,IAAI,EAAEhB,SAAS,CAAC;MACdK;KACD,CAAC;IACFY,OAAO,EAAE;MACP,cAAc,EAAE;KACjB;IACDC,MAAM,EAAE;GACT,CAAC;EAEF,IAAI,CAACJ,GAAG,CAACK,EAAE,EAAE;IACX,MAAMC,KAAK,GAAG,MAAMN,GAAG,CAACO,IAAI,EAAE;IAC9B,MAAM,IAAIC,KAAK,sCAAAP,MAAA,CACwBD,GAAG,CAACS,MAAM,OAAAR,MAAA,CAAID,GAAG,CAACU,UAAU,OAAAT,MAAA,CAAIK,KAAK,CAAE,CAC7E;EACH;EAEA,OAAQ,MAAMN,GAAG,CAACW,IAAI,EAAE;AAC1B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}