{"ast":null,"code":"import _objectSpread from \"/home/user/Arbitrage/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useState } from \"react\";\nimport { trackPayEvent } from \"../../../../analytics/track/pay.js\";\nimport { resolvePromisedValue } from \"../../../../utils/promise/resolve-promised-value.js\";\nimport { CustomThemeProvider } from \"../../../core/design-system/CustomThemeProvider.js\";\nimport { useActiveAccount } from \"../../../core/hooks/wallets/useActiveAccount.js\";\nimport { useActiveWallet } from \"../../../core/hooks/wallets/useActiveWallet.js\";\nimport { webWindowAdapter } from \"../../adapters/WindowAdapter.js\";\nimport { LoadingScreen } from \"../../wallets/shared/LoadingScreen.js\";\nimport { TransactionWidgetContentWrapper } from \"../Bridge/TransactionWidget.js\";\nimport { useConnectLocale } from \"../ConnectWallet/locale/getConnectLocale.js\";\nimport { Modal } from \"../components/Modal.js\";\nimport { DepositScreen } from \"./DepositScreen.js\";\nimport { ExecutingTxScreen } from \"./ExecutingScreen.js\";\nexport function TransactionModal(props) {\n  const account = useActiveAccount();\n  const wallet = useActiveWallet();\n  useQuery({\n    enabled: !!wallet && !!account,\n    queryFn: async () => {\n      var _await$resolvePromise;\n      if (!account || !wallet) {\n        throw new Error(); // never happens, because enabled is false\n      }\n      trackPayEvent({\n        client: props.client,\n        event: props.modalMode === \"buy\" ? \"open_pay_transaction_modal\" : \"open_pay_deposit_modal\",\n        toChainId: props.tx.chain.id,\n        toToken: props.tx.erc20Value ? (_await$resolvePromise = await resolvePromisedValue(props.tx.erc20Value)) === null || _await$resolvePromise === void 0 ? void 0 : _await$resolvePromise.tokenAddress : undefined,\n        walletAddress: account.address,\n        walletType: wallet.id\n      });\n      return null;\n    },\n    queryKey: [\"transaction-modal-event\", props.txId]\n  });\n  return _jsx(CustomThemeProvider, {\n    theme: props.theme,\n    children: _jsx(Modal, {\n      className: \"tw-modal__view-transaction\",\n      title: \"View Transaction\",\n      open: true,\n      setOpen: _open => {\n        if (!_open) {\n          props.onClose();\n        }\n      },\n      size: \"compact\",\n      children: _jsx(TransactionModalContent, _objectSpread({}, props))\n    })\n  });\n}\nfunction TransactionModalContent(props) {\n  var _props$payOptions$met, _props$payOptions$met2, _props$payOptions$met3;\n  if (props.modalMode === \"deposit\") {\n    return _jsx(DepositAndExecuteTx, _objectSpread({}, props));\n  }\n  return _jsx(TransactionWidgetContentWrapper, {\n    client: props.client,\n    country: props.country,\n    currency: props.currency,\n    transaction: props.tx,\n    onCancel: props.onClose,\n    locale: props.localeId,\n    onSuccess: data => {\n      props.onTxSent(data);\n    },\n    title: (_props$payOptions$met = props.payOptions.metadata) === null || _props$payOptions$met === void 0 ? void 0 : _props$payOptions$met.name,\n    description: (_props$payOptions$met2 = props.payOptions.metadata) === null || _props$payOptions$met2 === void 0 ? void 0 : _props$payOptions$met2.description,\n    image: (_props$payOptions$met3 = props.payOptions.metadata) === null || _props$payOptions$met3 === void 0 ? void 0 : _props$payOptions$met3.image,\n    paymentMethods: props.payOptions.buyWithCrypto === false ? [\"card\"] : props.payOptions.buyWithFiat === false ? [\"crypto\"] : [\"crypto\", \"card\"],\n    showThirdwebBranding: props.payOptions.showThirdwebBranding,\n    supportedTokens: props.supportedTokens,\n    onError: undefined,\n    paymentLinkId: undefined,\n    buttonLabel: undefined,\n    purchaseData: undefined\n  });\n}\nfunction DepositAndExecuteTx(props) {\n  const localeQuery = useConnectLocale(props.localeId);\n  const [screen, setScreen] = useState(\"deposit\");\n  if (!localeQuery.data) {\n    return _jsx(LoadingScreen, {});\n  }\n  if (screen === \"execute-tx\") {\n    return _jsx(ExecutingTxScreen, {\n      onBack: () => {\n        setScreen(\"deposit\");\n      },\n      closeModal: props.onClose,\n      onTxSent: props.onTxSent,\n      tx: props.tx,\n      windowAdapter: webWindowAdapter\n    });\n  }\n  if (screen === \"deposit\") {\n    return _jsx(DepositScreen, {\n      client: props.client,\n      connectLocale: localeQuery.data,\n      onDone: () => {\n        setScreen(\"execute-tx\");\n      },\n      tx: props.tx\n    });\n  }\n  return null;\n}","map":{"version":3,"names":["useQuery","useState","trackPayEvent","resolvePromisedValue","CustomThemeProvider","useActiveAccount","useActiveWallet","webWindowAdapter","LoadingScreen","TransactionWidgetContentWrapper","useConnectLocale","Modal","DepositScreen","ExecutingTxScreen","TransactionModal","props","account","wallet","enabled","queryFn","_await$resolvePromise","Error","client","event","modalMode","toChainId","tx","chain","id","toToken","erc20Value","tokenAddress","undefined","walletAddress","address","walletType","queryKey","txId","_jsx","theme","children","className","title","open","setOpen","_open","onClose","size","TransactionModalContent","_objectSpread","_props$payOptions$met","_props$payOptions$met2","_props$payOptions$met3","DepositAndExecuteTx","country","currency","transaction","onCancel","locale","localeId","onSuccess","data","onTxSent","payOptions","metadata","name","description","image","paymentMethods","buyWithCrypto","buyWithFiat","showThirdwebBranding","supportedTokens","onError","paymentLinkId","buttonLabel","purchaseData","localeQuery","screen","setScreen","onBack","closeModal","windowAdapter","connectLocale","onDone"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/react/web/ui/TransactionButton/TransactionModal.tsx"],"sourcesContent":["import { useQuery } from \"@tanstack/react-query\";\nimport { useState } from \"react\";\nimport { trackPayEvent } from \"../../../../analytics/track/pay.js\";\nimport type { ThirdwebClient } from \"../../../../client/client.js\";\nimport type { SupportedFiatCurrency } from \"../../../../pay/convert/type.js\";\nimport type { WaitForReceiptOptions } from \"../../../../transaction/actions/wait-for-tx-receipt.js\";\nimport type { PreparedTransaction } from \"../../../../transaction/prepare-transaction.js\";\nimport { resolvePromisedValue } from \"../../../../utils/promise/resolve-promised-value.js\";\nimport { CustomThemeProvider } from \"../../../core/design-system/CustomThemeProvider.js\";\nimport type { Theme } from \"../../../core/design-system/index.js\";\nimport type { PayUIOptions } from \"../../../core/hooks/connection/ConnectButtonProps.js\";\nimport { useActiveAccount } from \"../../../core/hooks/wallets/useActiveAccount.js\";\nimport { useActiveWallet } from \"../../../core/hooks/wallets/useActiveWallet.js\";\nimport type { SupportedTokens } from \"../../../core/utils/defaultTokens.js\";\nimport { webWindowAdapter } from \"../../adapters/WindowAdapter.js\";\nimport { LoadingScreen } from \"../../wallets/shared/LoadingScreen.js\";\nimport { TransactionWidgetContentWrapper } from \"../Bridge/TransactionWidget.js\";\nimport { useConnectLocale } from \"../ConnectWallet/locale/getConnectLocale.js\";\nimport { Modal } from \"../components/Modal.js\";\nimport type { LocaleId } from \"../types.js\";\nimport { DepositScreen } from \"./DepositScreen.js\";\nimport { ExecutingTxScreen } from \"./ExecutingScreen.js\";\n\ntype ModalProps = {\n  title: string;\n  txId: string;\n  onComplete: () => void;\n  onClose: () => void;\n  client: ThirdwebClient;\n  localeId: LocaleId;\n  supportedTokens?: SupportedTokens;\n  theme: Theme | \"light\" | \"dark\";\n  tx: PreparedTransaction;\n  payOptions: PayUIOptions;\n  onTxSent: (data: WaitForReceiptOptions) => void;\n  modalMode: \"buy\" | \"deposit\";\n  country: string | undefined;\n  currency: SupportedFiatCurrency | undefined;\n};\n\nexport function TransactionModal(props: ModalProps) {\n  const account = useActiveAccount();\n  const wallet = useActiveWallet();\n\n  useQuery({\n    enabled: !!wallet && !!account,\n    queryFn: async () => {\n      if (!account || !wallet) {\n        throw new Error(); // never happens, because enabled is false\n      }\n      trackPayEvent({\n        client: props.client,\n        event:\n          props.modalMode === \"buy\"\n            ? \"open_pay_transaction_modal\"\n            : \"open_pay_deposit_modal\",\n        toChainId: props.tx.chain.id,\n        toToken: props.tx.erc20Value\n          ? (await resolvePromisedValue(props.tx.erc20Value))?.tokenAddress\n          : undefined,\n        walletAddress: account.address,\n        walletType: wallet.id,\n      });\n\n      return null;\n    },\n    queryKey: [\"transaction-modal-event\", props.txId],\n  });\n\n  return (\n    <CustomThemeProvider theme={props.theme}>\n      <Modal\n        className=\"tw-modal__view-transaction\"\n        title=\"View Transaction\"\n        open={true}\n        setOpen={(_open) => {\n          if (!_open) {\n            props.onClose();\n          }\n        }}\n        size=\"compact\"\n      >\n        <TransactionModalContent {...props} />\n      </Modal>\n    </CustomThemeProvider>\n  );\n}\n\nfunction TransactionModalContent(props: ModalProps) {\n  if (props.modalMode === \"deposit\") {\n    return <DepositAndExecuteTx {...props} />;\n  }\n\n  return (\n    <TransactionWidgetContentWrapper\n      client={props.client}\n      country={props.country}\n      currency={props.currency}\n      transaction={props.tx}\n      onCancel={props.onClose}\n      locale={props.localeId}\n      onSuccess={(data) => {\n        props.onTxSent(data);\n      }}\n      title={props.payOptions.metadata?.name}\n      description={props.payOptions.metadata?.description}\n      image={props.payOptions.metadata?.image}\n      paymentMethods={\n        props.payOptions.buyWithCrypto === false\n          ? [\"card\"]\n          : props.payOptions.buyWithFiat === false\n            ? [\"crypto\"]\n            : [\"crypto\", \"card\"]\n      }\n      showThirdwebBranding={props.payOptions.showThirdwebBranding}\n      supportedTokens={props.supportedTokens}\n      onError={undefined}\n      paymentLinkId={undefined}\n      buttonLabel={undefined}\n      purchaseData={undefined}\n    />\n  );\n}\n\nfunction DepositAndExecuteTx(props: ModalProps) {\n  const localeQuery = useConnectLocale(props.localeId);\n  const [screen, setScreen] = useState<\"deposit\" | \"execute-tx\">(\"deposit\");\n\n  if (!localeQuery.data) {\n    return <LoadingScreen />;\n  }\n\n  if (screen === \"execute-tx\") {\n    return (\n      <ExecutingTxScreen\n        onBack={() => {\n          setScreen(\"deposit\");\n        }}\n        closeModal={props.onClose}\n        onTxSent={props.onTxSent}\n        tx={props.tx}\n        windowAdapter={webWindowAdapter}\n      />\n    );\n  }\n\n  if (screen === \"deposit\") {\n    return (\n      <DepositScreen\n        client={props.client}\n        connectLocale={localeQuery.data}\n        onDone={() => {\n          setScreen(\"execute-tx\");\n        }}\n        tx={props.tx}\n      />\n    );\n  }\n\n  return null;\n}\n"],"mappings":";;AAAA,SAASA,QAAQ,QAAQ,uBAAuB;AAChD,SAASC,QAAQ,QAAQ,OAAO;AAChC,SAASC,aAAa,QAAQ,oCAAoC;AAKlE,SAASC,oBAAoB,QAAQ,qDAAqD;AAC1F,SAASC,mBAAmB,QAAQ,oDAAoD;AAGxF,SAASC,gBAAgB,QAAQ,iDAAiD;AAClF,SAASC,eAAe,QAAQ,gDAAgD;AAEhF,SAASC,gBAAgB,QAAQ,iCAAiC;AAClE,SAASC,aAAa,QAAQ,uCAAuC;AACrE,SAASC,+BAA+B,QAAQ,gCAAgC;AAChF,SAASC,gBAAgB,QAAQ,6CAA6C;AAC9E,SAASC,KAAK,QAAQ,wBAAwB;AAE9C,SAASC,aAAa,QAAQ,oBAAoB;AAClD,SAASC,iBAAiB,QAAQ,sBAAsB;AAmBxD,OAAM,SAAUC,gBAAgBA,CAACC,KAAiB;EAChD,MAAMC,OAAO,GAAGX,gBAAgB,EAAE;EAClC,MAAMY,MAAM,GAAGX,eAAe,EAAE;EAEhCN,QAAQ,CAAC;IACPkB,OAAO,EAAE,CAAC,CAACD,MAAM,IAAI,CAAC,CAACD,OAAO;IAC9BG,OAAO,EAAE,MAAAA,CAAA,KAAW;MAAA,IAAAC,qBAAA;MAClB,IAAI,CAACJ,OAAO,IAAI,CAACC,MAAM,EAAE;QACvB,MAAM,IAAII,KAAK,EAAE,CAAC,CAAC;MACrB;MACAnB,aAAa,CAAC;QACZoB,MAAM,EAAEP,KAAK,CAACO,MAAM;QACpBC,KAAK,EACHR,KAAK,CAACS,SAAS,KAAK,KAAK,GACrB,4BAA4B,GAC5B,wBAAwB;QAC9BC,SAAS,EAAEV,KAAK,CAACW,EAAE,CAACC,KAAK,CAACC,EAAE;QAC5BC,OAAO,EAAEd,KAAK,CAACW,EAAE,CAACI,UAAU,IAAAV,qBAAA,GACvB,MAAMjB,oBAAoB,CAACY,KAAK,CAACW,EAAE,CAACI,UAAU,CAAC,cAAAV,qBAAA,uBAAhDA,qBAAA,CAAmDW,YAAY,GAC/DC,SAAS;QACbC,aAAa,EAAEjB,OAAO,CAACkB,OAAO;QAC9BC,UAAU,EAAElB,MAAM,CAACW;OACpB,CAAC;MAEF,OAAO,IAAI;IACb,CAAC;IACDQ,QAAQ,EAAE,CAAC,yBAAyB,EAAErB,KAAK,CAACsB,IAAI;GACjD,CAAC;EAEF,OACEC,IAAA,CAAClC,mBAAmB;IAACmC,KAAK,EAAExB,KAAK,CAACwB,KAAK;IAAAC,QAAA,EACrCF,IAAA,CAAC3B,KAAK;MACJ8B,SAAS,EAAC,4BAA4B;MACtCC,KAAK,EAAC,kBAAkB;MACxBC,IAAI,EAAE,IAAI;MACVC,OAAO,EAAGC,KAAK,IAAI;QACjB,IAAI,CAACA,KAAK,EAAE;UACV9B,KAAK,CAAC+B,OAAO,EAAE;QACjB;MACF,CAAC;MACDC,IAAI,EAAC,SAAS;MAAAP,QAAA,EAEdF,IAAA,CAACU,uBAAuB,EAAAC,aAAA,KAAKlC,KAAK;IAAI;EAChC,EACY;AAE1B;AAEA,SAASiC,uBAAuBA,CAACjC,KAAiB;EAAA,IAAAmC,qBAAA,EAAAC,sBAAA,EAAAC,sBAAA;EAChD,IAAIrC,KAAK,CAACS,SAAS,KAAK,SAAS,EAAE;IACjC,OAAOc,IAAA,CAACe,mBAAmB,EAAAJ,aAAA,KAAKlC,KAAK,EAAI;EAC3C;EAEA,OACEuB,IAAA,CAAC7B,+BAA+B;IAC9Ba,MAAM,EAAEP,KAAK,CAACO,MAAM;IACpBgC,OAAO,EAAEvC,KAAK,CAACuC,OAAO;IACtBC,QAAQ,EAAExC,KAAK,CAACwC,QAAQ;IACxBC,WAAW,EAAEzC,KAAK,CAACW,EAAE;IACrB+B,QAAQ,EAAE1C,KAAK,CAAC+B,OAAO;IACvBY,MAAM,EAAE3C,KAAK,CAAC4C,QAAQ;IACtBC,SAAS,EAAGC,IAAI,IAAI;MAClB9C,KAAK,CAAC+C,QAAQ,CAACD,IAAI,CAAC;IACtB,CAAC;IACDnB,KAAK,GAAAQ,qBAAA,GAAEnC,KAAK,CAACgD,UAAU,CAACC,QAAQ,cAAAd,qBAAA,uBAAzBA,qBAAA,CAA2Be,IAAI;IACtCC,WAAW,GAAAf,sBAAA,GAAEpC,KAAK,CAACgD,UAAU,CAACC,QAAQ,cAAAb,sBAAA,uBAAzBA,sBAAA,CAA2Be,WAAW;IACnDC,KAAK,GAAAf,sBAAA,GAAErC,KAAK,CAACgD,UAAU,CAACC,QAAQ,cAAAZ,sBAAA,uBAAzBA,sBAAA,CAA2Be,KAAK;IACvCC,cAAc,EACZrD,KAAK,CAACgD,UAAU,CAACM,aAAa,KAAK,KAAK,GACpC,CAAC,MAAM,CAAC,GACRtD,KAAK,CAACgD,UAAU,CAACO,WAAW,KAAK,KAAK,GACpC,CAAC,QAAQ,CAAC,GACV,CAAC,QAAQ,EAAE,MAAM,CAAC;IAE1BC,oBAAoB,EAAExD,KAAK,CAACgD,UAAU,CAACQ,oBAAoB;IAC3DC,eAAe,EAAEzD,KAAK,CAACyD,eAAe;IACtCC,OAAO,EAAEzC,SAAS;IAClB0C,aAAa,EAAE1C,SAAS;IACxB2C,WAAW,EAAE3C,SAAS;IACtB4C,YAAY,EAAE5C;EAAS,EACvB;AAEN;AAEA,SAASqB,mBAAmBA,CAACtC,KAAiB;EAC5C,MAAM8D,WAAW,GAAGnE,gBAAgB,CAACK,KAAK,CAAC4C,QAAQ,CAAC;EACpD,MAAM,CAACmB,MAAM,EAAEC,SAAS,CAAC,GAAG9E,QAAQ,CAA2B,SAAS,CAAC;EAEzE,IAAI,CAAC4E,WAAW,CAAChB,IAAI,EAAE;IACrB,OAAOvB,IAAA,CAAC9B,aAAa,KAAG;EAC1B;EAEA,IAAIsE,MAAM,KAAK,YAAY,EAAE;IAC3B,OACExC,IAAA,CAACzB,iBAAiB;MAChBmE,MAAM,EAAEA,CAAA,KAAK;QACXD,SAAS,CAAC,SAAS,CAAC;MACtB,CAAC;MACDE,UAAU,EAAElE,KAAK,CAAC+B,OAAO;MACzBgB,QAAQ,EAAE/C,KAAK,CAAC+C,QAAQ;MACxBpC,EAAE,EAAEX,KAAK,CAACW,EAAE;MACZwD,aAAa,EAAE3E;IAAgB,EAC/B;EAEN;EAEA,IAAIuE,MAAM,KAAK,SAAS,EAAE;IACxB,OACExC,IAAA,CAAC1B,aAAa;MACZU,MAAM,EAAEP,KAAK,CAACO,MAAM;MACpB6D,aAAa,EAAEN,WAAW,CAAChB,IAAI;MAC/BuB,MAAM,EAAEA,CAAA,KAAK;QACXL,SAAS,CAAC,YAAY,CAAC;MACzB,CAAC;MACDrD,EAAE,EAAEX,KAAK,CAACW;IAAE,EACZ;EAEN;EAEA,OAAO,IAAI;AACb","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}