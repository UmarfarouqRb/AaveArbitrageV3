{"ast":null,"code":"import { useQuery } from \"@tanstack/react-query\";\nimport { useMemo } from \"react\";\nimport { resolveArweaveScheme } from \"../../../../utils/arweave.js\";\nimport { resolveScheme } from \"../../../../utils/ipfs.js\";\nimport { resolveMimeType } from \"../../utils/resolveMimeType.js\";\n/**\n * @internal\n */\nexport function useResolvedMediaType(client, uri, mimeType, gatewayUrl) {\n  const resolvedUrl = useMemo(() => {\n    if (!uri) {\n      return \"\";\n    }\n    if (uri.startsWith(\"ar://\")) {\n      return resolveArweaveScheme({\n        gatewayUrl,\n        uri\n      });\n    }\n    if (gatewayUrl) {\n      return uri.replace(\"ipfs://\", gatewayUrl);\n    }\n    try {\n      return resolveScheme({\n        client,\n        uri\n      });\n    } catch (_unused) {\n      return uri.replace(\"ipfs://\", \"https://ipfs.io/ipfs/\");\n    }\n  }, [uri, gatewayUrl, client]);\n  const resolvedMimeType = useQuery({\n    enabled: !!resolvedUrl && !mimeType,\n    initialData: mimeType,\n    queryFn: () => resolveMimeType(resolvedUrl),\n    queryKey: [\"mime-type\", resolvedUrl]\n  });\n  return {\n    isFetched: resolvedMimeType.isFetched || !!mimeType,\n    mediaInfo: {\n      mimeType: resolvedMimeType.data || \"image/\",\n      url: resolvedUrl // default to image if no mime type is found\n    }\n  };\n}\n/**\n * @internal Exported for tests\n */\nexport function resolveMediaTypeFromUri(props) {\n  const {\n    uri,\n    client,\n    gatewayUrl\n  } = props;\n  if (!uri) {\n    return \"\";\n  }\n  if (uri.startsWith(\"ar://\")) {\n    return resolveArweaveScheme({\n      gatewayUrl,\n      uri\n    });\n  }\n  if (gatewayUrl) {\n    return uri.replace(\"ipfs://\", gatewayUrl);\n  }\n  try {\n    return resolveScheme({\n      client,\n      uri\n    });\n  } catch (_unused2) {\n    return uri.replace(\"ipfs://\", \"https://ipfs.io/ipfs/\");\n  }\n}","map":{"version":3,"names":["useQuery","useMemo","resolveArweaveScheme","resolveScheme","resolveMimeType","useResolvedMediaType","client","uri","mimeType","gatewayUrl","resolvedUrl","startsWith","replace","_unused","resolvedMimeType","enabled","initialData","queryFn","queryKey","isFetched","mediaInfo","data","url","resolveMediaTypeFromUri","props","_unused2"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/react/web/ui/MediaRenderer/useResolvedMediaType.ts"],"sourcesContent":["import { useQuery } from \"@tanstack/react-query\";\nimport { useMemo } from \"react\";\nimport type { ThirdwebClient } from \"../../../../client/client.js\";\nimport { resolveArweaveScheme } from \"../../../../utils/arweave.js\";\nimport { resolveScheme } from \"../../../../utils/ipfs.js\";\nimport { resolveMimeType } from \"../../utils/resolveMimeType.js\";\n\n/**\n * @internal\n */\nexport function useResolvedMediaType(\n  client: ThirdwebClient,\n  uri?: string,\n  mimeType?: string,\n  gatewayUrl?: string,\n) {\n  const resolvedUrl = useMemo(() => {\n    if (!uri) {\n      return \"\";\n    }\n    if (uri.startsWith(\"ar://\")) {\n      return resolveArweaveScheme({ gatewayUrl, uri });\n    }\n    if (gatewayUrl) {\n      return uri.replace(\"ipfs://\", gatewayUrl);\n    }\n    try {\n      return resolveScheme({\n        client,\n        uri,\n      });\n    } catch {\n      return uri.replace(\"ipfs://\", \"https://ipfs.io/ipfs/\");\n    }\n  }, [uri, gatewayUrl, client]);\n\n  const resolvedMimeType = useQuery({\n    enabled: !!resolvedUrl && !mimeType,\n    initialData: mimeType,\n    queryFn: () => resolveMimeType(resolvedUrl),\n    queryKey: [\"mime-type\", resolvedUrl],\n  });\n\n  return {\n    isFetched: resolvedMimeType.isFetched || !!mimeType,\n    mediaInfo: {\n      mimeType: resolvedMimeType.data || \"image/\",\n      url: resolvedUrl, // default to image if no mime type is found\n    },\n  };\n}\n\n/**\n * @internal Exported for tests\n */\nexport function resolveMediaTypeFromUri(props: {\n  uri?: string;\n  client: ThirdwebClient;\n  gatewayUrl?: string;\n}) {\n  const { uri, client, gatewayUrl } = props;\n  if (!uri) {\n    return \"\";\n  }\n  if (uri.startsWith(\"ar://\")) {\n    return resolveArweaveScheme({ gatewayUrl, uri });\n  }\n  if (gatewayUrl) {\n    return uri.replace(\"ipfs://\", gatewayUrl);\n  }\n  try {\n    return resolveScheme({\n      client,\n      uri,\n    });\n  } catch {\n    return uri.replace(\"ipfs://\", \"https://ipfs.io/ipfs/\");\n  }\n}\n"],"mappings":"AAAA,SAASA,QAAQ,QAAQ,uBAAuB;AAChD,SAASC,OAAO,QAAQ,OAAO;AAE/B,SAASC,oBAAoB,QAAQ,8BAA8B;AACnE,SAASC,aAAa,QAAQ,2BAA2B;AACzD,SAASC,eAAe,QAAQ,gCAAgC;AAEhE;;;AAGA,OAAM,SAAUC,oBAAoBA,CAClCC,MAAsB,EACtBC,GAAY,EACZC,QAAiB,EACjBC,UAAmB;EAEnB,MAAMC,WAAW,GAAGT,OAAO,CAAC,MAAK;IAC/B,IAAI,CAACM,GAAG,EAAE;MACR,OAAO,EAAE;IACX;IACA,IAAIA,GAAG,CAACI,UAAU,CAAC,OAAO,CAAC,EAAE;MAC3B,OAAOT,oBAAoB,CAAC;QAAEO,UAAU;QAAEF;MAAG,CAAE,CAAC;IAClD;IACA,IAAIE,UAAU,EAAE;MACd,OAAOF,GAAG,CAACK,OAAO,CAAC,SAAS,EAAEH,UAAU,CAAC;IAC3C;IACA,IAAI;MACF,OAAON,aAAa,CAAC;QACnBG,MAAM;QACNC;OACD,CAAC;IACJ,CAAC,CAAC,OAAAM,OAAA,EAAM;MACN,OAAON,GAAG,CAACK,OAAO,CAAC,SAAS,EAAE,uBAAuB,CAAC;IACxD;EACF,CAAC,EAAE,CAACL,GAAG,EAAEE,UAAU,EAAEH,MAAM,CAAC,CAAC;EAE7B,MAAMQ,gBAAgB,GAAGd,QAAQ,CAAC;IAChCe,OAAO,EAAE,CAAC,CAACL,WAAW,IAAI,CAACF,QAAQ;IACnCQ,WAAW,EAAER,QAAQ;IACrBS,OAAO,EAAEA,CAAA,KAAMb,eAAe,CAACM,WAAW,CAAC;IAC3CQ,QAAQ,EAAE,CAAC,WAAW,EAAER,WAAW;GACpC,CAAC;EAEF,OAAO;IACLS,SAAS,EAAEL,gBAAgB,CAACK,SAAS,IAAI,CAAC,CAACX,QAAQ;IACnDY,SAAS,EAAE;MACTZ,QAAQ,EAAEM,gBAAgB,CAACO,IAAI,IAAI,QAAQ;MAC3CC,GAAG,EAAEZ,WAAW,CAAE;;GAErB;AACH;AAEA;;;AAGA,OAAM,SAAUa,uBAAuBA,CAACC,KAIvC;EACC,MAAM;IAAEjB,GAAG;IAAED,MAAM;IAAEG;EAAU,CAAE,GAAGe,KAAK;EACzC,IAAI,CAACjB,GAAG,EAAE;IACR,OAAO,EAAE;EACX;EACA,IAAIA,GAAG,CAACI,UAAU,CAAC,OAAO,CAAC,EAAE;IAC3B,OAAOT,oBAAoB,CAAC;MAAEO,UAAU;MAAEF;IAAG,CAAE,CAAC;EAClD;EACA,IAAIE,UAAU,EAAE;IACd,OAAOF,GAAG,CAACK,OAAO,CAAC,SAAS,EAAEH,UAAU,CAAC;EAC3C;EACA,IAAI;IACF,OAAON,aAAa,CAAC;MACnBG,MAAM;MACNC;KACD,CAAC;EACJ,CAAC,CAAC,OAAAkB,QAAA,EAAM;IACN,OAAOlB,GAAG,CAACK,OAAO,CAAC,SAAS,EAAE,uBAAuB,CAAC;EACxD;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}