{"ast":null,"code":"import { requestProviders } from './utils.js';\nexport function createStore() {\n  const listeners = new Set();\n  let providerDetails = [];\n  const request = () => requestProviders(providerDetail => {\n    if (providerDetails.some(_ref => {\n      let {\n        info\n      } = _ref;\n      return info.uuid === providerDetail.info.uuid;\n    })) return;\n    providerDetails = [...providerDetails, providerDetail];\n    listeners.forEach(listener => listener(providerDetails, {\n      added: [providerDetail]\n    }));\n  });\n  let unwatch = request();\n  return {\n    _listeners() {\n      return listeners;\n    },\n    clear() {\n      listeners.forEach(listener => listener([], {\n        removed: [...providerDetails]\n      }));\n      providerDetails = [];\n    },\n    destroy() {\n      var _unwatch;\n      this.clear();\n      listeners.clear();\n      (_unwatch = unwatch) === null || _unwatch === void 0 || _unwatch();\n    },\n    findProvider(_ref2) {\n      let {\n        rdns\n      } = _ref2;\n      return providerDetails.find(providerDetail => providerDetail.info.rdns === rdns);\n    },\n    getProviders() {\n      return providerDetails;\n    },\n    reset() {\n      var _unwatch2;\n      this.clear();\n      (_unwatch2 = unwatch) === null || _unwatch2 === void 0 || _unwatch2();\n      unwatch = request();\n    },\n    subscribe(listener) {\n      let {\n        emitImmediately\n      } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      listeners.add(listener);\n      if (emitImmediately) listener(providerDetails, {\n        added: providerDetails\n      });\n      return () => listeners.delete(listener);\n    }\n  };\n}","map":{"version":3,"names":["requestProviders","createStore","listeners","Set","providerDetails","request","providerDetail","some","_ref","info","uuid","forEach","listener","added","unwatch","_listeners","clear","removed","destroy","_unwatch","findProvider","_ref2","rdns","find","getProviders","reset","_unwatch2","subscribe","emitImmediately","arguments","length","undefined","add","delete"],"sources":["/home/user/Arbitrage/frontend/node_modules/mipd/src/store.ts"],"sourcesContent":["import type { Rdns } from './register.js'\nimport type { EIP6963ProviderDetail } from './types.js'\nimport { requestProviders } from './utils.js'\n\nexport type Listener = (\n  providerDetails: readonly EIP6963ProviderDetail[],\n  meta?:\n    | {\n        added?: readonly EIP6963ProviderDetail[] | undefined\n        removed?: readonly EIP6963ProviderDetail[] | undefined\n      }\n    | undefined,\n) => void\n\nexport type Store = {\n  /**\n   * Clears the store, including all provider details.\n   */\n  clear(): void\n  /**\n   * Destroys the store, including all provider details and listeners.\n   */\n  destroy(): void\n  /**\n   * Finds a provider detail by its RDNS (Reverse Domain Name Identifier).\n   */\n  findProvider(args: { rdns: Rdns }): EIP6963ProviderDetail | undefined\n  /**\n   * Returns all provider details that have been emitted.\n   */\n  getProviders(): readonly EIP6963ProviderDetail[]\n  /**\n   * Resets the store, and emits an event to request provider details.\n   */\n  reset(): void\n  /**\n   * Subscribes to emitted provider details.\n   */\n  subscribe(\n    listener: Listener,\n    args?: { emitImmediately?: boolean | undefined } | undefined,\n  ): () => void\n\n  /**\n   * @internal\n   * Current state of listening listeners.\n   */\n  _listeners(): Set<Listener>\n}\n\nexport function createStore(): Store {\n  const listeners: Set<Listener> = new Set()\n  let providerDetails: readonly EIP6963ProviderDetail[] = []\n\n  const request = () =>\n    requestProviders((providerDetail) => {\n      if (\n        providerDetails.some(\n          ({ info }) => info.uuid === providerDetail.info.uuid,\n        )\n      )\n        return\n\n      providerDetails = [...providerDetails, providerDetail]\n      listeners.forEach((listener) =>\n        listener(providerDetails, { added: [providerDetail] }),\n      )\n    })\n  let unwatch = request()\n\n  return {\n    _listeners() {\n      return listeners\n    },\n    clear() {\n      listeners.forEach((listener) =>\n        listener([], { removed: [...providerDetails] }),\n      )\n      providerDetails = []\n    },\n    destroy() {\n      this.clear()\n      listeners.clear()\n      unwatch?.()\n    },\n    findProvider({ rdns }) {\n      return providerDetails.find(\n        (providerDetail) => providerDetail.info.rdns === rdns,\n      )\n    },\n    getProviders() {\n      return providerDetails\n    },\n    reset() {\n      this.clear()\n      unwatch?.()\n      unwatch = request()\n    },\n    subscribe(listener, { emitImmediately } = {}) {\n      listeners.add(listener)\n      if (emitImmediately) listener(providerDetails, { added: providerDetails })\n      return () => listeners.delete(listener)\n    },\n  }\n}\n"],"mappings":"AAEA,SAASA,gBAAgB,QAAQ,YAAY;AAgD7C,OAAM,SAAUC,WAAWA,CAAA;EACzB,MAAMC,SAAS,GAAkB,IAAIC,GAAG,EAAE;EAC1C,IAAIC,eAAe,GAAqC,EAAE;EAE1D,MAAMC,OAAO,GAAGA,CAAA,KACdL,gBAAgB,CAAEM,cAAc,IAAI;IAClC,IACEF,eAAe,CAACG,IAAI,CAClBC,IAAA;MAAA,IAAC;QAAEC;MAAI,CAAE,GAAAD,IAAA;MAAA,OAAKC,IAAI,CAACC,IAAI,KAAKJ,cAAc,CAACG,IAAI,CAACC,IAAI;IAAA,EACrD,EAED;IAEFN,eAAe,GAAG,CAAC,GAAGA,eAAe,EAAEE,cAAc,CAAC;IACtDJ,SAAS,CAACS,OAAO,CAAEC,QAAQ,IACzBA,QAAQ,CAACR,eAAe,EAAE;MAAES,KAAK,EAAE,CAACP,cAAc;IAAC,CAAE,CAAC,CACvD;EACH,CAAC,CAAC;EACJ,IAAIQ,OAAO,GAAGT,OAAO,EAAE;EAEvB,OAAO;IACLU,UAAUA,CAAA;MACR,OAAOb,SAAS;IAClB,CAAC;IACDc,KAAKA,CAAA;MACHd,SAAS,CAACS,OAAO,CAAEC,QAAQ,IACzBA,QAAQ,CAAC,EAAE,EAAE;QAAEK,OAAO,EAAE,CAAC,GAAGb,eAAe;MAAC,CAAE,CAAC,CAChD;MACDA,eAAe,GAAG,EAAE;IACtB,CAAC;IACDc,OAAOA,CAAA;MAAA,IAAAC,QAAA;MACL,IAAI,CAACH,KAAK,EAAE;MACZd,SAAS,CAACc,KAAK,EAAE;MACjB,CAAAG,QAAA,GAAAL,OAAO,cAAAK,QAAA,eAAPA,QAAA,CAAS,CAAE;IACb,CAAC;IACDC,YAAYA,CAAAC,KAAA,EAAS;MAAA,IAAR;QAAEC;MAAI,CAAE,GAAAD,KAAA;MACnB,OAAOjB,eAAe,CAACmB,IAAI,CACxBjB,cAAc,IAAKA,cAAc,CAACG,IAAI,CAACa,IAAI,KAAKA,IAAI,CACtD;IACH,CAAC;IACDE,YAAYA,CAAA;MACV,OAAOpB,eAAe;IACxB,CAAC;IACDqB,KAAKA,CAAA;MAAA,IAAAC,SAAA;MACH,IAAI,CAACV,KAAK,EAAE;MACZ,CAAAU,SAAA,GAAAZ,OAAO,cAAAY,SAAA,eAAPA,SAAA,CAAS,CAAE;MACXZ,OAAO,GAAGT,OAAO,EAAE;IACrB,CAAC;IACDsB,SAASA,CAACf,QAAQ,EAA0B;MAAA,IAAxB;QAAEgB;MAAe,CAAE,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,EAAE;MAC1C3B,SAAS,CAAC8B,GAAG,CAACpB,QAAQ,CAAC;MACvB,IAAIgB,eAAe,EAAEhB,QAAQ,CAACR,eAAe,EAAE;QAAES,KAAK,EAAET;MAAe,CAAE,CAAC;MAC1E,OAAO,MAAMF,SAAS,CAAC+B,MAAM,CAACrB,QAAQ,CAAC;IACzC;GACD;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}