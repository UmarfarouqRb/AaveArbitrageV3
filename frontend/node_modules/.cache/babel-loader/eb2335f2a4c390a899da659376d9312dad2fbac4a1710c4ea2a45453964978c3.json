{"ast":null,"code":"import _objectSpread from \"/home/user/Arbitrage/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { toAccount } from '../../accounts/toAccount.js';\nimport { keccak256 } from '../../utils/index.js';\nimport { hashMessage } from '../../utils/signature/hashMessage.js';\nimport { hashTypedData } from '../../utils/signature/hashTypedData.js';\nimport { serializeTransaction } from '../serializers.js';\n/**\n * Creates a [ZKsync Smart Account](https://docs.zksync.io/build/developer-reference/account-abstraction/building-smart-accounts)\n * from a Contract Address and a custom sign function.\n */\nexport function toSmartAccount(parameters) {\n  const {\n    address,\n    sign\n  } = parameters;\n  const account = toAccount({\n    address,\n    sign,\n    async signMessage(_ref) {\n      let {\n        message\n      } = _ref;\n      return sign({\n        hash: hashMessage(message)\n      });\n    },\n    async signTransaction(transaction) {\n      const signableTransaction = _objectSpread(_objectSpread({}, transaction), {}, {\n        from: this.address\n      });\n      return serializeTransaction(_objectSpread(_objectSpread({}, signableTransaction), {}, {\n        customSignature: await sign({\n          hash: keccak256(serializeTransaction(signableTransaction))\n        })\n      }));\n    },\n    async signTypedData(typedData) {\n      return sign({\n        hash: hashTypedData(typedData)\n      });\n    }\n  });\n  return _objectSpread(_objectSpread({}, account), {}, {\n    source: 'smartAccountZksync'\n  });\n}","map":{"version":3,"names":["toAccount","keccak256","hashMessage","hashTypedData","serializeTransaction","toSmartAccount","parameters","address","sign","account","signMessage","_ref","message","hash","signTransaction","transaction","signableTransaction","_objectSpread","from","customSignature","signTypedData","typedData","source"],"sources":["/home/user/Arbitrage/frontend/node_modules/viem/zksync/accounts/toSmartAccount.ts"],"sourcesContent":["import type { Address } from 'abitype'\n\nimport { toAccount } from '../../accounts/toAccount.js'\nimport type { ErrorType } from '../../errors/utils.js'\nimport type { Hash, Hex } from '../../types/misc.js'\nimport { keccak256 } from '../../utils/index.js'\nimport { hashMessage } from '../../utils/signature/hashMessage.js'\nimport { hashTypedData } from '../../utils/signature/hashTypedData.js'\nimport { serializeTransaction } from '../serializers.js'\nimport type { ZksyncSmartAccount } from '../types/account.js'\nimport type { ZksyncTransactionSerializableEIP712 } from '../types/transaction.js'\n\nexport type ToSmartAccountParameters = {\n  /** Address of the deployed Account's Contract implementation. */\n  address: Address\n  /** Function to sign a hash. */\n  sign: (parameters: { hash: Hash }) => Promise<Hex>\n}\n\nexport type ToSmartAccountErrorType = ErrorType\n\n/**\n * Creates a [ZKsync Smart Account](https://docs.zksync.io/build/developer-reference/account-abstraction/building-smart-accounts)\n * from a Contract Address and a custom sign function.\n */\nexport function toSmartAccount(\n  parameters: ToSmartAccountParameters,\n): ZksyncSmartAccount {\n  const { address, sign } = parameters\n\n  const account = toAccount({\n    address,\n    sign,\n    async signMessage({ message }) {\n      return sign({\n        hash: hashMessage(message),\n      })\n    },\n    async signTransaction(transaction) {\n      const signableTransaction = {\n        ...transaction,\n        from: this.address!,\n      } as ZksyncTransactionSerializableEIP712\n\n      return serializeTransaction({\n        ...signableTransaction,\n        customSignature: await sign({\n          hash: keccak256(serializeTransaction(signableTransaction)),\n        }),\n      })\n    },\n    async signTypedData(typedData) {\n      return sign({\n        hash: hashTypedData(typedData),\n      })\n    },\n  })\n\n  return {\n    ...account,\n    source: 'smartAccountZksync',\n  } as ZksyncSmartAccount\n}\n"],"mappings":";AAEA,SAASA,SAAS,QAAQ,6BAA6B;AAGvD,SAASC,SAAS,QAAQ,sBAAsB;AAChD,SAASC,WAAW,QAAQ,sCAAsC;AAClE,SAASC,aAAa,QAAQ,wCAAwC;AACtE,SAASC,oBAAoB,QAAQ,mBAAmB;AAaxD;;;;AAIA,OAAM,SAAUC,cAAcA,CAC5BC,UAAoC;EAEpC,MAAM;IAAEC,OAAO;IAAEC;EAAI,CAAE,GAAGF,UAAU;EAEpC,MAAMG,OAAO,GAAGT,SAAS,CAAC;IACxBO,OAAO;IACPC,IAAI;IACJ,MAAME,WAAWA,CAAAC,IAAA,EAAY;MAAA,IAAX;QAAEC;MAAO,CAAE,GAAAD,IAAA;MAC3B,OAAOH,IAAI,CAAC;QACVK,IAAI,EAAEX,WAAW,CAACU,OAAO;OAC1B,CAAC;IACJ,CAAC;IACD,MAAME,eAAeA,CAACC,WAAW;MAC/B,MAAMC,mBAAmB,GAAAC,aAAA,CAAAA,aAAA,KACpBF,WAAW;QACdG,IAAI,EAAE,IAAI,CAACX;MAAQ,EACmB;MAExC,OAAOH,oBAAoB,CAAAa,aAAA,CAAAA,aAAA,KACtBD,mBAAmB;QACtBG,eAAe,EAAE,MAAMX,IAAI,CAAC;UAC1BK,IAAI,EAAEZ,SAAS,CAACG,oBAAoB,CAACY,mBAAmB,CAAC;SAC1D;MAAC,EACH,CAAC;IACJ,CAAC;IACD,MAAMI,aAAaA,CAACC,SAAS;MAC3B,OAAOb,IAAI,CAAC;QACVK,IAAI,EAAEV,aAAa,CAACkB,SAAS;OAC9B,CAAC;IACJ;GACD,CAAC;EAEF,OAAAJ,aAAA,CAAAA,aAAA,KACKR,OAAO;IACVa,MAAM,EAAE;EAAoB;AAEhC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}