{"ast":null,"code":"import { handleSendRawTransactionRequest } from \"./request-handlers/send-raw-transaction.js\";\nimport { handleSendTransactionRequest } from \"./request-handlers/send-transaction.js\";\n// Due to some edge cases, we can't import these handlers dynamically\nimport { handleSignRequest } from \"./request-handlers/sign.js\";\nimport { handleSignTransactionRequest } from \"./request-handlers/sign-transaction.js\";\nimport { handleSignTypedDataRequest } from \"./request-handlers/sign-typed-data.js\";\nimport { parseEip155ChainId } from \"./utils.js\";\n/**\n * @internal\n */\nexport async function fulfillRequest(options) {\n  const {\n    wallet,\n    walletConnectClient,\n    thirdwebClient,\n    event: {\n      topic,\n      id,\n      params: {\n        chainId: rawChainId,\n        request\n      }\n    },\n    handlers\n  } = options;\n  const account = wallet.getAccount();\n  if (!account) {\n    throw new Error(\"No account connected to provided wallet\");\n  }\n  let result;\n  try {\n    switch (request.method) {\n      case \"personal_sign\":\n        {\n          if (handlers !== null && handlers !== void 0 && handlers.personal_sign) {\n            result = await handlers.personal_sign({\n              account,\n              params: request.params\n            });\n          } else {\n            result = await handleSignRequest({\n              account,\n              params: request.params\n            });\n          }\n          break;\n        }\n      case \"eth_sign\":\n        {\n          if (handlers !== null && handlers !== void 0 && handlers.eth_sign) {\n            result = await handlers.eth_sign({\n              account,\n              params: request.params\n            });\n          } else {\n            result = await handleSignRequest({\n              account,\n              params: request.params\n            });\n          }\n          break;\n        }\n      case \"eth_signTypedData\":\n        {\n          if (handlers !== null && handlers !== void 0 && handlers.eth_signTypedData) {\n            result = await handlers.eth_signTypedData({\n              account,\n              params: request.params\n            });\n          } else {\n            result = await handleSignTypedDataRequest({\n              account,\n              params: request.params\n            });\n          }\n          break;\n        }\n      case \"eth_signTypedData_v4\":\n        {\n          if (handlers !== null && handlers !== void 0 && handlers.eth_signTypedData_v4) {\n            result = await handlers.eth_signTypedData_v4({\n              account,\n              params: request.params\n            });\n          } else {\n            result = await handleSignTypedDataRequest({\n              account,\n              params: request.params\n            });\n          }\n          break;\n        }\n      case \"eth_signTransaction\":\n        {\n          if (handlers !== null && handlers !== void 0 && handlers.eth_signTransaction) {\n            result = await handlers.eth_signTransaction({\n              account,\n              params: request.params\n            });\n          } else {\n            result = await handleSignTransactionRequest({\n              account,\n              params: request.params\n            });\n          }\n          break;\n        }\n      case \"eth_sendTransaction\":\n        {\n          const chainId = parseEip155ChainId(rawChainId);\n          if (handlers !== null && handlers !== void 0 && handlers.eth_sendTransaction) {\n            result = await handlers.eth_sendTransaction({\n              account,\n              chainId,\n              params: request.params\n            });\n          } else {\n            result = await handleSendTransactionRequest({\n              account,\n              chainId,\n              params: request.params,\n              thirdwebClient\n            });\n          }\n          break;\n        }\n      case \"eth_sendRawTransaction\":\n        {\n          const chainId = parseEip155ChainId(rawChainId);\n          if (handlers !== null && handlers !== void 0 && handlers.eth_sendRawTransaction) {\n            result = await handlers.eth_sendRawTransaction({\n              account,\n              chainId,\n              params: request.params\n            });\n          } else {\n            result = await handleSendRawTransactionRequest({\n              account,\n              chainId,\n              params: request.params\n            });\n          }\n          break;\n        }\n      case \"wallet_addEthereumChain\":\n        {\n          if (handlers !== null && handlers !== void 0 && handlers.wallet_addEthereumChain) {\n            result = await handlers.wallet_addEthereumChain({\n              params: request.params,\n              wallet\n            });\n          } else {\n            throw new Error(\"Unsupported request method: wallet_addEthereumChain\");\n          }\n          break;\n        }\n      case \"wallet_switchEthereumChain\":\n        {\n          if (handlers !== null && handlers !== void 0 && handlers.wallet_switchEthereumChain) {\n            result = await handlers.wallet_switchEthereumChain({\n              params: request.params,\n              wallet\n            });\n          } else {\n            const {\n              handleSwitchChain\n            } = await import(\"./request-handlers/switch-chain.js\");\n            result = await handleSwitchChain({\n              params: request.params,\n              wallet\n            });\n          }\n          break;\n        }\n      default:\n        {\n          const potentialHandler = handlers === null || handlers === void 0 ? void 0 : handlers[request.method];\n          if (potentialHandler) {\n            result = await potentialHandler({\n              account,\n              chainId: parseEip155ChainId(rawChainId),\n              params: request.params\n            });\n          } else {\n            throw new Error(\"Unsupported request method: \".concat(request.method));\n          }\n        }\n    }\n  } catch (error) {\n    result = {\n      code: typeof error === \"object\" && error !== null && \"code\" in error ? error.code : 500,\n      message: typeof error === \"object\" && error !== null && \"message\" in error ? error.message : \"Unknown error\"\n    };\n  }\n  walletConnectClient.respond({\n    response: {\n      id,\n      jsonrpc: \"2.0\",\n      result\n    },\n    topic\n  });\n}","map":{"version":3,"names":["handleSendRawTransactionRequest","handleSendTransactionRequest","handleSignRequest","handleSignTransactionRequest","handleSignTypedDataRequest","parseEip155ChainId","fulfillRequest","options","wallet","walletConnectClient","thirdwebClient","event","topic","id","params","chainId","rawChainId","request","handlers","account","getAccount","Error","result","method","personal_sign","eth_sign","eth_signTypedData","eth_signTypedData_v4","eth_signTransaction","eth_sendTransaction","eth_sendRawTransaction","wallet_addEthereumChain","wallet_switchEthereumChain","handleSwitchChain","potentialHandler","concat","error","code","message","respond","response","jsonrpc"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/wallets/wallet-connect/receiver/session-request.ts"],"sourcesContent":["import type { ThirdwebClient } from \"../../../client/client.js\";\nimport type { Hex } from \"../../../utils/encoding/hex.js\";\nimport type { Wallet } from \"../../interfaces/wallet.js\";\nimport { handleSendRawTransactionRequest } from \"./request-handlers/send-raw-transaction.js\";\nimport { handleSendTransactionRequest } from \"./request-handlers/send-transaction.js\";\n// Due to some edge cases, we can't import these handlers dynamically\nimport { handleSignRequest } from \"./request-handlers/sign.js\";\nimport { handleSignTransactionRequest } from \"./request-handlers/sign-transaction.js\";\nimport { handleSignTypedDataRequest } from \"./request-handlers/sign-typed-data.js\";\nimport type {\n  WalletConnectAddEthereumChainRequestParams,\n  WalletConnectClient,\n  WalletConnectRawTransactionRequestParams,\n  WalletConnectRequestError,\n  WalletConnectRequestHandlers,\n  WalletConnectSessionRequestEvent,\n  WalletConnectSignRequestPrams,\n  WalletConnectSignTypedDataRequestParams,\n  WalletConnectSwitchEthereumChainRequestParams,\n  WalletConnectTransactionRequestParams,\n} from \"./types.js\";\nimport { parseEip155ChainId } from \"./utils.js\";\n\n/**\n * @internal\n */\nexport async function fulfillRequest(options: {\n  wallet: Wallet;\n  walletConnectClient: WalletConnectClient;\n  event: WalletConnectSessionRequestEvent;\n  thirdwebClient: ThirdwebClient;\n  handlers?: WalletConnectRequestHandlers;\n}) {\n  const {\n    wallet,\n    walletConnectClient,\n    thirdwebClient,\n    event: {\n      topic,\n      id,\n      params: { chainId: rawChainId, request },\n    },\n    handlers,\n  } = options;\n\n  const account = wallet.getAccount();\n  if (!account) {\n    throw new Error(\"No account connected to provided wallet\");\n  }\n\n  let result: WalletConnectRequestError | Hex;\n  try {\n    switch (request.method) {\n      case \"personal_sign\": {\n        if (handlers?.personal_sign) {\n          result = await handlers.personal_sign({\n            account,\n            params: request.params as WalletConnectSignRequestPrams,\n          });\n        } else {\n          result = await handleSignRequest({\n            account,\n            params: request.params as WalletConnectSignRequestPrams,\n          });\n        }\n        break;\n      }\n      case \"eth_sign\": {\n        if (handlers?.eth_sign) {\n          result = await handlers.eth_sign({\n            account,\n            params: request.params as WalletConnectSignRequestPrams,\n          });\n        } else {\n          result = await handleSignRequest({\n            account,\n            params: request.params as WalletConnectSignRequestPrams,\n          });\n        }\n        break;\n      }\n      case \"eth_signTypedData\": {\n        if (handlers?.eth_signTypedData) {\n          result = await handlers.eth_signTypedData({\n            account,\n            params: request.params as WalletConnectSignTypedDataRequestParams,\n          });\n        } else {\n          result = await handleSignTypedDataRequest({\n            account,\n            params: request.params as WalletConnectSignTypedDataRequestParams,\n          });\n        }\n        break;\n      }\n      case \"eth_signTypedData_v4\": {\n        if (handlers?.eth_signTypedData_v4) {\n          result = await handlers.eth_signTypedData_v4({\n            account,\n            params: request.params as WalletConnectSignTypedDataRequestParams,\n          });\n        } else {\n          result = await handleSignTypedDataRequest({\n            account,\n            params: request.params as WalletConnectSignTypedDataRequestParams,\n          });\n        }\n        break;\n      }\n      case \"eth_signTransaction\": {\n        if (handlers?.eth_signTransaction) {\n          result = await handlers.eth_signTransaction({\n            account,\n            params: request.params as WalletConnectTransactionRequestParams,\n          });\n        } else {\n          result = await handleSignTransactionRequest({\n            account,\n            params: request.params as WalletConnectTransactionRequestParams,\n          });\n        }\n        break;\n      }\n      case \"eth_sendTransaction\": {\n        const chainId = parseEip155ChainId(rawChainId);\n        if (handlers?.eth_sendTransaction) {\n          result = await handlers.eth_sendTransaction({\n            account,\n            chainId,\n            params: request.params as WalletConnectTransactionRequestParams,\n          });\n        } else {\n          result = await handleSendTransactionRequest({\n            account,\n            chainId,\n            params: request.params as WalletConnectTransactionRequestParams,\n            thirdwebClient,\n          });\n        }\n        break;\n      }\n      case \"eth_sendRawTransaction\": {\n        const chainId = parseEip155ChainId(rawChainId);\n        if (handlers?.eth_sendRawTransaction) {\n          result = await handlers.eth_sendRawTransaction({\n            account,\n            chainId,\n            params: request.params as WalletConnectRawTransactionRequestParams,\n          });\n        } else {\n          result = await handleSendRawTransactionRequest({\n            account,\n            chainId,\n            params: request.params as WalletConnectRawTransactionRequestParams,\n          });\n        }\n        break;\n      }\n      case \"wallet_addEthereumChain\": {\n        if (handlers?.wallet_addEthereumChain) {\n          result = await handlers.wallet_addEthereumChain({\n            params:\n              request.params as WalletConnectAddEthereumChainRequestParams,\n            wallet,\n          });\n        } else {\n          throw new Error(\n            \"Unsupported request method: wallet_addEthereumChain\",\n          );\n        }\n        break;\n      }\n      case \"wallet_switchEthereumChain\": {\n        if (handlers?.wallet_switchEthereumChain) {\n          result = await handlers.wallet_switchEthereumChain({\n            params:\n              request.params as WalletConnectSwitchEthereumChainRequestParams,\n            wallet,\n          });\n        } else {\n          const { handleSwitchChain } = await import(\n            \"./request-handlers/switch-chain.js\"\n          );\n\n          result = await handleSwitchChain({\n            params:\n              request.params as WalletConnectSwitchEthereumChainRequestParams,\n            wallet,\n          });\n        }\n        break;\n      }\n      default: {\n        const potentialHandler = handlers?.[request.method];\n        if (potentialHandler) {\n          result = await potentialHandler({\n            account,\n            chainId: parseEip155ChainId(rawChainId),\n            params: request.params,\n          });\n        } else {\n          throw new Error(`Unsupported request method: ${request.method}`);\n        }\n      }\n    }\n  } catch (error: unknown) {\n    result = {\n      code:\n        typeof error === \"object\" && error !== null && \"code\" in error\n          ? (error as { code: number }).code\n          : 500,\n      message:\n        typeof error === \"object\" && error !== null && \"message\" in error\n          ? (error as { message: string }).message\n          : \"Unknown error\",\n    };\n  }\n\n  walletConnectClient.respond({\n    response: {\n      id,\n      jsonrpc: \"2.0\",\n      result,\n    },\n    topic,\n  });\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}