{"ast":null,"code":"import _objectSpread from \"/home/user/Arbitrage/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { watchBlockNumber } from \"../../rpc/watchBlockNumber.js\";\nimport { retry } from \"../../utils/retry.js\";\nimport { getContractEvents } from \"./get-events.js\";\n/**\n * Listens for  contract events from the blockchain.\n * @param options - The options for retrieving contract events.\n * @returns The unwatch function.\n * @example\n * ### Listen to all events for a contract\n * ```ts\n * import { watchContractEvents } from \"thirdweb\";\n * const unwatch = watchContractEvents({\n *  contract: myContract,\n *  onEvents: (events) => {\n *   // do something with the events\n *  },\n * });\n * ```\n *\n * ### Listen to specific events for a contract\n * ```ts\n * import { prepareEvent, watchContractEvents } from \"thirdweb\";\n * const myEvent = prepareEvent({\n *  event: \"event MyEvent(uint256 myArg)\",\n * });\n * const events = await watchContractEvents({\n *  contract: myContract,\n *  events: [myEvent],\n *  onEvents: (events) => {\n *   // do something with the events\n *  },\n * });\n * ```\n * @contract\n */\nexport function watchContractEvents(options) {\n  // returning this returns the underlying \"unwatch\" function\n  return watchBlockNumber(_objectSpread(_objectSpread({}, options.contract), {}, {\n    latestBlockNumber: options.latestBlockNumber,\n    /**\n     * This function is called every time a new block is mined.\n     * @param blockNumber - The block number of the new block.\n     * @returns A promise that resolves when the function is finished.\n     * @internal\n     */\n    onNewBlockNumber: async blockNumber => {\n      const logs = await retry(async () => getContractEvents(_objectSpread(_objectSpread({}, options), {}, {\n        // fromBlock is inclusive\n        fromBlock: blockNumber,\n        // toBlock is inclusive\n        toBlock: blockNumber,\n        useIndexer: false\n      })), {\n        delay: 500,\n        retries: 3\n      });\n      // if there were any logs associated with our event(s)\n      if (logs.length) {\n        options.onEvents(logs);\n      }\n    }\n  }));\n}","map":{"version":3,"names":["watchBlockNumber","retry","getContractEvents","watchContractEvents","options","_objectSpread","contract","latestBlockNumber","onNewBlockNumber","blockNumber","logs","fromBlock","toBlock","useIndexer","delay","retries","length","onEvents"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/event/actions/watch-events.ts"],"sourcesContent":["import type { Abi, AbiEvent } from \"abitype\";\nimport { watchBlockNumber } from \"../../rpc/watchBlockNumber.js\";\nimport { retry } from \"../../utils/retry.js\";\nimport type { Prettify } from \"../../utils/type-utils.js\";\nimport type { PreparedEvent } from \"../prepare-event.js\";\nimport {\n  type GetContractEventsOptionsDirect,\n  getContractEvents,\n} from \"./get-events.js\";\nimport type { ParseEventLogsResult } from \"./parse-logs.js\";\n\nexport type WatchContractEventsOptions<\n  abi extends Abi,\n  abiEvents extends PreparedEvent<AbiEvent>[],\n  TStrict extends boolean,\n> = Prettify<\n  GetContractEventsOptionsDirect<abi, abiEvents, TStrict> & {\n    onEvents: (events: ParseEventLogsResult<abiEvents, TStrict>) => void;\n    latestBlockNumber?: bigint;\n  }\n>;\n\n/**\n * Listens for  contract events from the blockchain.\n * @param options - The options for retrieving contract events.\n * @returns The unwatch function.\n * @example\n * ### Listen to all events for a contract\n * ```ts\n * import { watchContractEvents } from \"thirdweb\";\n * const unwatch = watchContractEvents({\n *  contract: myContract,\n *  onEvents: (events) => {\n *   // do something with the events\n *  },\n * });\n * ```\n *\n * ### Listen to specific events for a contract\n * ```ts\n * import { prepareEvent, watchContractEvents } from \"thirdweb\";\n * const myEvent = prepareEvent({\n *  event: \"event MyEvent(uint256 myArg)\",\n * });\n * const events = await watchContractEvents({\n *  contract: myContract,\n *  events: [myEvent],\n *  onEvents: (events) => {\n *   // do something with the events\n *  },\n * });\n * ```\n * @contract\n */\nexport function watchContractEvents<\n  const abi extends Abi,\n  const abiEvents extends PreparedEvent<AbiEvent>[],\n  const TStrict extends boolean = true,\n>(options: WatchContractEventsOptions<abi, abiEvents, TStrict>) {\n  // returning this returns the underlying \"unwatch\" function\n  return watchBlockNumber({\n    ...options.contract,\n    latestBlockNumber: options.latestBlockNumber,\n\n    /**\n     * This function is called every time a new block is mined.\n     * @param blockNumber - The block number of the new block.\n     * @returns A promise that resolves when the function is finished.\n     * @internal\n     */\n    onNewBlockNumber: async (blockNumber) => {\n      const logs = await retry(\n        async () =>\n          getContractEvents({\n            ...options,\n            // fromBlock is inclusive\n            fromBlock: blockNumber,\n            // toBlock is inclusive\n            toBlock: blockNumber,\n            useIndexer: false,\n          }),\n        {\n          delay: 500,\n          retries: 3,\n        },\n      );\n      // if there were any logs associated with our event(s)\n      if (logs.length) {\n        options.onEvents(logs);\n      }\n    },\n  });\n}\n"],"mappings":";AACA,SAASA,gBAAgB,QAAQ,+BAA+B;AAChE,SAASC,KAAK,QAAQ,sBAAsB;AAG5C,SAEEC,iBAAiB,QACZ,iBAAiB;AAcxB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA,OAAM,SAAUC,mBAAmBA,CAIjCC,OAA4D;EAC5D;EACA,OAAOJ,gBAAgB,CAAAK,aAAA,CAAAA,aAAA,KAClBD,OAAO,CAACE,QAAQ;IACnBC,iBAAiB,EAAEH,OAAO,CAACG,iBAAiB;IAE5C;;;;;;IAMAC,gBAAgB,EAAE,MAAOC,WAAW,IAAI;MACtC,MAAMC,IAAI,GAAG,MAAMT,KAAK,CACtB,YACEC,iBAAiB,CAAAG,aAAA,CAAAA,aAAA,KACZD,OAAO;QACV;QACAO,SAAS,EAAEF,WAAW;QACtB;QACAG,OAAO,EAAEH,WAAW;QACpBI,UAAU,EAAE;MAAK,EAClB,CAAC,EACJ;QACEC,KAAK,EAAE,GAAG;QACVC,OAAO,EAAE;OACV,CACF;MACD;MACA,IAAIL,IAAI,CAACM,MAAM,EAAE;QACfZ,OAAO,CAACa,QAAQ,CAACP,IAAI,CAAC;MACxB;IACF;EAAC,EACF,CAAC;AACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}