{"ast":null,"code":"import { getThirdwebDomains } from \"../../utils/domains.js\";\nimport { getClientFetch } from \"../../utils/fetch.js\";\nimport { IS_TEST } from \"../../utils/process.js\";\nimport { addToMockStorage } from \"../mock.js\";\nexport async function uploadBatch(client, form, fileNames, options) {\n  var _client$config;\n  if (IS_TEST) {\n    return addToMockStorage(form);\n  }\n  const headers = {};\n  const res = await getClientFetch(client)(\"https://\".concat(getThirdwebDomains().storage, \"/ipfs/upload\"), {\n    body: form,\n    headers,\n    method: \"POST\",\n    requestTimeoutMs: ((_client$config = client.config) === null || _client$config === void 0 || (_client$config = _client$config.storage) === null || _client$config === void 0 || (_client$config = _client$config.fetch) === null || _client$config === void 0 ? void 0 : _client$config.requestTimeoutMs) || 120000,\n    // force auth token usage for storage uploads\n    useAuthToken: true\n  });\n  if (!res.ok) {\n    if (res.status === 401) {\n      throw new Error(\"Unauthorized - You don't have permission to use this service.\");\n    }\n    if (res.status === 402) {\n      throw new Error(\"You have reached your storage limit. Please add a valid payment method to continue using the service.\");\n    }\n    if (res.status === 403) {\n      throw new Error(\"Forbidden - You don't have permission to use this service.\");\n    }\n    throw new Error(\"Failed to upload files to IPFS - \".concat(res.status, \" - \").concat(res.statusText));\n  }\n  const body = await res.json();\n  const cid = body.IpfsHash;\n  if (!cid) {\n    throw new Error(\"Failed to upload files to IPFS - Bad CID\");\n  }\n  if (options !== null && options !== void 0 && options.uploadWithoutDirectory) {\n    return [\"ipfs://\".concat(cid)];\n  }\n  return fileNames.map(name => \"ipfs://\".concat(cid, \"/\").concat(name));\n}","map":{"version":3,"names":["getThirdwebDomains","getClientFetch","IS_TEST","addToMockStorage","uploadBatch","client","form","fileNames","options","_client$config","headers","res","concat","storage","body","method","requestTimeoutMs","config","fetch","useAuthToken","ok","status","Error","statusText","json","cid","IpfsHash","uploadWithoutDirectory","map","name"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/storage/upload/web-node.ts"],"sourcesContent":["import type { ThirdwebClient } from \"../../client/client.js\";\nimport { getThirdwebDomains } from \"../../utils/domains.js\";\nimport { getClientFetch } from \"../../utils/fetch.js\";\nimport { IS_TEST } from \"../../utils/process.js\";\nimport { addToMockStorage } from \"../mock.js\";\nimport type { UploadableFile, UploadOptions } from \"./types.js\";\n\nexport async function uploadBatch<const TFiles extends UploadableFile[]>(\n  client: ThirdwebClient,\n  form: FormData,\n  fileNames: string[],\n  options?: UploadOptions<TFiles>,\n) {\n  if (IS_TEST) {\n    return addToMockStorage(form);\n  }\n\n  const headers: HeadersInit = {};\n\n  const res = await getClientFetch(client)(\n    `https://${getThirdwebDomains().storage}/ipfs/upload`,\n    {\n      body: form,\n      headers,\n      method: \"POST\",\n      requestTimeoutMs:\n        client.config?.storage?.fetch?.requestTimeoutMs || 120000,\n      // force auth token usage for storage uploads\n      useAuthToken: true,\n    },\n  );\n\n  if (!res.ok) {\n    if (res.status === 401) {\n      throw new Error(\n        \"Unauthorized - You don't have permission to use this service.\",\n      );\n    }\n    if (res.status === 402) {\n      throw new Error(\n        \"You have reached your storage limit. Please add a valid payment method to continue using the service.\",\n      );\n    }\n    if (res.status === 403) {\n      throw new Error(\n        \"Forbidden - You don't have permission to use this service.\",\n      );\n    }\n    throw new Error(\n      `Failed to upload files to IPFS - ${res.status} - ${res.statusText}`,\n    );\n  }\n\n  const body = await res.json();\n\n  const cid = body.IpfsHash;\n  if (!cid) {\n    throw new Error(\"Failed to upload files to IPFS - Bad CID\");\n  }\n\n  if (options?.uploadWithoutDirectory) {\n    return [`ipfs://${cid}`];\n  }\n  return fileNames.map((name) => `ipfs://${cid}/${name}`);\n}\n"],"mappings":"AACA,SAASA,kBAAkB,QAAQ,wBAAwB;AAC3D,SAASC,cAAc,QAAQ,sBAAsB;AACrD,SAASC,OAAO,QAAQ,wBAAwB;AAChD,SAASC,gBAAgB,QAAQ,YAAY;AAG7C,OAAO,eAAeC,WAAWA,CAC/BC,MAAsB,EACtBC,IAAc,EACdC,SAAmB,EACnBC,OAA+B;EAAA,IAAAC,cAAA;EAE/B,IAAIP,OAAO,EAAE;IACX,OAAOC,gBAAgB,CAACG,IAAI,CAAC;EAC/B;EAEA,MAAMI,OAAO,GAAgB,EAAE;EAE/B,MAAMC,GAAG,GAAG,MAAMV,cAAc,CAACI,MAAM,CAAC,YAAAO,MAAA,CAC3BZ,kBAAkB,EAAE,CAACa,OAAO,mBACvC;IACEC,IAAI,EAAER,IAAI;IACVI,OAAO;IACPK,MAAM,EAAE,MAAM;IACdC,gBAAgB,EACd,EAAAP,cAAA,GAAAJ,MAAM,CAACY,MAAM,cAAAR,cAAA,gBAAAA,cAAA,GAAbA,cAAA,CAAeI,OAAO,cAAAJ,cAAA,gBAAAA,cAAA,GAAtBA,cAAA,CAAwBS,KAAK,cAAAT,cAAA,uBAA7BA,cAAA,CAA+BO,gBAAgB,KAAI,MAAM;IAC3D;IACAG,YAAY,EAAE;GACf,CACF;EAED,IAAI,CAACR,GAAG,CAACS,EAAE,EAAE;IACX,IAAIT,GAAG,CAACU,MAAM,KAAK,GAAG,EAAE;MACtB,MAAM,IAAIC,KAAK,CACb,+DAA+D,CAChE;IACH;IACA,IAAIX,GAAG,CAACU,MAAM,KAAK,GAAG,EAAE;MACtB,MAAM,IAAIC,KAAK,CACb,uGAAuG,CACxG;IACH;IACA,IAAIX,GAAG,CAACU,MAAM,KAAK,GAAG,EAAE;MACtB,MAAM,IAAIC,KAAK,CACb,4DAA4D,CAC7D;IACH;IACA,MAAM,IAAIA,KAAK,qCAAAV,MAAA,CACuBD,GAAG,CAACU,MAAM,SAAAT,MAAA,CAAMD,GAAG,CAACY,UAAU,CAAE,CACrE;EACH;EAEA,MAAMT,IAAI,GAAG,MAAMH,GAAG,CAACa,IAAI,EAAE;EAE7B,MAAMC,GAAG,GAAGX,IAAI,CAACY,QAAQ;EACzB,IAAI,CAACD,GAAG,EAAE;IACR,MAAM,IAAIH,KAAK,CAAC,0CAA0C,CAAC;EAC7D;EAEA,IAAId,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAEmB,sBAAsB,EAAE;IACnC,OAAO,WAAAf,MAAA,CAAWa,GAAG,EAAG;EAC1B;EACA,OAAOlB,SAAS,CAACqB,GAAG,CAAEC,IAAI,cAAAjB,MAAA,CAAea,GAAG,OAAAb,MAAA,CAAIiB,IAAI,CAAE,CAAC;AACzD","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}