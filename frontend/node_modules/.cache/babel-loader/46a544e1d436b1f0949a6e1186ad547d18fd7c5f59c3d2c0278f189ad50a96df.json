{"ast":null,"code":"\"use client\";\n\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { webLocalStorage } from \"../../../../utils/storage/webStorage.js\";\nimport { isEcosystemWallet } from \"../../../../wallets/ecosystem/is-ecosystem-wallet.js\";\nimport { setLastAuthProvider } from \"../../../core/utils/storage.js\";\nimport { Container, ModalHeader } from \"../../ui/components/basic.js\";\nimport { Button } from \"../../ui/components/buttons.js\";\nimport { Spacer } from \"../../ui/components/Spacer.js\";\nimport { Spinner } from \"../../ui/components/Spinner.js\";\nimport { Text } from \"../../ui/components/text.js\";\n/**\n * @internal\n */\nexport function GuestLogin(props) {\n  var _props$state;\n  const ewLocale = props.locale;\n  const locale = ewLocale.socialLoginScreen;\n  const [authError, setAuthError] = useState(undefined);\n  const {\n    done,\n    wallet\n  } = props;\n  const [status, setStatus] = useState(\"connecting\");\n  const handleGuestLogin = async () => {\n    var _wallet$getConfig;\n    const connectOptions = {\n      client: props.client,\n      ecosystem: isEcosystemWallet(wallet) ? {\n        id: wallet.id,\n        partnerId: (_wallet$getConfig = wallet.getConfig()) === null || _wallet$getConfig === void 0 ? void 0 : _wallet$getConfig.partnerId\n      } : undefined,\n      strategy: \"guest\"\n    };\n    try {\n      await wallet.connect(connectOptions);\n      await setLastAuthProvider(\"guest\", webLocalStorage);\n      setStatus(\"connected\");\n      done();\n    } catch (e) {\n      var _e$message;\n      setStatus(\"error\");\n      // TODO this only happens on 'retry' button click, not on initial login\n      // should pass auth error message to this component\n      if (e instanceof Error && e !== null && e !== void 0 && (_e$message = e.message) !== null && _e$message !== void 0 && _e$message.includes(\"PAYMENT_METHOD_REQUIRED\")) {\n        setAuthError(ewLocale.maxAccountsExceeded);\n      }\n      console.error(\"Error generating guest account\", e);\n    }\n  };\n  const guestLogin = (_props$state = props.state) === null || _props$state === void 0 ? void 0 : _props$state.guestLogin;\n  const socialLoginStarted = useRef(false);\n  useEffect(() => {\n    if (socialLoginStarted.current) {\n      return;\n    }\n    if (guestLogin) {\n      socialLoginStarted.current = true;\n      setStatus(\"connecting\");\n      guestLogin.connectionPromise.then(() => {\n        done();\n        setStatus(\"connected\");\n      }).catch(e => {\n        setAuthError(e.message);\n        setStatus(\"error\");\n      });\n    }\n  }, [done, guestLogin]);\n  return _jsx(Container, {\n    animate: \"fadein\",\n    flex: \"column\",\n    fullHeight: true,\n    className: \"tw-guest-login-screen\",\n    children: _jsxs(Container, {\n      expand: true,\n      flex: \"column\",\n      p: \"lg\",\n      style: {\n        paddingBottom: 0\n      },\n      children: [props.goBack && _jsx(ModalHeader, {\n        onBack: props.goBack,\n        title: locale.title\n      }), props.size === \"compact\" ? _jsx(Spacer, {\n        y: \"xl\"\n      }) : null, _jsxs(Container, {\n        center: \"both\",\n        expand: true,\n        flex: \"column\",\n        style: {\n          minHeight: \"250px\",\n          textAlign: \"center\"\n        },\n        children: [status !== \"error\" && _jsxs(Container, {\n          animate: \"fadein\",\n          children: [_jsx(Text, {\n            center: true,\n            color: \"primaryText\",\n            multiline: true,\n            style: {\n              maxWidth: \"250px\"\n            },\n            children: \"Generating your guest account\"\n          }), _jsx(Spacer, {\n            y: \"xl\"\n          }), _jsx(Container, {\n            center: \"x\",\n            flex: \"row\",\n            children: _jsx(Spinner, {\n              color: \"accentText\",\n              size: \"lg\"\n            })\n          }), _jsx(Spacer, {\n            y: \"xxl\"\n          })]\n        }), status === \"error\" && _jsxs(Container, {\n          animate: \"fadein\",\n          children: [authError ? _jsx(Text, {\n            center: true,\n            color: \"danger\",\n            children: authError\n          }) : _jsx(Text, {\n            color: \"danger\",\n            children: locale.failed\n          }), _jsx(Spacer, {\n            y: \"lg\"\n          }), _jsx(Button, {\n            onClick: handleGuestLogin,\n            variant: \"primary\",\n            children: locale.retry\n          }), _jsx(Spacer, {\n            y: \"xxl\"\n          })]\n        })]\n      })]\n    })\n  });\n}","map":{"version":3,"names":["useEffect","useRef","useState","webLocalStorage","isEcosystemWallet","setLastAuthProvider","Container","ModalHeader","Button","Spacer","Spinner","Text","GuestLogin","props","_props$state","ewLocale","locale","socialLoginScreen","authError","setAuthError","undefined","done","wallet","status","setStatus","handleGuestLogin","_wallet$getConfig","connectOptions","client","ecosystem","id","partnerId","getConfig","strategy","connect","e","_e$message","Error","message","includes","maxAccountsExceeded","console","error","guestLogin","state","socialLoginStarted","current","connectionPromise","then","catch","_jsx","animate","flex","fullHeight","className","children","_jsxs","expand","p","style","paddingBottom","goBack","onBack","title","size","y","center","minHeight","textAlign","color","multiline","maxWidth","failed","onClick","variant","retry"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/react/web/wallets/shared/GuestLogin.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useRef, useState } from \"react\";\nimport type { ThirdwebClient } from \"../../../../client/client.js\";\nimport { webLocalStorage } from \"../../../../utils/storage/webStorage.js\";\nimport { isEcosystemWallet } from \"../../../../wallets/ecosystem/is-ecosystem-wallet.js\";\nimport type { Wallet } from \"../../../../wallets/interfaces/wallet.js\";\nimport { setLastAuthProvider } from \"../../../core/utils/storage.js\";\nimport type { ConnectLocale } from \"../../ui/ConnectWallet/locale/types.js\";\nimport { Container, ModalHeader } from \"../../ui/components/basic.js\";\nimport { Button } from \"../../ui/components/buttons.js\";\nimport { Spacer } from \"../../ui/components/Spacer.js\";\nimport { Spinner } from \"../../ui/components/Spinner.js\";\nimport { Text } from \"../../ui/components/text.js\";\nimport type { ConnectWalletSelectUIState } from \"./ConnectWalletSocialOptions.js\";\nimport type { InAppWalletLocale } from \"./locale/types.js\";\n\n/**\n * @internal\n */\nexport function GuestLogin(props: {\n  locale: InAppWalletLocale;\n  wallet: Wallet;\n  done: () => void;\n  goBack?: () => void;\n  state: ConnectWalletSelectUIState;\n  size: \"compact\" | \"wide\";\n  client: ThirdwebClient;\n  connectLocale: ConnectLocale;\n}) {\n  const ewLocale = props.locale;\n  const locale = ewLocale.socialLoginScreen;\n\n  const [authError, setAuthError] = useState<string | undefined>(undefined);\n  const { done, wallet } = props;\n  const [status, setStatus] = useState<\"connecting\" | \"connected\" | \"error\">(\n    \"connecting\",\n  );\n\n  const handleGuestLogin = async () => {\n    const connectOptions = {\n      client: props.client,\n      ecosystem: isEcosystemWallet(wallet)\n        ? {\n            id: wallet.id,\n            partnerId: wallet.getConfig()?.partnerId,\n          }\n        : undefined,\n      strategy: \"guest\" as const,\n    };\n    try {\n      await wallet.connect(connectOptions);\n      await setLastAuthProvider(\"guest\", webLocalStorage);\n\n      setStatus(\"connected\");\n      done();\n    } catch (e) {\n      setStatus(\"error\");\n      // TODO this only happens on 'retry' button click, not on initial login\n      // should pass auth error message to this component\n      if (\n        e instanceof Error &&\n        e?.message?.includes(\"PAYMENT_METHOD_REQUIRED\")\n      ) {\n        setAuthError(ewLocale.maxAccountsExceeded);\n      }\n      console.error(\"Error generating guest account\", e);\n    }\n  };\n\n  const guestLogin = props.state?.guestLogin;\n\n  const socialLoginStarted = useRef(false);\n  useEffect(() => {\n    if (socialLoginStarted.current) {\n      return;\n    }\n\n    if (guestLogin) {\n      socialLoginStarted.current = true;\n      setStatus(\"connecting\");\n      guestLogin.connectionPromise\n        .then(() => {\n          done();\n          setStatus(\"connected\");\n        })\n        .catch((e) => {\n          setAuthError(e.message);\n          setStatus(\"error\");\n        });\n    }\n  }, [done, guestLogin]);\n\n  return (\n    <Container\n      animate=\"fadein\"\n      flex=\"column\"\n      fullHeight\n      className=\"tw-guest-login-screen\"\n    >\n      <Container\n        expand\n        flex=\"column\"\n        p=\"lg\"\n        style={{\n          paddingBottom: 0,\n        }}\n      >\n        {props.goBack && (\n          <ModalHeader onBack={props.goBack} title={locale.title} />\n        )}\n\n        {props.size === \"compact\" ? <Spacer y=\"xl\" /> : null}\n\n        <Container\n          center=\"both\"\n          expand\n          flex=\"column\"\n          style={{\n            minHeight: \"250px\",\n            textAlign: \"center\",\n          }}\n        >\n          {status !== \"error\" && (\n            <Container animate=\"fadein\">\n              <Text\n                center\n                color=\"primaryText\"\n                multiline\n                style={{\n                  maxWidth: \"250px\",\n                }}\n              >\n                Generating your guest account\n              </Text>\n              <Spacer y=\"xl\" />\n              <Container center=\"x\" flex=\"row\">\n                <Spinner color=\"accentText\" size=\"lg\" />\n              </Container>\n\n              <Spacer y=\"xxl\" />\n            </Container>\n          )}\n\n          {status === \"error\" && (\n            <Container animate=\"fadein\">\n              {authError ? (\n                <Text center color=\"danger\">\n                  {authError}\n                </Text>\n              ) : (\n                <Text color=\"danger\">{locale.failed}</Text>\n              )}\n              <Spacer y=\"lg\" />\n              <Button onClick={handleGuestLogin} variant=\"primary\">\n                {locale.retry}\n              </Button>\n              <Spacer y=\"xxl\" />\n            </Container>\n          )}\n        </Container>\n      </Container>\n    </Container>\n  );\n}\n"],"mappings":"AAAA,YAAY;;;AACZ,SAASA,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AAEnD,SAASC,eAAe,QAAQ,yCAAyC;AACzE,SAASC,iBAAiB,QAAQ,sDAAsD;AAExF,SAASC,mBAAmB,QAAQ,gCAAgC;AAEpE,SAASC,SAAS,EAAEC,WAAW,QAAQ,8BAA8B;AACrE,SAASC,MAAM,QAAQ,gCAAgC;AACvD,SAASC,MAAM,QAAQ,+BAA+B;AACtD,SAASC,OAAO,QAAQ,gCAAgC;AACxD,SAASC,IAAI,QAAQ,6BAA6B;AAIlD;;;AAGA,OAAM,SAAUC,UAAUA,CAACC,KAS1B;EAAA,IAAAC,YAAA;EACC,MAAMC,QAAQ,GAAGF,KAAK,CAACG,MAAM;EAC7B,MAAMA,MAAM,GAAGD,QAAQ,CAACE,iBAAiB;EAEzC,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGjB,QAAQ,CAAqBkB,SAAS,CAAC;EACzE,MAAM;IAAEC,IAAI;IAAEC;EAAM,CAAE,GAAGT,KAAK;EAC9B,MAAM,CAACU,MAAM,EAAEC,SAAS,CAAC,GAAGtB,QAAQ,CAClC,YAAY,CACb;EAED,MAAMuB,gBAAgB,GAAG,MAAAA,CAAA,KAAW;IAAA,IAAAC,iBAAA;IAClC,MAAMC,cAAc,GAAG;MACrBC,MAAM,EAAEf,KAAK,CAACe,MAAM;MACpBC,SAAS,EAAEzB,iBAAiB,CAACkB,MAAM,CAAC,GAChC;QACEQ,EAAE,EAAER,MAAM,CAACQ,EAAE;QACbC,SAAS,GAAAL,iBAAA,GAAEJ,MAAM,CAACU,SAAS,EAAE,cAAAN,iBAAA,uBAAlBA,iBAAA,CAAoBK;OAChC,GACDX,SAAS;MACba,QAAQ,EAAE;KACX;IACD,IAAI;MACF,MAAMX,MAAM,CAACY,OAAO,CAACP,cAAc,CAAC;MACpC,MAAMtB,mBAAmB,CAAC,OAAO,EAAEF,eAAe,CAAC;MAEnDqB,SAAS,CAAC,WAAW,CAAC;MACtBH,IAAI,EAAE;IACR,CAAC,CAAC,OAAOc,CAAC,EAAE;MAAA,IAAAC,UAAA;MACVZ,SAAS,CAAC,OAAO,CAAC;MAClB;MACA;MACA,IACEW,CAAC,YAAYE,KAAK,IAClBF,CAAC,aAADA,CAAC,gBAAAC,UAAA,GAADD,CAAC,CAAEG,OAAO,cAAAF,UAAA,eAAVA,UAAA,CAAYG,QAAQ,CAAC,yBAAyB,CAAC,EAC/C;QACApB,YAAY,CAACJ,QAAQ,CAACyB,mBAAmB,CAAC;MAC5C;MACAC,OAAO,CAACC,KAAK,CAAC,gCAAgC,EAAEP,CAAC,CAAC;IACpD;EACF,CAAC;EAED,MAAMQ,UAAU,IAAA7B,YAAA,GAAGD,KAAK,CAAC+B,KAAK,cAAA9B,YAAA,uBAAXA,YAAA,CAAa6B,UAAU;EAE1C,MAAME,kBAAkB,GAAG5C,MAAM,CAAC,KAAK,CAAC;EACxCD,SAAS,CAAC,MAAK;IACb,IAAI6C,kBAAkB,CAACC,OAAO,EAAE;MAC9B;IACF;IAEA,IAAIH,UAAU,EAAE;MACdE,kBAAkB,CAACC,OAAO,GAAG,IAAI;MACjCtB,SAAS,CAAC,YAAY,CAAC;MACvBmB,UAAU,CAACI,iBAAiB,CACzBC,IAAI,CAAC,MAAK;QACT3B,IAAI,EAAE;QACNG,SAAS,CAAC,WAAW,CAAC;MACxB,CAAC,CAAC,CACDyB,KAAK,CAAEd,CAAC,IAAI;QACXhB,YAAY,CAACgB,CAAC,CAACG,OAAO,CAAC;QACvBd,SAAS,CAAC,OAAO,CAAC;MACpB,CAAC,CAAC;IACN;EACF,CAAC,EAAE,CAACH,IAAI,EAAEsB,UAAU,CAAC,CAAC;EAEtB,OACEO,IAAA,CAAC5C,SAAS;IACR6C,OAAO,EAAC,QAAQ;IAChBC,IAAI,EAAC,QAAQ;IACbC,UAAU;IACVC,SAAS,EAAC,uBAAuB;IAAAC,QAAA,EAEjCC,KAAA,CAAClD,SAAS;MACRmD,MAAM;MACNL,IAAI,EAAC,QAAQ;MACbM,CAAC,EAAC,IAAI;MACNC,KAAK,EAAE;QACLC,aAAa,EAAE;OAChB;MAAAL,QAAA,GAEA1C,KAAK,CAACgD,MAAM,IACXX,IAAA,CAAC3C,WAAW;QAACuD,MAAM,EAAEjD,KAAK,CAACgD,MAAM;QAAEE,KAAK,EAAE/C,MAAM,CAAC+C;MAAK,EACvD,EAEAlD,KAAK,CAACmD,IAAI,KAAK,SAAS,GAAGd,IAAA,CAACzC,MAAM;QAACwD,CAAC,EAAC;MAAI,EAAG,GAAG,IAAI,EAEpDT,KAAA,CAAClD,SAAS;QACR4D,MAAM,EAAC,MAAM;QACbT,MAAM;QACNL,IAAI,EAAC,QAAQ;QACbO,KAAK,EAAE;UACLQ,SAAS,EAAE,OAAO;UAClBC,SAAS,EAAE;SACZ;QAAAb,QAAA,GAEAhC,MAAM,KAAK,OAAO,IACjBiC,KAAA,CAAClD,SAAS;UAAC6C,OAAO,EAAC,QAAQ;UAAAI,QAAA,GACzBL,IAAA,CAACvC,IAAI;YACHuD,MAAM;YACNG,KAAK,EAAC,aAAa;YACnBC,SAAS;YACTX,KAAK,EAAE;cACLY,QAAQ,EAAE;aACX;YAAAhB,QAAA;UAAA,EAGI,EACPL,IAAA,CAACzC,MAAM;YAACwD,CAAC,EAAC;UAAI,EAAG,EACjBf,IAAA,CAAC5C,SAAS;YAAC4D,MAAM,EAAC,GAAG;YAACd,IAAI,EAAC,KAAK;YAAAG,QAAA,EAC9BL,IAAA,CAACxC,OAAO;cAAC2D,KAAK,EAAC,YAAY;cAACL,IAAI,EAAC;YAAI;UAAG,EAC9B,EAEZd,IAAA,CAACzC,MAAM;YAACwD,CAAC,EAAC;UAAK,EAAG;QAAA,EAErB,EAEA1C,MAAM,KAAK,OAAO,IACjBiC,KAAA,CAAClD,SAAS;UAAC6C,OAAO,EAAC,QAAQ;UAAAI,QAAA,GACxBrC,SAAS,GACRgC,IAAA,CAACvC,IAAI;YAACuD,MAAM;YAACG,KAAK,EAAC,QAAQ;YAAAd,QAAA,EACxBrC;UAAS,EACL,GAEPgC,IAAA,CAACvC,IAAI;YAAC0D,KAAK,EAAC,QAAQ;YAAAd,QAAA,EAAEvC,MAAM,CAACwD;UAAM,EACpC,EACDtB,IAAA,CAACzC,MAAM;YAACwD,CAAC,EAAC;UAAI,EAAG,EACjBf,IAAA,CAAC1C,MAAM;YAACiE,OAAO,EAAEhD,gBAAgB;YAAEiD,OAAO,EAAC,SAAS;YAAAnB,QAAA,EACjDvC,MAAM,CAAC2D;UAAK,EACN,EACTzB,IAAA,CAACzC,MAAM;YAACwD,CAAC,EAAC;UAAK,EAAG;QAAA,EAErB;MAAA,EACS;IAAA;EACF,EACF;AAEhB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}