{"ast":null,"code":"import { ZERO_ADDRESS } from \"../../../constants/addresses.js\";\nimport { dateToSeconds, tenYearsFromNow } from \"../../../utils/date.js\";\nimport { randomBytesHex } from \"../../../utils/random.js\";\nimport { toWei } from \"../../../utils/units.js\";\nimport { SignerPermissionRequest } from \"./types.js\";\n/**\n * @internal\n */\nexport async function signPermissionRequest(options) {\n  const {\n    account,\n    contract,\n    req\n  } = options;\n  const signature = await account.signTypedData({\n    domain: {\n      chainId: contract.chain.id,\n      name: \"Account\",\n      verifyingContract: contract.address,\n      version: \"1\"\n    },\n    message: req,\n    primaryType: \"SignerPermissionRequest\",\n    types: {\n      SignerPermissionRequest\n    }\n  });\n  return {\n    req,\n    signature\n  };\n}\n/**\n * @internal\n */\nexport async function toContractPermissions(options) {\n  var _permissions$nativeTo;\n  const {\n    target,\n    permissions\n  } = options;\n  return {\n    approvedTargets: permissions.approvedTargets === \"*\" ? [ZERO_ADDRESS] : permissions.approvedTargets,\n    isAdmin: 0,\n    nativeTokenLimitPerTransaction: toWei(((_permissions$nativeTo = permissions.nativeTokenLimitPerTransaction) === null || _permissions$nativeTo === void 0 ? void 0 : _permissions$nativeTo.toString()) || \"0\"),\n    permissionEndTimestamp: dateToSeconds(permissions.permissionEndTimestamp || tenYearsFromNow()),\n    permissionStartTimestamp: dateToSeconds(permissions.permissionStartTimestamp || new Date(0)),\n    reqValidityEndTimestamp: dateToSeconds(tenYearsFromNow()),\n    reqValidityStartTimestamp: 0n,\n    signer: target,\n    // session key flag\n    uid: await randomBytesHex()\n  };\n}\n/**\n * @internal\n */\nexport async function defaultPermissionsForAdmin(options) {\n  const {\n    target,\n    action\n  } = options;\n  return {\n    approvedTargets: [],\n    isAdmin: action === \"add-admin\" ? 1 : action === \"remove-admin\" ? 2 : 0,\n    nativeTokenLimitPerTransaction: 0n,\n    permissionEndTimestamp: 0n,\n    permissionStartTimestamp: 0n,\n    reqValidityEndTimestamp: dateToSeconds(tenYearsFromNow()),\n    reqValidityStartTimestamp: 0n,\n    signer: target,\n    uid: await randomBytesHex()\n  };\n}","map":{"version":3,"names":["ZERO_ADDRESS","dateToSeconds","tenYearsFromNow","randomBytesHex","toWei","SignerPermissionRequest","signPermissionRequest","options","account","contract","req","signature","signTypedData","domain","chainId","chain","id","name","verifyingContract","address","version","message","primaryType","types","toContractPermissions","_permissions$nativeTo","target","permissions","approvedTargets","isAdmin","nativeTokenLimitPerTransaction","toString","permissionEndTimestamp","permissionStartTimestamp","Date","reqValidityEndTimestamp","reqValidityStartTimestamp","signer","uid","defaultPermissionsForAdmin","action"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/extensions/erc4337/account/common.ts"],"sourcesContent":["import { ZERO_ADDRESS } from \"../../../constants/addresses.js\";\nimport type { ThirdwebContract } from \"../../../contract/contract.js\";\nimport { dateToSeconds, tenYearsFromNow } from \"../../../utils/date.js\";\nimport { randomBytesHex } from \"../../../utils/random.js\";\nimport { toWei } from \"../../../utils/units.js\";\nimport type { Account } from \"../../../wallets/interfaces/wallet.js\";\nimport type { SetPermissionsForSignerParams } from \"../__generated__/IAccountPermissions/write/setPermissionsForSigner.js\";\nimport { type AccountPermissions, SignerPermissionRequest } from \"./types.js\";\n\n/**\n * @internal\n */\nexport async function signPermissionRequest(options: {\n  account: Account;\n  contract: ThirdwebContract;\n  req: SetPermissionsForSignerParams[\"req\"];\n}) {\n  const { account, contract, req } = options;\n  const signature = await account.signTypedData({\n    domain: {\n      chainId: contract.chain.id,\n      name: \"Account\",\n      verifyingContract: contract.address,\n      version: \"1\",\n    },\n    message: req,\n    primaryType: \"SignerPermissionRequest\",\n    types: { SignerPermissionRequest },\n  });\n  return { req, signature };\n}\n\n/**\n * @internal\n */\nexport async function toContractPermissions(options: {\n  target: string;\n  permissions: AccountPermissions;\n}): Promise<SetPermissionsForSignerParams[\"req\"]> {\n  const { target, permissions } = options;\n  return {\n    approvedTargets:\n      permissions.approvedTargets === \"*\"\n        ? [ZERO_ADDRESS]\n        : permissions.approvedTargets,\n    isAdmin: 0,\n    nativeTokenLimitPerTransaction: toWei(\n      permissions.nativeTokenLimitPerTransaction?.toString() || \"0\",\n    ),\n    permissionEndTimestamp: dateToSeconds(\n      permissions.permissionEndTimestamp || tenYearsFromNow(),\n    ),\n    permissionStartTimestamp: dateToSeconds(\n      permissions.permissionStartTimestamp || new Date(0),\n    ),\n    reqValidityEndTimestamp: dateToSeconds(tenYearsFromNow()),\n    reqValidityStartTimestamp: 0n,\n    signer: target, // session key flag\n    uid: await randomBytesHex(),\n  };\n}\n\n/**\n * @internal\n */\nexport async function defaultPermissionsForAdmin(options: {\n  target: string;\n  action: \"add-admin\" | \"remove-admin\";\n}): Promise<SetPermissionsForSignerParams[\"req\"]> {\n  const { target, action } = options;\n  return {\n    approvedTargets: [],\n    isAdmin: action === \"add-admin\" ? 1 : action === \"remove-admin\" ? 2 : 0,\n    nativeTokenLimitPerTransaction: 0n,\n    permissionEndTimestamp: 0n,\n    permissionStartTimestamp: 0n,\n    reqValidityEndTimestamp: dateToSeconds(tenYearsFromNow()),\n    reqValidityStartTimestamp: 0n,\n    signer: target,\n    uid: await randomBytesHex(),\n  };\n}\n"],"mappings":"AAAA,SAASA,YAAY,QAAQ,iCAAiC;AAE9D,SAASC,aAAa,EAAEC,eAAe,QAAQ,wBAAwB;AACvE,SAASC,cAAc,QAAQ,0BAA0B;AACzD,SAASC,KAAK,QAAQ,yBAAyB;AAG/C,SAAkCC,uBAAuB,QAAQ,YAAY;AAE7E;;;AAGA,OAAO,eAAeC,qBAAqBA,CAACC,OAI3C;EACC,MAAM;IAAEC,OAAO;IAAEC,QAAQ;IAAEC;EAAG,CAAE,GAAGH,OAAO;EAC1C,MAAMI,SAAS,GAAG,MAAMH,OAAO,CAACI,aAAa,CAAC;IAC5CC,MAAM,EAAE;MACNC,OAAO,EAAEL,QAAQ,CAACM,KAAK,CAACC,EAAE;MAC1BC,IAAI,EAAE,SAAS;MACfC,iBAAiB,EAAET,QAAQ,CAACU,OAAO;MACnCC,OAAO,EAAE;KACV;IACDC,OAAO,EAAEX,GAAG;IACZY,WAAW,EAAE,yBAAyB;IACtCC,KAAK,EAAE;MAAElB;IAAuB;GACjC,CAAC;EACF,OAAO;IAAEK,GAAG;IAAEC;EAAS,CAAE;AAC3B;AAEA;;;AAGA,OAAO,eAAea,qBAAqBA,CAACjB,OAG3C;EAAA,IAAAkB,qBAAA;EACC,MAAM;IAAEC,MAAM;IAAEC;EAAW,CAAE,GAAGpB,OAAO;EACvC,OAAO;IACLqB,eAAe,EACbD,WAAW,CAACC,eAAe,KAAK,GAAG,GAC/B,CAAC5B,YAAY,CAAC,GACd2B,WAAW,CAACC,eAAe;IACjCC,OAAO,EAAE,CAAC;IACVC,8BAA8B,EAAE1B,KAAK,CACnC,EAAAqB,qBAAA,GAAAE,WAAW,CAACG,8BAA8B,cAAAL,qBAAA,uBAA1CA,qBAAA,CAA4CM,QAAQ,EAAE,KAAI,GAAG,CAC9D;IACDC,sBAAsB,EAAE/B,aAAa,CACnC0B,WAAW,CAACK,sBAAsB,IAAI9B,eAAe,EAAE,CACxD;IACD+B,wBAAwB,EAAEhC,aAAa,CACrC0B,WAAW,CAACM,wBAAwB,IAAI,IAAIC,IAAI,CAAC,CAAC,CAAC,CACpD;IACDC,uBAAuB,EAAElC,aAAa,CAACC,eAAe,EAAE,CAAC;IACzDkC,yBAAyB,EAAE,EAAE;IAC7BC,MAAM,EAAEX,MAAM;IAAE;IAChBY,GAAG,EAAE,MAAMnC,cAAc;GAC1B;AACH;AAEA;;;AAGA,OAAO,eAAeoC,0BAA0BA,CAAChC,OAGhD;EACC,MAAM;IAAEmB,MAAM;IAAEc;EAAM,CAAE,GAAGjC,OAAO;EAClC,OAAO;IACLqB,eAAe,EAAE,EAAE;IACnBC,OAAO,EAAEW,MAAM,KAAK,WAAW,GAAG,CAAC,GAAGA,MAAM,KAAK,cAAc,GAAG,CAAC,GAAG,CAAC;IACvEV,8BAA8B,EAAE,EAAE;IAClCE,sBAAsB,EAAE,EAAE;IAC1BC,wBAAwB,EAAE,EAAE;IAC5BE,uBAAuB,EAAElC,aAAa,CAACC,eAAe,EAAE,CAAC;IACzDkC,yBAAyB,EAAE,EAAE;IAC7BC,MAAM,EAAEX,MAAM;IACdY,GAAG,EAAE,MAAMnC,cAAc;GAC1B;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}