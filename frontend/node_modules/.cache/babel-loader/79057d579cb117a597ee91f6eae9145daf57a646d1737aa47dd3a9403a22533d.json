{"ast":null,"code":"import { status as onrampStatus } from \"../../bridge/OnrampStatus.js\";\n/**\n * Once you get a `quote` from [`getBuyWithFiatQuote`](https://portal.thirdweb.com/references/typescript/v5/getBuyWithFiatQuote)\n * and open the `quote.onRampLink` in a new tab, you can start polling for the transaction status using `getBuyWithFiatStatus`\n *\n * You should keep calling this function at regular intervals while the status is in one of the pending states such as - \"PENDING_PAYMENT\", \"PENDING_ON_RAMP_TRANSFER\", \"ON_RAMP_TRANSFER_IN_PROGRESS\", \"CRYPTO_SWAP_IN_PROGRESS\" etc..\n *\n * If `quote.onRampToken` is same as `quote.toToken` (same chain + same token address) - This means that the token can be directly bought from the on-ramp provider.\n * But if they are different - On-ramp provider will send the `quote.onRampToken` to the user's wallet address and a swap is required to convert it to the desired token.\n * You can use the [`isSwapRequiredPostOnramp`](https://portal.thirdweb.com/references/typescript/v5/isSwapRequiredPostOnramp) utility function to check if a swap is required after the on-ramp is done.\n *\n * #### When no swap is required\n * If there is no swap required - the status will become `\"ON_RAMP_TRANSFER_COMPLETED\"` once the on-ramp provider has sent the tokens to the user's wallet address.\n * Once you receive this status, the process is complete.\n *\n * ### When a swap is required\n * If a swap is required - the status will become `\"CRYPTO_SWAP_REQUIRED\"` once the on-ramp provider has sent the tokens to the user's wallet address.\n * Once you receive this status, you need to start the swap process.\n *\n * On receiving the `\"CRYPTO_SWAP_REQUIRED\"` status, you can use the [`getPostOnRampQuote`](https://portal.thirdweb.com/references/typescript/v5/getPostOnRampQuote) function to get the quote for the swap of type [`BuyWithCryptoQuote`](https://portal.thirdweb.com/references/typescript/v5/BuyWithCryptoQuote).\n *\n * Once you have this quote - You can follow the same steps as mentioned in the [`getBuyWithCryptoQuote`](https://portal.thirdweb.com/references/typescript/v5/getBuyWithCryptoQuote) documentation to perform the swap.\n *\n * @param params - Object of type [`GetBuyWithFiatStatusParams`](https://portal.thirdweb.com/references/typescript/v5/GetBuyWithFiatStatusParams)\n * @example\n * ```ts\n * // step 1 - get a quote\n * const fiatQuote = await getBuyWithFiatQuote(fiatQuoteParams)\n *\n * // step 2 - open the on-ramp provider UI\n * window.open(quote.onRampLink, \"_blank\");\n *\n * // step 3 - keep calling getBuyWithFiatStatus while the status is in one of the pending states\n * const fiatStatus = await getBuyWithFiatStatus({\n *    client,\n *    intentId: fiatQuote.intentId,\n * })\n *\n * // when the fiatStatus.status is \"ON_RAMP_TRANSFER_COMPLETED\" - the process is complete\n * ```\n * @deprecated\n * @buyCrypto\n */\nexport async function getBuyWithFiatStatus(params) {\n  const result = await onrampStatus({\n    client: params.client,\n    id: params.intentId\n  });\n  return toBuyWithFiatStatus({\n    intentId: params.intentId,\n    result\n  });\n}\n////////////////////////////////////////////////////////////////////////////////\n// Helpers\n////////////////////////////////////////////////////////////////////////////////\nfunction toBuyWithFiatStatus(args) {\n  const {\n    intentId,\n    result\n  } = args;\n  // Map status constants from the Bridge.Onramp.status response to BuyWithFiatStatus equivalents.\n  const STATUS_MAP = {\n    COMPLETED: \"ON_RAMP_TRANSFER_COMPLETED\",\n    CREATED: \"PENDING_PAYMENT\",\n    FAILED: \"PAYMENT_FAILED\",\n    PENDING: \"PENDING_PAYMENT\"\n  };\n  const mappedStatus = STATUS_MAP[result.status];\n  return buildPlaceholderStatus({\n    intentId,\n    purchaseData: result.purchaseData,\n    status: mappedStatus\n  });\n}\nfunction buildPlaceholderStatus(args) {\n  const {\n    intentId,\n    status,\n    purchaseData\n  } = args;\n  // Build a minimal—but type-complete—object that satisfies BuyWithFiatStatus.\n  const emptyToken = {\n    chainId: 0,\n    decimals: 18,\n    name: \"\",\n    priceUSDCents: 0,\n    symbol: \"\",\n    tokenAddress: \"\"\n  };\n  const quote = {\n    createdAt: new Date().toISOString(),\n    estimatedDurationSeconds: 0,\n    estimatedOnRampAmount: \"0\",\n    estimatedOnRampAmountWei: \"0\",\n    estimatedToTokenAmount: \"0\",\n    estimatedToTokenAmountWei: \"0\",\n    fromCurrency: {\n      amount: \"0\",\n      amountUnits: \"USD\",\n      currencySymbol: \"USD\",\n      decimals: 2\n    },\n    fromCurrencyWithFees: {\n      amount: \"0\",\n      amountUnits: \"USD\",\n      currencySymbol: \"USD\",\n      decimals: 2\n    },\n    onRampToken: emptyToken,\n    toToken: emptyToken\n  };\n  // The source/destination fields can only be filled accurately when extra context is returned\n  // by the API. Since Bridge.Onramp.status doesn't yet provide these details, we omit them for\n  // now (they are optional).\n  const base = {\n    fromAddress: \"\",\n    intentId,\n    purchaseData,\n    quote,\n    status,\n    toAddress: \"\"\n  };\n  return base;\n}","map":{"version":3,"names":["status","onrampStatus","getBuyWithFiatStatus","params","result","client","id","intentId","toBuyWithFiatStatus","args","STATUS_MAP","COMPLETED","CREATED","FAILED","PENDING","mappedStatus","buildPlaceholderStatus","purchaseData","emptyToken","chainId","decimals","name","priceUSDCents","symbol","tokenAddress","quote","createdAt","Date","toISOString","estimatedDurationSeconds","estimatedOnRampAmount","estimatedOnRampAmountWei","estimatedToTokenAmount","estimatedToTokenAmountWei","fromCurrency","amount","amountUnits","currencySymbol","fromCurrencyWithFees","onRampToken","toToken","base","fromAddress","toAddress"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/pay/buyWithFiat/getStatus.ts"],"sourcesContent":["import { status as onrampStatus } from \"../../bridge/OnrampStatus.js\";\nimport type { ThirdwebClient } from \"../../client/client.js\";\nimport type { PurchaseData } from \"../types.js\";\nimport type {\n  PayOnChainTransactionDetails,\n  PayTokenInfo,\n} from \"../utils/commonTypes.js\";\n\n/**\n * Parameters for the [`getBuyWithFiatStatus`](https://portal.thirdweb.com/references/typescript/v5/getBuyWithFiatStatus) function\n * @deprecated\n * @buyCrypto\n */\nexport type GetBuyWithFiatStatusParams = {\n  /**\n   * A client is the entry point to the thirdweb SDK. It is required for all other actions.\n   *\n   * You can create a client using the `createThirdwebClient` function.\n   * Refer to the [Creating a Client](https://portal.thirdweb.com/typescript/v5/client) documentation for more information.\n   */\n  client: ThirdwebClient;\n  /**\n   * Intent ID of the \"Buy with fiat\" transaction. You can get the intent ID from the quote object returned by the [`getBuyWithFiatQuote`](https://portal.thirdweb.com/references/typescript/v5/getBuyWithFiatQuote) function\n   */\n  intentId: string;\n};\n\n/**\n * The returned object from [`getBuyWithFiatStatus`](https://portal.thirdweb.com/references/typescript/v5/getBuyWithFiatStatus) function\n *\n * If the in invalid intentId is provided, the object will have a status of \"NOT_FOUND\" and no other fields.\n * @buyCrypto\n */\nexport type BuyWithFiatStatus =\n  | {\n      status: \"NOT_FOUND\";\n    }\n  | {\n      /**\n       * Intent ID of the \"Buy with fiat\" transaction. You can get the intent ID from the quote object returned by the [`getBuyWithFiatQuote`](https://portal.thirdweb.com/references/typescript/v5/getBuyWithFiatQuote) function\n       */\n      intentId: string;\n      /**\n       * The status of the transaction\n       * - `NONE` - No status\n       * - `PENDING_PAYMENT` - Payment is not done yet in the on-ramp provider\n       * - `PAYMENT_FAILED` - Payment failed in the on-ramp provider\n       * - `ON_RAMP_TRANSFER_COMPLETED` - On-ramp provider has transferred the tokens to the user's wallet\n       */\n      status:\n        | \"NONE\"\n        | \"PENDING_PAYMENT\"\n        | \"PAYMENT_FAILED\"\n        | \"ON_RAMP_TRANSFER_COMPLETED\";\n      /**\n       * The wallet address to which the desired tokens are sent to\n       */\n      toAddress: string;\n      /**\n       * The wallet address that started the transaction.\n       *\n       * If onramp provider supports buying the destination token directly, the tokens are sent to \"toAddress\" directly.\n       * Otherwise, the tokens are sent to \"fromAddress\" and a swap is performed by the payer wallet and the tokens are converted to the desired token and sent to \"toAddress\".\n       */\n      fromAddress: string;\n      /**\n       * The quote object for the transaction\n       */\n      quote: {\n        estimatedOnRampAmount: string;\n        estimatedOnRampAmountWei: string;\n\n        estimatedToTokenAmount: string;\n        estimatedToTokenAmountWei: string;\n\n        fromCurrency: {\n          amount: string;\n          amountUnits: string;\n          decimals: number;\n          currencySymbol: string;\n        };\n        fromCurrencyWithFees: {\n          amount: string;\n          amountUnits: string;\n          decimals: number;\n          currencySymbol: string;\n        };\n        onRampToken: PayTokenInfo;\n        toToken: PayTokenInfo;\n        estimatedDurationSeconds?: number;\n        createdAt: string;\n      };\n      /**\n       * The on-ramp transaction details\n       *\n       * This field is only present when on-ramp transaction is completed or failed\n       */\n      source?: PayOnChainTransactionDetails;\n      /**\n       * The destination transaction details\n       *\n       * This field is only present when swap transaction is completed or failed\n       */\n      destination?: PayOnChainTransactionDetails;\n      /**\n       * Message indicating the reason for failure\n       */\n      failureMessage?: string;\n\n      /**\n       * Arbitrary data sent at the time of fetching the quote\n       */\n      purchaseData?: PurchaseData;\n    };\n\n/**\n * Once you get a `quote` from [`getBuyWithFiatQuote`](https://portal.thirdweb.com/references/typescript/v5/getBuyWithFiatQuote)\n * and open the `quote.onRampLink` in a new tab, you can start polling for the transaction status using `getBuyWithFiatStatus`\n *\n * You should keep calling this function at regular intervals while the status is in one of the pending states such as - \"PENDING_PAYMENT\", \"PENDING_ON_RAMP_TRANSFER\", \"ON_RAMP_TRANSFER_IN_PROGRESS\", \"CRYPTO_SWAP_IN_PROGRESS\" etc..\n *\n * If `quote.onRampToken` is same as `quote.toToken` (same chain + same token address) - This means that the token can be directly bought from the on-ramp provider.\n * But if they are different - On-ramp provider will send the `quote.onRampToken` to the user's wallet address and a swap is required to convert it to the desired token.\n * You can use the [`isSwapRequiredPostOnramp`](https://portal.thirdweb.com/references/typescript/v5/isSwapRequiredPostOnramp) utility function to check if a swap is required after the on-ramp is done.\n *\n * #### When no swap is required\n * If there is no swap required - the status will become `\"ON_RAMP_TRANSFER_COMPLETED\"` once the on-ramp provider has sent the tokens to the user's wallet address.\n * Once you receive this status, the process is complete.\n *\n * ### When a swap is required\n * If a swap is required - the status will become `\"CRYPTO_SWAP_REQUIRED\"` once the on-ramp provider has sent the tokens to the user's wallet address.\n * Once you receive this status, you need to start the swap process.\n *\n * On receiving the `\"CRYPTO_SWAP_REQUIRED\"` status, you can use the [`getPostOnRampQuote`](https://portal.thirdweb.com/references/typescript/v5/getPostOnRampQuote) function to get the quote for the swap of type [`BuyWithCryptoQuote`](https://portal.thirdweb.com/references/typescript/v5/BuyWithCryptoQuote).\n *\n * Once you have this quote - You can follow the same steps as mentioned in the [`getBuyWithCryptoQuote`](https://portal.thirdweb.com/references/typescript/v5/getBuyWithCryptoQuote) documentation to perform the swap.\n *\n * @param params - Object of type [`GetBuyWithFiatStatusParams`](https://portal.thirdweb.com/references/typescript/v5/GetBuyWithFiatStatusParams)\n * @example\n * ```ts\n * // step 1 - get a quote\n * const fiatQuote = await getBuyWithFiatQuote(fiatQuoteParams)\n *\n * // step 2 - open the on-ramp provider UI\n * window.open(quote.onRampLink, \"_blank\");\n *\n * // step 3 - keep calling getBuyWithFiatStatus while the status is in one of the pending states\n * const fiatStatus = await getBuyWithFiatStatus({\n *    client,\n *    intentId: fiatQuote.intentId,\n * })\n *\n * // when the fiatStatus.status is \"ON_RAMP_TRANSFER_COMPLETED\" - the process is complete\n * ```\n * @deprecated\n * @buyCrypto\n */\nexport async function getBuyWithFiatStatus(\n  params: GetBuyWithFiatStatusParams,\n): Promise<BuyWithFiatStatus> {\n  const result = await onrampStatus({\n    client: params.client,\n    id: params.intentId,\n  });\n\n  return toBuyWithFiatStatus({ intentId: params.intentId, result });\n}\n\n////////////////////////////////////////////////////////////////////////////////\n// Helpers\n////////////////////////////////////////////////////////////////////////////////\n\nfunction toBuyWithFiatStatus(args: {\n  intentId: string;\n  result: Awaited<ReturnType<typeof onrampStatus>>;\n}): BuyWithFiatStatus {\n  const { intentId, result } = args;\n\n  // Map status constants from the Bridge.Onramp.status response to BuyWithFiatStatus equivalents.\n  const STATUS_MAP: Record<\n    typeof result.status,\n    \"NONE\" | \"PENDING_PAYMENT\" | \"PAYMENT_FAILED\" | \"ON_RAMP_TRANSFER_COMPLETED\"\n  > = {\n    COMPLETED: \"ON_RAMP_TRANSFER_COMPLETED\",\n    CREATED: \"PENDING_PAYMENT\",\n    FAILED: \"PAYMENT_FAILED\",\n    PENDING: \"PENDING_PAYMENT\",\n  } as const;\n\n  const mappedStatus = STATUS_MAP[result.status];\n\n  return buildPlaceholderStatus({\n    intentId,\n    purchaseData: result.purchaseData,\n    status: mappedStatus,\n  });\n}\n\nfunction buildPlaceholderStatus(args: {\n  intentId: string;\n  status:\n    | \"NONE\"\n    | \"PENDING_PAYMENT\"\n    | \"PAYMENT_FAILED\"\n    | \"ON_RAMP_TRANSFER_COMPLETED\";\n  purchaseData?: PurchaseData;\n}): BuyWithFiatStatus {\n  const { intentId, status, purchaseData } = args;\n\n  // Build a minimal—but type-complete—object that satisfies BuyWithFiatStatus.\n  const emptyToken: PayTokenInfo = {\n    chainId: 0,\n    decimals: 18,\n    name: \"\",\n    priceUSDCents: 0,\n    symbol: \"\",\n    tokenAddress: \"\",\n  };\n\n  type BuyWithFiatStatusWithData = Exclude<\n    BuyWithFiatStatus,\n    { status: \"NOT_FOUND\" }\n  >;\n\n  const quote: BuyWithFiatStatusWithData[\"quote\"] = {\n    createdAt: new Date().toISOString(),\n    estimatedDurationSeconds: 0,\n    estimatedOnRampAmount: \"0\",\n    estimatedOnRampAmountWei: \"0\",\n\n    estimatedToTokenAmount: \"0\",\n    estimatedToTokenAmountWei: \"0\",\n\n    fromCurrency: {\n      amount: \"0\",\n      amountUnits: \"USD\",\n      currencySymbol: \"USD\",\n      decimals: 2,\n    },\n    fromCurrencyWithFees: {\n      amount: \"0\",\n      amountUnits: \"USD\",\n      currencySymbol: \"USD\",\n      decimals: 2,\n    },\n    onRampToken: emptyToken,\n    toToken: emptyToken,\n  } as BuyWithFiatStatusWithData[\"quote\"];\n\n  // The source/destination fields can only be filled accurately when extra context is returned\n  // by the API. Since Bridge.Onramp.status doesn't yet provide these details, we omit them for\n  // now (they are optional).\n\n  const base: Exclude<BuyWithFiatStatus, { status: \"NOT_FOUND\" }> = {\n    fromAddress: \"\",\n    intentId,\n    purchaseData,\n    quote,\n    status,\n    toAddress: \"\",\n  };\n\n  return base;\n}\n"],"mappings":"AAAA,SAASA,MAAM,IAAIC,YAAY,QAAQ,8BAA8B;AAmHrE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0CA,OAAO,eAAeC,oBAAoBA,CACxCC,MAAkC;EAElC,MAAMC,MAAM,GAAG,MAAMH,YAAY,CAAC;IAChCI,MAAM,EAAEF,MAAM,CAACE,MAAM;IACrBC,EAAE,EAAEH,MAAM,CAACI;GACZ,CAAC;EAEF,OAAOC,mBAAmB,CAAC;IAAED,QAAQ,EAAEJ,MAAM,CAACI,QAAQ;IAAEH;EAAM,CAAE,CAAC;AACnE;AAEA;AACA;AACA;AAEA,SAASI,mBAAmBA,CAACC,IAG5B;EACC,MAAM;IAAEF,QAAQ;IAAEH;EAAM,CAAE,GAAGK,IAAI;EAEjC;EACA,MAAMC,UAAU,GAGZ;IACFC,SAAS,EAAE,4BAA4B;IACvCC,OAAO,EAAE,iBAAiB;IAC1BC,MAAM,EAAE,gBAAgB;IACxBC,OAAO,EAAE;GACD;EAEV,MAAMC,YAAY,GAAGL,UAAU,CAACN,MAAM,CAACJ,MAAM,CAAC;EAE9C,OAAOgB,sBAAsB,CAAC;IAC5BT,QAAQ;IACRU,YAAY,EAAEb,MAAM,CAACa,YAAY;IACjCjB,MAAM,EAAEe;GACT,CAAC;AACJ;AAEA,SAASC,sBAAsBA,CAACP,IAQ/B;EACC,MAAM;IAAEF,QAAQ;IAAEP,MAAM;IAAEiB;EAAY,CAAE,GAAGR,IAAI;EAE/C;EACA,MAAMS,UAAU,GAAiB;IAC/BC,OAAO,EAAE,CAAC;IACVC,QAAQ,EAAE,EAAE;IACZC,IAAI,EAAE,EAAE;IACRC,aAAa,EAAE,CAAC;IAChBC,MAAM,EAAE,EAAE;IACVC,YAAY,EAAE;GACf;EAOD,MAAMC,KAAK,GAAuC;IAChDC,SAAS,EAAE,IAAIC,IAAI,EAAE,CAACC,WAAW,EAAE;IACnCC,wBAAwB,EAAE,CAAC;IAC3BC,qBAAqB,EAAE,GAAG;IAC1BC,wBAAwB,EAAE,GAAG;IAE7BC,sBAAsB,EAAE,GAAG;IAC3BC,yBAAyB,EAAE,GAAG;IAE9BC,YAAY,EAAE;MACZC,MAAM,EAAE,GAAG;MACXC,WAAW,EAAE,KAAK;MAClBC,cAAc,EAAE,KAAK;MACrBjB,QAAQ,EAAE;KACX;IACDkB,oBAAoB,EAAE;MACpBH,MAAM,EAAE,GAAG;MACXC,WAAW,EAAE,KAAK;MAClBC,cAAc,EAAE,KAAK;MACrBjB,QAAQ,EAAE;KACX;IACDmB,WAAW,EAAErB,UAAU;IACvBsB,OAAO,EAAEtB;GAC4B;EAEvC;EACA;EACA;EAEA,MAAMuB,IAAI,GAAwD;IAChEC,WAAW,EAAE,EAAE;IACfnC,QAAQ;IACRU,YAAY;IACZQ,KAAK;IACLzB,MAAM;IACN2C,SAAS,EAAE;GACZ;EAED,OAAOF,IAAI;AACb","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}