{"ast":null,"code":"import { stringify } from \"../../../utils/json.js\";\nimport { ClientScopedStorage } from \"../../in-app/core/authentication/client-scoped-storage.js\";\n/**\n * @internal\n */\nexport let walletConnectSessions;\n/**\n * @internal\n */\nexport async function getSessions() {\n  if (!walletConnectSessions) {\n    return [];\n  }\n  const stringifiedSessions = await walletConnectSessions.getWalletConnectSessions();\n  return JSON.parse(stringifiedSessions !== null && stringifiedSessions !== void 0 ? stringifiedSessions : \"[]\");\n}\n/**\n * @internal\n */\nexport function initializeSessionStore(options) {\n  if (!walletConnectSessions) {\n    walletConnectSessions = new ClientScopedStorage({\n      clientId: options.clientId,\n      // TODO: inject storage\n      storage: null\n    });\n  }\n}\n/**\n * @internal\n */\nexport async function saveSession(session) {\n  if (!walletConnectSessions) {\n    return;\n  }\n  const stringifiedSessions = await walletConnectSessions.getWalletConnectSessions();\n  const sessions = JSON.parse(stringifiedSessions !== null && stringifiedSessions !== void 0 ? stringifiedSessions : \"[]\");\n  sessions.push(session);\n  await walletConnectSessions.saveWalletConnectSessions(stringify(sessions));\n}\n/**\n * @internal\n */\nexport async function removeSession(session) {\n  if (!walletConnectSessions) {\n    return;\n  }\n  const stringifiedSessions = await walletConnectSessions.getWalletConnectSessions();\n  const sessions = JSON.parse(stringifiedSessions !== null && stringifiedSessions !== void 0 ? stringifiedSessions : \"[]\");\n  const newSessions = sessions.filter(s => s.topic !== session.topic);\n  await walletConnectSessions.saveWalletConnectSessions(stringify(newSessions));\n}\n/**\n * @internal FOR TESTING ONLY\n */\nexport function setWalletConnectSessions(storage) {\n  walletConnectSessions = storage;\n}","map":{"version":3,"names":["stringify","ClientScopedStorage","walletConnectSessions","getSessions","stringifiedSessions","getWalletConnectSessions","JSON","parse","initializeSessionStore","options","clientId","storage","saveSession","session","sessions","push","saveWalletConnectSessions","removeSession","newSessions","filter","s","topic","setWalletConnectSessions"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/wallets/wallet-connect/receiver/session-store.ts"],"sourcesContent":["import { stringify } from \"../../../utils/json.js\";\nimport { ClientScopedStorage } from \"../../in-app/core/authentication/client-scoped-storage.js\";\nimport type { WalletConnectSession } from \"./types.js\";\n\n/**\n * @internal\n */\nexport let walletConnectSessions: ClientScopedStorage | undefined;\n\n/**\n * @internal\n */\nexport async function getSessions(): Promise<WalletConnectSession[]> {\n  if (!walletConnectSessions) {\n    return [];\n  }\n  const stringifiedSessions =\n    await walletConnectSessions.getWalletConnectSessions();\n  return JSON.parse(stringifiedSessions ?? \"[]\");\n}\n\n/**\n * @internal\n */\nexport function initializeSessionStore(options: { clientId: string }) {\n  if (!walletConnectSessions) {\n    walletConnectSessions = new ClientScopedStorage({\n      clientId: options.clientId, // TODO: inject storage\n      storage: null,\n    });\n  }\n}\n\n/**\n * @internal\n */\nexport async function saveSession(\n  session: WalletConnectSession,\n): Promise<void> {\n  if (!walletConnectSessions) {\n    return;\n  }\n  const stringifiedSessions =\n    await walletConnectSessions.getWalletConnectSessions();\n  const sessions = JSON.parse(stringifiedSessions ?? \"[]\");\n  sessions.push(session);\n  await walletConnectSessions.saveWalletConnectSessions(stringify(sessions));\n}\n\n/**\n * @internal\n */\nexport async function removeSession(\n  session: WalletConnectSession,\n): Promise<void> {\n  if (!walletConnectSessions) {\n    return;\n  }\n  const stringifiedSessions =\n    await walletConnectSessions.getWalletConnectSessions();\n  const sessions = JSON.parse(stringifiedSessions ?? \"[]\");\n  const newSessions = sessions.filter(\n    (s: WalletConnectSession) => s.topic !== session.topic,\n  );\n  await walletConnectSessions.saveWalletConnectSessions(stringify(newSessions));\n}\n\n/**\n * @internal FOR TESTING ONLY\n */\nexport function setWalletConnectSessions(\n  storage: ClientScopedStorage | undefined,\n): void {\n  walletConnectSessions = storage;\n}\n"],"mappings":"AAAA,SAASA,SAAS,QAAQ,wBAAwB;AAClD,SAASC,mBAAmB,QAAQ,2DAA2D;AAG/F;;;AAGA,OAAO,IAAIC,qBAAsD;AAEjE;;;AAGA,OAAO,eAAeC,WAAWA,CAAA;EAC/B,IAAI,CAACD,qBAAqB,EAAE;IAC1B,OAAO,EAAE;EACX;EACA,MAAME,mBAAmB,GACvB,MAAMF,qBAAqB,CAACG,wBAAwB,EAAE;EACxD,OAAOC,IAAI,CAACC,KAAK,CAACH,mBAAmB,aAAnBA,mBAAmB,cAAnBA,mBAAmB,GAAI,IAAI,CAAC;AAChD;AAEA;;;AAGA,OAAM,SAAUI,sBAAsBA,CAACC,OAA6B;EAClE,IAAI,CAACP,qBAAqB,EAAE;IAC1BA,qBAAqB,GAAG,IAAID,mBAAmB,CAAC;MAC9CS,QAAQ,EAAED,OAAO,CAACC,QAAQ;MAAE;MAC5BC,OAAO,EAAE;KACV,CAAC;EACJ;AACF;AAEA;;;AAGA,OAAO,eAAeC,WAAWA,CAC/BC,OAA6B;EAE7B,IAAI,CAACX,qBAAqB,EAAE;IAC1B;EACF;EACA,MAAME,mBAAmB,GACvB,MAAMF,qBAAqB,CAACG,wBAAwB,EAAE;EACxD,MAAMS,QAAQ,GAAGR,IAAI,CAACC,KAAK,CAACH,mBAAmB,aAAnBA,mBAAmB,cAAnBA,mBAAmB,GAAI,IAAI,CAAC;EACxDU,QAAQ,CAACC,IAAI,CAACF,OAAO,CAAC;EACtB,MAAMX,qBAAqB,CAACc,yBAAyB,CAAChB,SAAS,CAACc,QAAQ,CAAC,CAAC;AAC5E;AAEA;;;AAGA,OAAO,eAAeG,aAAaA,CACjCJ,OAA6B;EAE7B,IAAI,CAACX,qBAAqB,EAAE;IAC1B;EACF;EACA,MAAME,mBAAmB,GACvB,MAAMF,qBAAqB,CAACG,wBAAwB,EAAE;EACxD,MAAMS,QAAQ,GAAGR,IAAI,CAACC,KAAK,CAACH,mBAAmB,aAAnBA,mBAAmB,cAAnBA,mBAAmB,GAAI,IAAI,CAAC;EACxD,MAAMc,WAAW,GAAGJ,QAAQ,CAACK,MAAM,CAChCC,CAAuB,IAAKA,CAAC,CAACC,KAAK,KAAKR,OAAO,CAACQ,KAAK,CACvD;EACD,MAAMnB,qBAAqB,CAACc,yBAAyB,CAAChB,SAAS,CAACkB,WAAW,CAAC,CAAC;AAC/E;AAEA;;;AAGA,OAAM,SAAUI,wBAAwBA,CACtCX,OAAwC;EAExCT,qBAAqB,GAAGS,OAAO;AACjC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}