{"ast":null,"code":"import { getThirdwebBaseUrl } from \"../../../../utils/domains.js\";\nimport { getClientFetch } from \"../../../../utils/fetch.js\";\nimport { stringify } from \"../../../../utils/json.js\";\n/**\n * Links a new account to the current one using an auth token.\n * For the public-facing API, use `wallet.linkProfile` instead.\n *\n * @internal\n */\nexport async function linkAccount(_ref) {\n  let {\n    client,\n    ecosystem,\n    tokenToLink,\n    storage\n  } = _ref;\n  const clientFetch = getClientFetch(client, ecosystem);\n  const IN_APP_URL = getThirdwebBaseUrl(\"inAppWallet\");\n  const currentAccountToken = await storage.getAuthCookie();\n  if (!currentAccountToken) {\n    throw new Error(\"Failed to link account, no user logged in\");\n  }\n  const headers = {\n    Authorization: \"Bearer iaw-auth-token:\".concat(currentAccountToken),\n    \"Content-Type\": \"application/json\"\n  };\n  const linkedDetailsResp = await clientFetch(\"\".concat(IN_APP_URL, \"/api/2024-05-05/account/connect\"), {\n    body: stringify({\n      accountAuthTokenToConnect: tokenToLink\n    }),\n    headers,\n    method: \"POST\"\n  });\n  if (!linkedDetailsResp.ok) {\n    const body = await linkedDetailsResp.json();\n    throw new Error(body.message || \"Failed to link account.\");\n  }\n  const {\n    linkedAccounts\n  } = await linkedDetailsResp.json();\n  return linkedAccounts !== null && linkedAccounts !== void 0 ? linkedAccounts : [];\n}\n/**\n * Links a new account to the current one using an auth token.\n * For the public-facing API, use `wallet.linkProfile` instead.\n *\n * @internal\n */\nexport async function unlinkAccount(_ref2) {\n  let {\n    client,\n    ecosystem,\n    profileToUnlink,\n    allowAccountDeletion = false,\n    storage\n  } = _ref2;\n  const clientFetch = getClientFetch(client, ecosystem);\n  const IN_APP_URL = getThirdwebBaseUrl(\"inAppWallet\");\n  const currentAccountToken = await storage.getAuthCookie();\n  if (!currentAccountToken) {\n    throw new Error(\"Failed to unlink account, no user logged in\");\n  }\n  const headers = {\n    Authorization: \"Bearer iaw-auth-token:\".concat(currentAccountToken),\n    \"Content-Type\": \"application/json\"\n  };\n  const linkedDetailsResp = await clientFetch(\"\".concat(IN_APP_URL, \"/api/2024-05-05/account/disconnect\"), {\n    body: stringify({\n      allowAccountDeletion,\n      details: profileToUnlink.details,\n      type: profileToUnlink.type\n    }),\n    headers,\n    method: \"POST\"\n  });\n  if (!linkedDetailsResp.ok) {\n    const body = await linkedDetailsResp.json();\n    throw new Error(body.message || \"Failed to unlink account.\");\n  }\n  const {\n    linkedAccounts\n  } = await linkedDetailsResp.json();\n  return linkedAccounts !== null && linkedAccounts !== void 0 ? linkedAccounts : [];\n}\n/**\n * Gets the linked accounts for the current user.\n * For the public-facing API, use `wallet.getProfiles` instead.\n *\n * @internal\n */\nexport async function getLinkedProfilesInternal(_ref3) {\n  let {\n    client,\n    ecosystem,\n    storage\n  } = _ref3;\n  const clientFetch = getClientFetch(client, ecosystem);\n  const IN_APP_URL = getThirdwebBaseUrl(\"inAppWallet\");\n  const currentAccountToken = await storage.getAuthCookie();\n  if (!currentAccountToken) {\n    throw new Error(\"Failed to get linked accounts, no user logged in\");\n  }\n  const headers = {\n    Authorization: \"Bearer iaw-auth-token:\".concat(currentAccountToken),\n    \"Content-Type\": \"application/json\"\n  };\n  const linkedAccountsResp = await clientFetch(\"\".concat(IN_APP_URL, \"/api/2024-05-05/accounts\"), {\n    headers,\n    method: \"GET\"\n  });\n  if (!linkedAccountsResp.ok) {\n    const body = await linkedAccountsResp.json();\n    throw new Error(body.message || \"Failed to get linked accounts.\");\n  }\n  const {\n    linkedAccounts\n  } = await linkedAccountsResp.json();\n  return linkedAccounts !== null && linkedAccounts !== void 0 ? linkedAccounts : [];\n}","map":{"version":3,"names":["getThirdwebBaseUrl","getClientFetch","stringify","linkAccount","_ref","client","ecosystem","tokenToLink","storage","clientFetch","IN_APP_URL","currentAccountToken","getAuthCookie","Error","headers","Authorization","concat","linkedDetailsResp","body","accountAuthTokenToConnect","method","ok","json","message","linkedAccounts","unlinkAccount","_ref2","profileToUnlink","allowAccountDeletion","details","type","getLinkedProfilesInternal","_ref3","linkedAccountsResp"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/wallets/in-app/core/authentication/linkAccount.ts"],"sourcesContent":["import type { ThirdwebClient } from \"../../../../client/client.js\";\nimport { getThirdwebBaseUrl } from \"../../../../utils/domains.js\";\nimport { getClientFetch } from \"../../../../utils/fetch.js\";\nimport { stringify } from \"../../../../utils/json.js\";\nimport type { Ecosystem } from \"../wallet/types.js\";\nimport type { ClientScopedStorage } from \"./client-scoped-storage.js\";\nimport type { Profile } from \"./types.js\";\n\n/**\n * Links a new account to the current one using an auth token.\n * For the public-facing API, use `wallet.linkProfile` instead.\n *\n * @internal\n */\nexport async function linkAccount({\n  client,\n  ecosystem,\n  tokenToLink,\n  storage,\n}: {\n  client: ThirdwebClient;\n  ecosystem?: Ecosystem;\n  tokenToLink: string;\n  storage: ClientScopedStorage;\n}): Promise<Profile[]> {\n  const clientFetch = getClientFetch(client, ecosystem);\n  const IN_APP_URL = getThirdwebBaseUrl(\"inAppWallet\");\n  const currentAccountToken = await storage.getAuthCookie();\n\n  if (!currentAccountToken) {\n    throw new Error(\"Failed to link account, no user logged in\");\n  }\n\n  const headers: Record<string, string> = {\n    Authorization: `Bearer iaw-auth-token:${currentAccountToken}`,\n    \"Content-Type\": \"application/json\",\n  };\n  const linkedDetailsResp = await clientFetch(\n    `${IN_APP_URL}/api/2024-05-05/account/connect`,\n    {\n      body: stringify({\n        accountAuthTokenToConnect: tokenToLink,\n      }),\n      headers,\n      method: \"POST\",\n    },\n  );\n\n  if (!linkedDetailsResp.ok) {\n    const body = await linkedDetailsResp.json();\n    throw new Error(body.message || \"Failed to link account.\");\n  }\n\n  const { linkedAccounts } = await linkedDetailsResp.json();\n\n  return (linkedAccounts ?? []) satisfies Profile[];\n}\n\n/**\n * Links a new account to the current one using an auth token.\n * For the public-facing API, use `wallet.linkProfile` instead.\n *\n * @internal\n */\nexport async function unlinkAccount({\n  client,\n  ecosystem,\n  profileToUnlink,\n  allowAccountDeletion = false,\n  storage,\n}: {\n  client: ThirdwebClient;\n  ecosystem?: Ecosystem;\n  profileToUnlink: Profile;\n  allowAccountDeletion?: boolean;\n  storage: ClientScopedStorage;\n}): Promise<Profile[]> {\n  const clientFetch = getClientFetch(client, ecosystem);\n  const IN_APP_URL = getThirdwebBaseUrl(\"inAppWallet\");\n  const currentAccountToken = await storage.getAuthCookie();\n\n  if (!currentAccountToken) {\n    throw new Error(\"Failed to unlink account, no user logged in\");\n  }\n\n  const headers: Record<string, string> = {\n    Authorization: `Bearer iaw-auth-token:${currentAccountToken}`,\n    \"Content-Type\": \"application/json\",\n  };\n  const linkedDetailsResp = await clientFetch(\n    `${IN_APP_URL}/api/2024-05-05/account/disconnect`,\n    {\n      body: stringify({\n        allowAccountDeletion,\n        details: profileToUnlink.details,\n        type: profileToUnlink.type,\n      }),\n      headers,\n      method: \"POST\",\n    },\n  );\n\n  if (!linkedDetailsResp.ok) {\n    const body = await linkedDetailsResp.json();\n    throw new Error(body.message || \"Failed to unlink account.\");\n  }\n\n  const { linkedAccounts } = await linkedDetailsResp.json();\n\n  return (linkedAccounts ?? []) satisfies Profile[];\n}\n\n/**\n * Gets the linked accounts for the current user.\n * For the public-facing API, use `wallet.getProfiles` instead.\n *\n * @internal\n */\nexport async function getLinkedProfilesInternal({\n  client,\n  ecosystem,\n  storage,\n}: {\n  client: ThirdwebClient;\n  ecosystem?: Ecosystem;\n  storage: ClientScopedStorage;\n}): Promise<Profile[]> {\n  const clientFetch = getClientFetch(client, ecosystem);\n  const IN_APP_URL = getThirdwebBaseUrl(\"inAppWallet\");\n  const currentAccountToken = await storage.getAuthCookie();\n  if (!currentAccountToken) {\n    throw new Error(\"Failed to get linked accounts, no user logged in\");\n  }\n\n  const headers: Record<string, string> = {\n    Authorization: `Bearer iaw-auth-token:${currentAccountToken}`,\n    \"Content-Type\": \"application/json\",\n  };\n\n  const linkedAccountsResp = await clientFetch(\n    `${IN_APP_URL}/api/2024-05-05/accounts`,\n    {\n      headers,\n      method: \"GET\",\n    },\n  );\n\n  if (!linkedAccountsResp.ok) {\n    const body = await linkedAccountsResp.json();\n    throw new Error(body.message || \"Failed to get linked accounts.\");\n  }\n\n  const { linkedAccounts } = await linkedAccountsResp.json();\n\n  return (linkedAccounts ?? []) satisfies Profile[];\n}\n"],"mappings":"AACA,SAASA,kBAAkB,QAAQ,8BAA8B;AACjE,SAASC,cAAc,QAAQ,4BAA4B;AAC3D,SAASC,SAAS,QAAQ,2BAA2B;AAKrD;;;;;;AAMA,OAAO,eAAeC,WAAWA,CAAAC,IAAA,EAUhC;EAAA,IAViC;IAChCC,MAAM;IACNC,SAAS;IACTC,WAAW;IACXC;EAAO,CAMR,GAAAJ,IAAA;EACC,MAAMK,WAAW,GAAGR,cAAc,CAACI,MAAM,EAAEC,SAAS,CAAC;EACrD,MAAMI,UAAU,GAAGV,kBAAkB,CAAC,aAAa,CAAC;EACpD,MAAMW,mBAAmB,GAAG,MAAMH,OAAO,CAACI,aAAa,EAAE;EAEzD,IAAI,CAACD,mBAAmB,EAAE;IACxB,MAAM,IAAIE,KAAK,CAAC,2CAA2C,CAAC;EAC9D;EAEA,MAAMC,OAAO,GAA2B;IACtCC,aAAa,2BAAAC,MAAA,CAA2BL,mBAAmB,CAAE;IAC7D,cAAc,EAAE;GACjB;EACD,MAAMM,iBAAiB,GAAG,MAAMR,WAAW,IAAAO,MAAA,CACtCN,UAAU,sCACb;IACEQ,IAAI,EAAEhB,SAAS,CAAC;MACdiB,yBAAyB,EAAEZ;KAC5B,CAAC;IACFO,OAAO;IACPM,MAAM,EAAE;GACT,CACF;EAED,IAAI,CAACH,iBAAiB,CAACI,EAAE,EAAE;IACzB,MAAMH,IAAI,GAAG,MAAMD,iBAAiB,CAACK,IAAI,EAAE;IAC3C,MAAM,IAAIT,KAAK,CAACK,IAAI,CAACK,OAAO,IAAI,yBAAyB,CAAC;EAC5D;EAEA,MAAM;IAAEC;EAAc,CAAE,GAAG,MAAMP,iBAAiB,CAACK,IAAI,EAAE;EAEzD,OAAQE,cAAc,aAAdA,cAAc,cAAdA,cAAc,GAAI,EAAE;AAC9B;AAEA;;;;;;AAMA,OAAO,eAAeC,aAAaA,CAAAC,KAAA,EAYlC;EAAA,IAZmC;IAClCrB,MAAM;IACNC,SAAS;IACTqB,eAAe;IACfC,oBAAoB,GAAG,KAAK;IAC5BpB;EAAO,CAOR,GAAAkB,KAAA;EACC,MAAMjB,WAAW,GAAGR,cAAc,CAACI,MAAM,EAAEC,SAAS,CAAC;EACrD,MAAMI,UAAU,GAAGV,kBAAkB,CAAC,aAAa,CAAC;EACpD,MAAMW,mBAAmB,GAAG,MAAMH,OAAO,CAACI,aAAa,EAAE;EAEzD,IAAI,CAACD,mBAAmB,EAAE;IACxB,MAAM,IAAIE,KAAK,CAAC,6CAA6C,CAAC;EAChE;EAEA,MAAMC,OAAO,GAA2B;IACtCC,aAAa,2BAAAC,MAAA,CAA2BL,mBAAmB,CAAE;IAC7D,cAAc,EAAE;GACjB;EACD,MAAMM,iBAAiB,GAAG,MAAMR,WAAW,IAAAO,MAAA,CACtCN,UAAU,yCACb;IACEQ,IAAI,EAAEhB,SAAS,CAAC;MACd0B,oBAAoB;MACpBC,OAAO,EAAEF,eAAe,CAACE,OAAO;MAChCC,IAAI,EAAEH,eAAe,CAACG;KACvB,CAAC;IACFhB,OAAO;IACPM,MAAM,EAAE;GACT,CACF;EAED,IAAI,CAACH,iBAAiB,CAACI,EAAE,EAAE;IACzB,MAAMH,IAAI,GAAG,MAAMD,iBAAiB,CAACK,IAAI,EAAE;IAC3C,MAAM,IAAIT,KAAK,CAACK,IAAI,CAACK,OAAO,IAAI,2BAA2B,CAAC;EAC9D;EAEA,MAAM;IAAEC;EAAc,CAAE,GAAG,MAAMP,iBAAiB,CAACK,IAAI,EAAE;EAEzD,OAAQE,cAAc,aAAdA,cAAc,cAAdA,cAAc,GAAI,EAAE;AAC9B;AAEA;;;;;;AAMA,OAAO,eAAeO,yBAAyBA,CAAAC,KAAA,EAQ9C;EAAA,IAR+C;IAC9C3B,MAAM;IACNC,SAAS;IACTE;EAAO,CAKR,GAAAwB,KAAA;EACC,MAAMvB,WAAW,GAAGR,cAAc,CAACI,MAAM,EAAEC,SAAS,CAAC;EACrD,MAAMI,UAAU,GAAGV,kBAAkB,CAAC,aAAa,CAAC;EACpD,MAAMW,mBAAmB,GAAG,MAAMH,OAAO,CAACI,aAAa,EAAE;EACzD,IAAI,CAACD,mBAAmB,EAAE;IACxB,MAAM,IAAIE,KAAK,CAAC,kDAAkD,CAAC;EACrE;EAEA,MAAMC,OAAO,GAA2B;IACtCC,aAAa,2BAAAC,MAAA,CAA2BL,mBAAmB,CAAE;IAC7D,cAAc,EAAE;GACjB;EAED,MAAMsB,kBAAkB,GAAG,MAAMxB,WAAW,IAAAO,MAAA,CACvCN,UAAU,+BACb;IACEI,OAAO;IACPM,MAAM,EAAE;GACT,CACF;EAED,IAAI,CAACa,kBAAkB,CAACZ,EAAE,EAAE;IAC1B,MAAMH,IAAI,GAAG,MAAMe,kBAAkB,CAACX,IAAI,EAAE;IAC5C,MAAM,IAAIT,KAAK,CAACK,IAAI,CAACK,OAAO,IAAI,gCAAgC,CAAC;EACnE;EAEA,MAAM;IAAEC;EAAc,CAAE,GAAG,MAAMS,kBAAkB,CAACX,IAAI,EAAE;EAE1D,OAAQE,cAAc,aAAdA,cAAc,cAAdA,cAAc,GAAI,EAAE;AAC9B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}