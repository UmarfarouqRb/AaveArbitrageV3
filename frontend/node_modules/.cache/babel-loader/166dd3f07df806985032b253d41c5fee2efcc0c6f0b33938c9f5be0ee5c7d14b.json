{"ast":null,"code":"import { addTransactionToStore } from \"../../transaction-store.js\";\nexport async function sendGaslessTransaction(_ref) {\n  let {\n    account,\n    transaction,\n    serializableTransaction,\n    gasless\n  } = _ref;\n  // TODO: handle special case for mutlicall transactions!\n  // Steps:\n  // 1. check if the method is `multicall` by comparing the 4bytes data with the `multicall` selector\n  // 2. split the rest of the data into its \"parts\"\n  // 3. solidityPack the parts with the part data + the `account.address`\n  // see v4: `core/classes/transactions.ts>Transaction>prepareGasless:L551`\n  if (serializableTransaction.value && serializableTransaction.value > 0n) {\n    throw new Error(\"Gasless transactions cannot have a value\");\n  }\n  // TODO: multiply gas by 2 for some reason(?) - we do in v4, *should* we?\n  let result;\n  // biconomy\n  if (gasless.provider === \"biconomy\") {\n    const {\n      relayBiconomyTransaction\n    } = await import(\"./providers/biconomy.js\");\n    result = await relayBiconomyTransaction({\n      account,\n      gasless,\n      serializableTransaction,\n      transaction\n    });\n  }\n  // openzeppelin\n  if (gasless.provider === \"openzeppelin\") {\n    const {\n      relayOpenZeppelinTransaction\n    } = await import(\"./providers/openzeppelin.js\");\n    result = await relayOpenZeppelinTransaction({\n      account,\n      gasless,\n      serializableTransaction,\n      transaction\n    });\n  }\n  if (gasless.provider === \"engine\") {\n    const {\n      relayEngineTransaction\n    } = await import(\"./providers/engine.js\");\n    result = await relayEngineTransaction({\n      account,\n      gasless,\n      serializableTransaction,\n      transaction\n    });\n  }\n  if (!result) {\n    throw new Error(\"Unsupported gasless provider\");\n  }\n  addTransactionToStore({\n    address: account.address,\n    chainId: transaction.chain.id,\n    transactionHash: result.transactionHash\n  });\n  return result;\n}","map":{"version":3,"names":["addTransactionToStore","sendGaslessTransaction","_ref","account","transaction","serializableTransaction","gasless","value","Error","result","provider","relayBiconomyTransaction","relayOpenZeppelinTransaction","relayEngineTransaction","address","chainId","chain","id","transactionHash"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/transaction/actions/gasless/send-gasless-transaction.ts"],"sourcesContent":["import type { Account } from \"../../../wallets/interfaces/wallet.js\";\nimport type { PreparedTransaction } from \"../../prepare-transaction.js\";\nimport type { SerializableTransaction } from \"../../serialize-transaction.js\";\nimport { addTransactionToStore } from \"../../transaction-store.js\";\nimport type { WaitForReceiptOptions } from \"../wait-for-tx-receipt.js\";\nimport type { GaslessOptions } from \"./types.js\";\n\ntype SendGaslessTransactionOptions = {\n  account: Account;\n  // TODO: update this to `Transaction<\"prepared\">` once the type is available to ensure only prepared transactions are accepted\n  // biome-ignore lint/suspicious/noExplicitAny: library function that accepts any prepared transaction type\n  transaction: PreparedTransaction<any>;\n  serializableTransaction: SerializableTransaction;\n  gasless: GaslessOptions;\n};\n\nexport async function sendGaslessTransaction({\n  account,\n  transaction,\n  serializableTransaction,\n  gasless,\n}: SendGaslessTransactionOptions): Promise<WaitForReceiptOptions> {\n  // TODO: handle special case for mutlicall transactions!\n  // Steps:\n  // 1. check if the method is `multicall` by comparing the 4bytes data with the `multicall` selector\n  // 2. split the rest of the data into its \"parts\"\n  // 3. solidityPack the parts with the part data + the `account.address`\n  // see v4: `core/classes/transactions.ts>Transaction>prepareGasless:L551`\n\n  if (serializableTransaction.value && serializableTransaction.value > 0n) {\n    throw new Error(\"Gasless transactions cannot have a value\");\n  }\n\n  // TODO: multiply gas by 2 for some reason(?) - we do in v4, *should* we?\n\n  let result: WaitForReceiptOptions | undefined;\n\n  // biconomy\n  if (gasless.provider === \"biconomy\") {\n    const { relayBiconomyTransaction } = await import(\n      \"./providers/biconomy.js\"\n    );\n    result = await relayBiconomyTransaction({\n      account,\n      gasless,\n      serializableTransaction,\n      transaction,\n    });\n  }\n\n  // openzeppelin\n  if (gasless.provider === \"openzeppelin\") {\n    const { relayOpenZeppelinTransaction } = await import(\n      \"./providers/openzeppelin.js\"\n    );\n    result = await relayOpenZeppelinTransaction({\n      account,\n      gasless,\n      serializableTransaction,\n      transaction,\n    });\n  }\n\n  if (gasless.provider === \"engine\") {\n    const { relayEngineTransaction } = await import(\"./providers/engine.js\");\n    result = await relayEngineTransaction({\n      account,\n      gasless,\n      serializableTransaction,\n      transaction,\n    });\n  }\n\n  if (!result) {\n    throw new Error(\"Unsupported gasless provider\");\n  }\n  addTransactionToStore({\n    address: account.address,\n    chainId: transaction.chain.id,\n    transactionHash: result.transactionHash,\n  });\n  return result;\n}\n"],"mappings":"AAGA,SAASA,qBAAqB,QAAQ,4BAA4B;AAalE,OAAO,eAAeC,sBAAsBA,CAAAC,IAAA,EAKZ;EAAA,IALa;IAC3CC,OAAO;IACPC,WAAW;IACXC,uBAAuB;IACvBC;EAAO,CACuB,GAAAJ,IAAA;EAC9B;EACA;EACA;EACA;EACA;EACA;EAEA,IAAIG,uBAAuB,CAACE,KAAK,IAAIF,uBAAuB,CAACE,KAAK,GAAG,EAAE,EAAE;IACvE,MAAM,IAAIC,KAAK,CAAC,0CAA0C,CAAC;EAC7D;EAEA;EAEA,IAAIC,MAAyC;EAE7C;EACA,IAAIH,OAAO,CAACI,QAAQ,KAAK,UAAU,EAAE;IACnC,MAAM;MAAEC;IAAwB,CAAE,GAAG,MAAM,MAAM,CAC/C,yBAAyB,CAC1B;IACDF,MAAM,GAAG,MAAME,wBAAwB,CAAC;MACtCR,OAAO;MACPG,OAAO;MACPD,uBAAuB;MACvBD;KACD,CAAC;EACJ;EAEA;EACA,IAAIE,OAAO,CAACI,QAAQ,KAAK,cAAc,EAAE;IACvC,MAAM;MAAEE;IAA4B,CAAE,GAAG,MAAM,MAAM,CACnD,6BAA6B,CAC9B;IACDH,MAAM,GAAG,MAAMG,4BAA4B,CAAC;MAC1CT,OAAO;MACPG,OAAO;MACPD,uBAAuB;MACvBD;KACD,CAAC;EACJ;EAEA,IAAIE,OAAO,CAACI,QAAQ,KAAK,QAAQ,EAAE;IACjC,MAAM;MAAEG;IAAsB,CAAE,GAAG,MAAM,MAAM,CAAC,uBAAuB,CAAC;IACxEJ,MAAM,GAAG,MAAMI,sBAAsB,CAAC;MACpCV,OAAO;MACPG,OAAO;MACPD,uBAAuB;MACvBD;KACD,CAAC;EACJ;EAEA,IAAI,CAACK,MAAM,EAAE;IACX,MAAM,IAAID,KAAK,CAAC,8BAA8B,CAAC;EACjD;EACAR,qBAAqB,CAAC;IACpBc,OAAO,EAAEX,OAAO,CAACW,OAAO;IACxBC,OAAO,EAAEX,WAAW,CAACY,KAAK,CAACC,EAAE;IAC7BC,eAAe,EAAET,MAAM,CAACS;GACzB,CAAC;EACF,OAAOT,MAAM;AACf","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}