{"ast":null,"code":"import { getThirdwebBaseUrl } from \"../../../../utils/domains.js\";\nimport { getClientFetch } from \"../../../../utils/fetch.js\";\nimport { stringify } from \"../../../../utils/json.js\";\nexport async function signMessage(_ref) {\n  let {\n    client,\n    payload: {\n      message,\n      isRaw,\n      originalMessage,\n      chainId\n    },\n    storage\n  } = _ref;\n  const authToken = await storage.getAuthCookie();\n  const ecosystem = storage.ecosystem;\n  const clientFetch = getClientFetch(client, ecosystem);\n  if (!authToken) {\n    throw new Error(\"No auth token found when signing message\");\n  }\n  const response = await clientFetch(\"\".concat(getThirdwebBaseUrl(\"inAppWallet\"), \"/api/v1/enclave-wallet/sign-message\"), {\n    body: stringify({\n      messagePayload: {\n        chainId,\n        isRaw,\n        message,\n        originalMessage\n      }\n    }),\n    headers: {\n      Authorization: \"Bearer embedded-wallet-token:\".concat(authToken),\n      \"Content-Type\": \"application/json\",\n      \"x-thirdweb-client-id\": client.clientId\n    },\n    method: \"POST\"\n  });\n  if (!response.ok) {\n    throw new Error(\"Failed to sign message - \".concat(response.status, \" \").concat(response.statusText));\n  }\n  const signedMessage = await response.json();\n  return signedMessage;\n}","map":{"version":3,"names":["getThirdwebBaseUrl","getClientFetch","stringify","signMessage","_ref","client","payload","message","isRaw","originalMessage","chainId","storage","authToken","getAuthCookie","ecosystem","clientFetch","Error","response","concat","body","messagePayload","headers","Authorization","clientId","method","ok","status","statusText","signedMessage","json"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/wallets/in-app/core/actions/sign-message.enclave.ts"],"sourcesContent":["import type { ThirdwebClient } from \"../../../../client/client.js\";\nimport { getThirdwebBaseUrl } from \"../../../../utils/domains.js\";\nimport { getClientFetch } from \"../../../../utils/fetch.js\";\nimport { stringify } from \"../../../../utils/json.js\";\nimport type { ClientScopedStorage } from \"../authentication/client-scoped-storage.js\";\n\nexport async function signMessage({\n  client,\n  payload: { message, isRaw, originalMessage, chainId },\n  storage,\n}: {\n  client: ThirdwebClient;\n  payload: {\n    message: string;\n    isRaw: boolean;\n    originalMessage?: string;\n    chainId?: number;\n  };\n  storage: ClientScopedStorage;\n}) {\n  const authToken = await storage.getAuthCookie();\n  const ecosystem = storage.ecosystem;\n  const clientFetch = getClientFetch(client, ecosystem);\n\n  if (!authToken) {\n    throw new Error(\"No auth token found when signing message\");\n  }\n\n  const response = await clientFetch(\n    `${getThirdwebBaseUrl(\"inAppWallet\")}/api/v1/enclave-wallet/sign-message`,\n    {\n      body: stringify({\n        messagePayload: {\n          chainId,\n          isRaw,\n          message,\n          originalMessage,\n        },\n      }),\n      headers: {\n        Authorization: `Bearer embedded-wallet-token:${authToken}`,\n        \"Content-Type\": \"application/json\",\n        \"x-thirdweb-client-id\": client.clientId,\n      },\n      method: \"POST\",\n    },\n  );\n\n  if (!response.ok) {\n    throw new Error(\n      `Failed to sign message - ${response.status} ${response.statusText}`,\n    );\n  }\n\n  const signedMessage = (await response.json()) as {\n    r: string;\n    s: string;\n    v: number;\n    signature: string;\n    hash: string;\n  };\n  return signedMessage;\n}\n"],"mappings":"AACA,SAASA,kBAAkB,QAAQ,8BAA8B;AACjE,SAASC,cAAc,QAAQ,4BAA4B;AAC3D,SAASC,SAAS,QAAQ,2BAA2B;AAGrD,OAAO,eAAeC,WAAWA,CAAAC,IAAA,EAahC;EAAA,IAbiC;IAChCC,MAAM;IACNC,OAAO,EAAE;MAAEC,OAAO;MAAEC,KAAK;MAAEC,eAAe;MAAEC;IAAO,CAAE;IACrDC;EAAO,CAUR,GAAAP,IAAA;EACC,MAAMQ,SAAS,GAAG,MAAMD,OAAO,CAACE,aAAa,EAAE;EAC/C,MAAMC,SAAS,GAAGH,OAAO,CAACG,SAAS;EACnC,MAAMC,WAAW,GAAGd,cAAc,CAACI,MAAM,EAAES,SAAS,CAAC;EAErD,IAAI,CAACF,SAAS,EAAE;IACd,MAAM,IAAII,KAAK,CAAC,0CAA0C,CAAC;EAC7D;EAEA,MAAMC,QAAQ,GAAG,MAAMF,WAAW,IAAAG,MAAA,CAC7BlB,kBAAkB,CAAC,aAAa,CAAC,0CACpC;IACEmB,IAAI,EAAEjB,SAAS,CAAC;MACdkB,cAAc,EAAE;QACdV,OAAO;QACPF,KAAK;QACLD,OAAO;QACPE;;KAEH,CAAC;IACFY,OAAO,EAAE;MACPC,aAAa,kCAAAJ,MAAA,CAAkCN,SAAS,CAAE;MAC1D,cAAc,EAAE,kBAAkB;MAClC,sBAAsB,EAAEP,MAAM,CAACkB;KAChC;IACDC,MAAM,EAAE;GACT,CACF;EAED,IAAI,CAACP,QAAQ,CAACQ,EAAE,EAAE;IAChB,MAAM,IAAIT,KAAK,6BAAAE,MAAA,CACeD,QAAQ,CAACS,MAAM,OAAAR,MAAA,CAAID,QAAQ,CAACU,UAAU,CAAE,CACrE;EACH;EAEA,MAAMC,aAAa,GAAI,MAAMX,QAAQ,CAACY,IAAI,EAMzC;EACD,OAAOD,aAAa;AACtB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}