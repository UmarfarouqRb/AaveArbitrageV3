{"ast":null,"code":"import { AUTH_TOKEN_LOCAL_STORAGE_NAME, DEVICE_SHARE_LOCAL_STORAGE_NAME, GUEST_SESSION_LOCAL_STORAGE_NAME, PASSKEY_CREDENTIAL_ID_LOCAL_STORAGE_NAME, WALLET_CONNECT_SESSIONS_LOCAL_STORAGE_NAME, WALLET_USER_ID_LOCAL_STORAGE_NAME } from \"../constants/settings.js\";\nconst data = new Map();\n/**\n * @internal\n */\nexport class ClientScopedStorage {\n  /**\n   * @internal\n   */\n  constructor(_ref) {\n    let {\n      storage,\n      clientId,\n      ecosystem\n    } = _ref;\n    Object.defineProperty(this, \"key\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"storage\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"ecosystem\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    this.storage = storage;\n    this.key = getLocalStorageKey(clientId, ecosystem === null || ecosystem === void 0 ? void 0 : ecosystem.id);\n    this.ecosystem = ecosystem;\n  }\n  async getItem(key) {\n    var _data$get;\n    if (this.storage) {\n      return this.storage.getItem(key);\n    }\n    return (_data$get = data.get(key)) !== null && _data$get !== void 0 ? _data$get : null;\n  }\n  async setItem(key, value) {\n    if (this.storage) {\n      return this.storage.setItem(key, value);\n    }\n    data.set(key, value);\n  }\n  async removeItem(key) {\n    const item = await this.getItem(key);\n    if (this.storage && item) {\n      this.storage.removeItem(key);\n      return true;\n    }\n    return false;\n  }\n  /**\n   * @internal\n   */\n  async getWalletConnectSessions() {\n    return this.getItem(WALLET_CONNECT_SESSIONS_LOCAL_STORAGE_NAME(this.key));\n  }\n  /**\n   * @internal\n   */\n  async saveWalletConnectSessions(stringifiedSessions) {\n    await this.setItem(WALLET_CONNECT_SESSIONS_LOCAL_STORAGE_NAME(this.key), stringifiedSessions);\n  }\n  /**\n   * @internal\n   */\n  async savePasskeyCredentialId(id) {\n    await this.setItem(PASSKEY_CREDENTIAL_ID_LOCAL_STORAGE_NAME(this.key), id);\n  }\n  /**\n   * @internal\n   */\n  async getPasskeyCredentialId() {\n    return this.getItem(PASSKEY_CREDENTIAL_ID_LOCAL_STORAGE_NAME(this.key));\n  }\n  /**\n   * @internal\n   */\n  async saveAuthCookie(cookie) {\n    await this.setItem(AUTH_TOKEN_LOCAL_STORAGE_NAME(this.key), cookie);\n  }\n  /**\n   * @internal\n   */\n  async getAuthCookie() {\n    return this.getItem(AUTH_TOKEN_LOCAL_STORAGE_NAME(this.key));\n  }\n  /**\n   * @internal\n   */\n  async removeAuthCookie() {\n    return this.removeItem(AUTH_TOKEN_LOCAL_STORAGE_NAME(this.key));\n  }\n  /**\n   * @internal\n   */\n  async saveDeviceShare(share, userId) {\n    await this.saveWalletUserId(userId);\n    await this.setItem(DEVICE_SHARE_LOCAL_STORAGE_NAME(this.key, userId), share);\n  }\n  /**\n   * @internal\n   */\n  async getDeviceShare() {\n    const userId = await this.getWalletUserId();\n    if (userId) {\n      return this.getItem(DEVICE_SHARE_LOCAL_STORAGE_NAME(this.key, userId));\n    }\n    return null;\n  }\n  /**\n   * @internal\n   */\n  async removeDeviceShare() {\n    const userId = await this.getWalletUserId();\n    if (userId) {\n      return this.removeItem(DEVICE_SHARE_LOCAL_STORAGE_NAME(this.key, userId));\n    }\n    return false;\n  }\n  /**\n   * @internal\n   */\n  async getWalletUserId() {\n    return this.getItem(WALLET_USER_ID_LOCAL_STORAGE_NAME(this.key));\n  }\n  /**\n   * @internal\n   */\n  async saveWalletUserId(userId) {\n    await this.setItem(WALLET_USER_ID_LOCAL_STORAGE_NAME(this.key), userId);\n  }\n  /**\n   * @internal\n   */\n  async removeWalletUserId() {\n    return this.removeItem(WALLET_USER_ID_LOCAL_STORAGE_NAME(this.key));\n  }\n  /**\n   * @internal\n   */\n  async getGuestSessionId() {\n    return this.getItem(GUEST_SESSION_LOCAL_STORAGE_NAME(this.key));\n  }\n  /**\n   * @internal\n   */\n  async saveGuestSessionId(sessionId) {\n    await this.setItem(GUEST_SESSION_LOCAL_STORAGE_NAME(this.key), sessionId);\n  }\n}\nconst getLocalStorageKey = (clientId, ecosystemId) => {\n  return \"\".concat(clientId).concat(ecosystemId ? \"-\".concat(ecosystemId) : \"\");\n};","map":{"version":3,"names":["AUTH_TOKEN_LOCAL_STORAGE_NAME","DEVICE_SHARE_LOCAL_STORAGE_NAME","GUEST_SESSION_LOCAL_STORAGE_NAME","PASSKEY_CREDENTIAL_ID_LOCAL_STORAGE_NAME","WALLET_CONNECT_SESSIONS_LOCAL_STORAGE_NAME","WALLET_USER_ID_LOCAL_STORAGE_NAME","data","Map","ClientScopedStorage","constructor","_ref","storage","clientId","ecosystem","Object","defineProperty","key","getLocalStorageKey","id","getItem","_data$get","get","setItem","value","set","removeItem","item","getWalletConnectSessions","saveWalletConnectSessions","stringifiedSessions","savePasskeyCredentialId","getPasskeyCredentialId","saveAuthCookie","cookie","getAuthCookie","removeAuthCookie","saveDeviceShare","share","userId","saveWalletUserId","getDeviceShare","getWalletUserId","removeDeviceShare","removeWalletUserId","getGuestSessionId","saveGuestSessionId","sessionId","ecosystemId","concat"],"sources":["/home/user/Arbitrage/frontend/node_modules/thirdweb/src/wallets/in-app/core/authentication/client-scoped-storage.ts"],"sourcesContent":["import type { AsyncStorage } from \"../../../../utils/storage/AsyncStorage.js\";\nimport {\n  AUTH_TOKEN_LOCAL_STORAGE_NAME,\n  DEVICE_SHARE_LOCAL_STORAGE_NAME,\n  GUEST_SESSION_LOCAL_STORAGE_NAME,\n  PASSKEY_CREDENTIAL_ID_LOCAL_STORAGE_NAME,\n  WALLET_CONNECT_SESSIONS_LOCAL_STORAGE_NAME,\n  WALLET_USER_ID_LOCAL_STORAGE_NAME,\n} from \"../constants/settings.js\";\nimport type { Ecosystem } from \"../wallet/types.js\";\n\nconst data = new Map<string, string>();\n\n/**\n * @internal\n */\nexport class ClientScopedStorage {\n  protected key: string;\n  protected storage: AsyncStorage | null;\n  public ecosystem?: Ecosystem;\n  /**\n   * @internal\n   */\n  constructor({\n    storage,\n    clientId,\n    ecosystem,\n  }: {\n    storage: AsyncStorage | null;\n    clientId: string;\n    ecosystem?: Ecosystem;\n  }) {\n    this.storage = storage;\n    this.key = getLocalStorageKey(clientId, ecosystem?.id);\n    this.ecosystem = ecosystem;\n  }\n\n  protected async getItem(key: string): Promise<string | null> {\n    if (this.storage) {\n      return this.storage.getItem(key);\n    }\n    return data.get(key) ?? null;\n  }\n\n  protected async setItem(key: string, value: string): Promise<void> {\n    if (this.storage) {\n      return this.storage.setItem(key, value);\n    }\n    data.set(key, value);\n  }\n\n  protected async removeItem(key: string): Promise<boolean> {\n    const item = await this.getItem(key);\n    if (this.storage && item) {\n      this.storage.removeItem(key);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * @internal\n   */\n  async getWalletConnectSessions(): Promise<string | null> {\n    return this.getItem(WALLET_CONNECT_SESSIONS_LOCAL_STORAGE_NAME(this.key));\n  }\n\n  /**\n   * @internal\n   */\n  async saveWalletConnectSessions(stringifiedSessions: string): Promise<void> {\n    await this.setItem(\n      WALLET_CONNECT_SESSIONS_LOCAL_STORAGE_NAME(this.key),\n      stringifiedSessions,\n    );\n  }\n\n  /**\n   * @internal\n   */\n  async savePasskeyCredentialId(id: string): Promise<void> {\n    await this.setItem(PASSKEY_CREDENTIAL_ID_LOCAL_STORAGE_NAME(this.key), id);\n  }\n\n  /**\n   * @internal\n   */\n  async getPasskeyCredentialId(): Promise<string | null> {\n    return this.getItem(PASSKEY_CREDENTIAL_ID_LOCAL_STORAGE_NAME(this.key));\n  }\n\n  /**\n   * @internal\n   */\n  async saveAuthCookie(cookie: string): Promise<void> {\n    await this.setItem(AUTH_TOKEN_LOCAL_STORAGE_NAME(this.key), cookie);\n  }\n  /**\n   * @internal\n   */\n  async getAuthCookie(): Promise<string | null> {\n    return this.getItem(AUTH_TOKEN_LOCAL_STORAGE_NAME(this.key));\n  }\n  /**\n   * @internal\n   */\n  async removeAuthCookie(): Promise<boolean> {\n    return this.removeItem(AUTH_TOKEN_LOCAL_STORAGE_NAME(this.key));\n  }\n\n  /**\n   * @internal\n   */\n  async saveDeviceShare(share: string, userId: string): Promise<void> {\n    await this.saveWalletUserId(userId);\n    await this.setItem(\n      DEVICE_SHARE_LOCAL_STORAGE_NAME(this.key, userId),\n      share,\n    );\n  }\n  /**\n   * @internal\n   */\n  async getDeviceShare(): Promise<string | null> {\n    const userId = await this.getWalletUserId();\n    if (userId) {\n      return this.getItem(DEVICE_SHARE_LOCAL_STORAGE_NAME(this.key, userId));\n    }\n    return null;\n  }\n  /**\n   * @internal\n   */\n  async removeDeviceShare(): Promise<boolean> {\n    const userId = await this.getWalletUserId();\n    if (userId) {\n      return this.removeItem(DEVICE_SHARE_LOCAL_STORAGE_NAME(this.key, userId));\n    }\n    return false;\n  }\n\n  /**\n   * @internal\n   */\n  async getWalletUserId(): Promise<string | null> {\n    return this.getItem(WALLET_USER_ID_LOCAL_STORAGE_NAME(this.key));\n  }\n  /**\n   * @internal\n   */\n  async saveWalletUserId(userId: string): Promise<void> {\n    await this.setItem(WALLET_USER_ID_LOCAL_STORAGE_NAME(this.key), userId);\n  }\n  /**\n   * @internal\n   */\n  async removeWalletUserId(): Promise<boolean> {\n    return this.removeItem(WALLET_USER_ID_LOCAL_STORAGE_NAME(this.key));\n  }\n\n  /**\n   * @internal\n   */\n  async getGuestSessionId(): Promise<string | null> {\n    return this.getItem(GUEST_SESSION_LOCAL_STORAGE_NAME(this.key));\n  }\n  /**\n   * @internal\n   */\n  async saveGuestSessionId(sessionId: string): Promise<void> {\n    await this.setItem(GUEST_SESSION_LOCAL_STORAGE_NAME(this.key), sessionId);\n  }\n}\n\nconst getLocalStorageKey = (clientId: string, ecosystemId?: string) => {\n  return `${clientId}${ecosystemId ? `-${ecosystemId}` : \"\"}`;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}