"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[12793,21299],{12793:(t,e,n)=>{n.d(e,{getZkGasFees:()=>S,f:()=>M,sendEip712Transaction:()=>k,a:()=>z});var s=n(8),i=n(21627),r=n(30751),a=n(37131),o=n(84117);function c(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hex";const n=u(t),s=(0,r.l)(new Uint8Array(n.length));return n.encode(s),"hex"===e?(0,o.My)(s.bytes):s.bytes}function u(t){return Array.isArray(t)?function(t){const e=t.reduce((t,e)=>t+e.length,0),n=h(e);return{length:e<=55?1+e:1+n+e,encode(s){e<=55?s.pushByte(192+e):(s.pushByte(247+n),1===n?s.pushUint8(e):2===n?s.pushUint16(e):3===n?s.pushUint24(e):s.pushUint32(e));for(const{encode:e}of t)e(s)}}}(t.map(t=>u(t))):function(t){const e="string"===typeof t?(0,a.aT)(t):t,n=h(e.length),s=1===e.length&&e[0]<128?1:e.length<=55?1+e.length:1+n+e.length;return{length:s,encode(t){1===e.length&&e[0]<128?t.pushBytes(e):e.length<=55?(t.pushByte(128+e.length),t.pushBytes(e)):(t.pushByte(183+n),1===n?t.pushUint8(e.length):2===n?t.pushUint16(e.length):3===n?t.pushUint24(e.length):t.pushUint32(e.length),t.pushBytes(e))}}}(t)}function h(t){if(t<256)return 1;if(t<65536)return 2;if(t<2**24)return 3;if(t<2**32)return 4;throw new i.C("Length is too large.")}var l=n(17749),d=n(72364),g=n(83423),p=n(55060),f=n(21299),y=n(3340),m=n(46325),b=n(79002),v=n(3672),w=n(17143),x=n(96706);function P(t,e,n){return t&e^~t&n}function B(t,e,n){return t&e^t&n^e&n}class A extends x.Vw{constructor(t,e,n,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(t),this.view=(0,x.O8)(this.buffer)}update(t){(0,x.CC)(this),t=(0,x.ZJ)(t),(0,x.DO)(t);const{view:e,buffer:n,blockLen:s}=this,i=t.length;for(let r=0;r<i;){const a=Math.min(s-this.pos,i-r);if(a===s){const e=(0,x.O8)(t);for(;s<=i-r;r+=s)this.process(e,r);continue}n.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===s&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,x.CC)(this),(0,x.Ht)(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:s,isLE:i}=this;let{pos:r}=this;e[r++]=128,(0,x.uH)(this.buffer.subarray(r)),this.padOffset>s-r&&(this.process(n,0),r=0);for(let h=r;h<s;h++)e[h]=0;!function(t,e,n,s){if("function"===typeof t.setBigUint64)return t.setBigUint64(e,n,s);const i=BigInt(32),r=BigInt(4294967295),a=Number(n>>i&r),o=Number(n&r),c=s?4:0,u=s?0:4;t.setUint32(e+c,a,s),t.setUint32(e+u,o,s)}(n,s-8,BigInt(8*this.length),i),this.process(n,0);const a=(0,x.O8)(t),o=this.outputLen;if(o%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=o/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<c;h++)a.setUint32(4*h,u[h],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:s,finished:i,destroyed:r,pos:a}=this;return t.destroyed=r,t.finished=i,t.length=s,t.pos=a,s%e&&t.buffer.set(n),t}clone(){return this._cloneInto()}}const I=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);n(94417);const G=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),L=new Uint32Array(64);class F extends A{constructor(){super(64,arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,8,!1),this.A=0|I[0],this.B=0|I[1],this.C=0|I[2],this.D=0|I[3],this.E=0|I[4],this.F=0|I[5],this.G=0|I[6],this.H=0|I[7]}get(){const{A:t,B:e,C:n,D:s,E:i,F:r,G:a,H:o}=this;return[t,e,n,s,i,r,a,o]}set(t,e,n,s,i,r,a,o){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|s,this.E=0|i,this.F=0|r,this.G=0|a,this.H=0|o}process(t,e){for(let h=0;h<16;h++,e+=4)L[h]=t.getUint32(e,!1);for(let h=16;h<64;h++){const t=L[h-15],e=L[h-2],n=(0,x.Ow)(t,7)^(0,x.Ow)(t,18)^t>>>3,s=(0,x.Ow)(e,17)^(0,x.Ow)(e,19)^e>>>10;L[h]=s+L[h-7]+n+L[h-16]|0}let{A:n,B:s,C:i,D:r,E:a,F:o,G:c,H:u}=this;for(let h=0;h<64;h++){const t=u+((0,x.Ow)(a,6)^(0,x.Ow)(a,11)^(0,x.Ow)(a,25))+P(a,o,c)+G[h]+L[h]|0,e=((0,x.Ow)(n,2)^(0,x.Ow)(n,13)^(0,x.Ow)(n,22))+B(n,s,i)|0;u=c,c=o,o=a,a=r+t|0,r=i,i=s,s=n,n=t+e|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,r=r+this.D|0,a=a+this.E|0,o=o+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,s,i,r,a,o,c,u)}roundClean(){(0,x.uH)(L)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,x.uH)(this.buffer)}}const U=(0,x.qj)(()=>new F);var C=n(31499);const D=2097120n;class O extends i.C{constructor(t){let{givenLength:e,maxBytecodeSize:n}=t;super("Bytecode cannot be longer than ".concat(n," bytes. Given length: ").concat(e),{name:"BytecodeLengthExceedsMaxSizeError"})}}class j extends i.C{constructor(t){let{givenLengthInWords:e}=t;super("Bytecode length in 32-byte words must be odd. Given length in words: ".concat(e),{name:"BytecodeLengthInWordsMustBeOddError"})}}class E extends i.C{constructor(t){let{givenLength:e}=t;super("The bytecode length in bytes must be divisible by 32. Given length: ".concat(e),{name:"BytecodeLengthMustBeDivisibleBy32Error"})}}function _(t){const e=(0,a.ZJ)(t);if(e.length%32!==0)throw new E({givenLength:e.length});if(e.length>D)throw new O({givenLength:e.length,maxBytecodeSize:D});const n=function(t,e){const n=e||"hex",s=U((0,C.q)(t,{strict:!1})?(0,a.ZJ)(t):t);return"bytes"===n?s:(0,o.nj)(s)}(e),s=(0,a.ZJ)(n),i=e.length/32;if(i%2===0)throw new j({givenLengthInWords:i});const r=(0,a.ZJ)(i),c=(0,w.eV)(r,{size:2}),u=new Uint8Array([1,0]);return s.set(u,0),s.set(c,2),s}const T=50000n,H=t=>{const e=function(t){var e;const{gas:n,nonce:s,to:i,from:r,value:a,maxFeePerGas:o,maxPriorityFeePerGas:c,paymaster:u,paymasterInput:h,gasPerPubdata:l,data:d,factoryDeps:g}=t;return{data:d||"0x0",factoryDeps:null!==(e=null===g||void 0===g?void 0:g.map(t=>(0,y.nj)(_(t))))&&void 0!==e?e:[],from:BigInt(r),gasLimit:null!==n&&void 0!==n?n:0n,gasPerPubdataByteLimit:null!==l&&void 0!==l?l:T,maxFeePerGas:null!==o&&void 0!==o?o:0n,maxPriorityFeePerGas:null!==c&&void 0!==c?c:0n,nonce:s?BigInt(s):0n,paymaster:u?BigInt(u):0n,paymasterInput:h||"0x",to:i?BigInt(i):0n,txType:113n,value:null!==a&&void 0!==a?a:0n}}(t);return{domain:{chainId:t.chainId,name:"zkSync",version:"2"},message:e,primaryType:"Transaction",types:{Transaction:[{name:"txType",type:"uint256"},{name:"from",type:"uint256"},{name:"to",type:"uint256"},{name:"gasLimit",type:"uint256"},{name:"gasPerPubdataByteLimit",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymaster",type:"uint256"},{name:"nonce",type:"uint256"},{name:"value",type:"uint256"},{name:"data",type:"bytes"},{name:"factoryDeps",type:"bytes32[]"},{name:"paymasterInput",type:"bytes"}]}}};async function k(t){const{account:e,transaction:n}=t,s=await M(t),i=await z({account:e,chainId:n.chain.id,eip712Transaction:s}),r=(0,d.getRpcClient)(n),a=await(0,l.B)(r,i);return{chain:n.chain,client:n.client,transactionHash:a}}async function z(t){const{account:e,eip712Transaction:n,chainId:i}=t,r=H(n),a=await e.signTypedData((0,s.A)({},r));return function(t){const{chainId:e,gas:n,nonce:s,to:i,from:r,value:a,maxFeePerGas:o,maxPriorityFeePerGas:u,customSignature:h,factoryDeps:l,paymaster:d,paymasterInput:g,gasPerPubdata:p,data:m}=t,b=[s?(0,y.nj)(s):"0x",u?(0,y.nj)(u):"0x",o?(0,y.nj)(o):"0x",n?(0,y.nj)(n):"0x",null!==i&&void 0!==i?i:"0x",a?(0,y.nj)(a):"0x",null!==m&&void 0!==m?m:"0x0",(0,y.nj)(e),(0,y.nj)(""),(0,y.nj)(""),(0,y.nj)(e),null!==r&&void 0!==r?r:"0x",p?(0,y.nj)(p):(0,y.nj)(T),null!==l&&void 0!==l?l:[],null!==h&&void 0!==h?h:"0x",d&&g?[d,g]:[]];return(0,f.concatHex)(["0x71",c(b)])}((0,s.A)((0,s.A)({},n),{},{chainId:i,customSignature:a}))}async function M(t){const{account:e,transaction:n}=t,{gas:i,maxFeePerGas:r,maxPriorityFeePerGas:a,gasPerPubdata:o}=await S({from:(0,g.bv)(e.address),transaction:n}),c=await(0,v.$)({from:e.address,transaction:(0,s.A)((0,s.A)({},n),{},{gas:i,maxFeePerGas:r,maxPriorityFeePerGas:a})});return(0,s.A)((0,s.A)((0,s.A)({},c),n.eip712),{},{from:e.address,gasPerPubdata:o})}async function S(t){const{transaction:e,from:n}=t;let[i,r,o,c]=await Promise.all([(0,m.r)(e.gas),(0,m.r)(e.maxFeePerGas),(0,m.r)(e.maxPriorityFeePerGas),(0,m.r)(e.eip712)]),u=null===c||void 0===c?void 0:c.gasPerPubdata;if(void 0===i||void 0===r||void 0===o){const t=(0,d.getRpcClient)(e),c=await async function(t){var e;const{transaction:n,from:i}=t,[r,o,c,u]=await Promise.all([(0,b.encode)(n),(0,m.r)(n.to),(0,m.r)(n.value),(0,m.r)(n.eip712)]),h=null===u||void 0===u?void 0:u.gasPerPubdata;return{data:r,eip712Meta:(0,s.A)((0,s.A)({},u),{},{factoryDeps:null===u||void 0===u||null===(e=u.factoryDeps)||void 0===e?void 0:e.map(t=>Array.from((0,a.aT)(t))),gasPerPubdata:h||50000n}),from:i,gasPerPubdata:h,to:o,type:"0x71",value:c}}({from:n,transaction:e}),h=await t({method:"zks_estimateFee",params:[(0,p.Xf)(c,y.nj)]});i=2n*(0,p.Dg)(h.gas_limit);r=2n*(0,p.Dg)(h.max_fee_per_gas),o=(0,p.Dg)(h.max_priority_fee_per_gas)||1n,u=2n*(0,p.Dg)(h.gas_per_pubdata_limit),u<50000n&&(u=50000n)}return{gas:i,gasPerPubdata:u,maxFeePerGas:r,maxPriorityFeePerGas:o}}},17749:(t,e,n)=>{async function s(t,e){return await t({method:"eth_sendRawTransaction",params:[e]})}n.d(e,{B:()=>s})},21299:(t,e,n)=>{n.r(e),n.d(e,{concatHex:()=>i});var s=n(29006);function i(t){return s.xW(...t)}},55060:(t,e,n)=>{n.d(e,{Dg:()=>i,Xf:()=>r});var s=n(3340);function i(t){if(["string","number"].includes(typeof t)&&!Number.isInteger(Number(t)))throw new Error("Expected value to be an integer to convert to a bigint, got ".concat(t," of type ").concat(typeof t));return t instanceof Uint8Array?BigInt((0,s.EY)(t)):BigInt(t)}const r=(t,e)=>"bigint"===typeof t?e(t):Array.isArray(t)?t.map(t=>r(t,e)):t&&"object"===typeof t?Object.fromEntries(Object.entries(t).map(t=>{let[n,s]=t;return[n,r(s,e)]})):t}}]);
//# sourceMappingURL=12793.cf7dd5e2.chunk.js.map