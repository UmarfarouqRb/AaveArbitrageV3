"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[86511,99832],{28887:(t,a,e)=>{e.d(a,{cF:()=>n});const n="0x0000000000000000000000000000000000000000"},30293:(t,a,e)=>{e.r(a),e.d(a,{sendTransaction:()=>o});var n=e(8);let r=null;var i=e(93258),s=e(3672);async function o(t){let{account:a,transaction:o,gasless:c}=t;const d=r;if(d){const{account:t,transaction:e}=await d({account:a,transaction:o});a=t,o=e}if(a.onTransactionRequested&&await a.onTransactionRequested(o),o.eip712){const{sendEip712Transaction:t}=await e.e(12793).then(e.bind(e,12793));return t({account:a,transaction:o})}const l=await(0,s.$)({from:a,transaction:o});if(c){const{sendGaslessTransaction:t}=await e.e(59255).then(e.bind(e,59255));return t({account:a,gasless:c,serializableTransaction:l,transaction:o})}const u=await a.sendTransaction(l);return(0,i.Kj)({address:a.address,chainId:o.chain.id,transactionHash:u.transactionHash}),(0,n.A)((0,n.A)({},u),{},{chain:o.chain,client:o.client})}},86511:(t,a,e)=>{e.d(a,{readContract:()=>m});var n=e(55907),r=e(60005),i=e(53986),s=e(3340);const o=["blockNumber","blockTag"];var c=e(72364),d=e(71760),l=e(64819),u=e(83423),p=e(9363);async function m(t){const{contract:a,method:e,params:m}=t,[y,v]=await Promise.all([(async()=>{var t;if(Array.isArray(e))return e;if((0,p.d)(e))return(0,l.v)(e);if("function"===typeof e)return(0,l.v)(await e(a));if("string"===typeof e&&e.startsWith("function ")){const t=(0,n.$)(e);if("function"===t.type)return(0,l.v)(t);throw new Error('"method" passed is not of type "function"')}if(a.abi&&(null===(t=a.abi)||void 0===t?void 0:t.length)>0){var r;const t=null===(r=a.abi)||void 0===r?void 0:r.find(t=>"function"===t.type&&t.name===e);if(t)return(0,l.v)(t)}throw new Error('Could not resolve method "'.concat(e,'".'))})(),"function"===typeof m?m():m]);let f;f=0===y[1].length?y[0]:y[0]+(0,d.hd)(y[1],v).slice(2);const h=(0,c.getRpcClient)({chain:a.chain,client:a.client}),w=await async function(t,a){const{blockNumber:e,blockTag:n}=a,r=(0,i.A)(a,o),c=(e?(0,s.cK)(e):void 0)||n||"latest";return await t({method:"eth_call",params:a.stateOverrides?[r,c,(d=a.stateOverrides,Object.fromEntries(Object.entries(d).map(t=>{let[a,e]=t;return[a,{balance:e.balance?(0,s.cK)(e.balance):void 0,code:e.code,nonce:e.nonce?(0,s.cK)(e.nonce):void 0,state:e.state,stateDiff:e.stateDiff}]})))]:[r,c]});var d}(h,{data:f,from:t.from?(0,u.bv)(t.from):void 0,to:a.address}),A=(0,r.n)(y[2],w);return Array.isArray(A)&&1===A.length?A[0]:A}},92719:(t,a,e)=>{e.d(a,{HM:()=>d,Lc:()=>l,Mi:()=>c,zi:()=>u});var n=e(77877),r=e(86511),i=e(97779),s=e(3340),o=e(27059);async function c(t){const{factoryContract:a,predictAddressOverride:e,adminAddress:n,accountSalt:c,accountAddress:d}=t;if(e)return e(a,n);if(d)return d;if(!n)throw new Error("Account address is required to predict the smart wallet address.");return(0,o.n)(async()=>{const t=c&&(0,i.q)(c)?c:(0,s.i3)(null!==c&&void 0!==c?c:"");let e,o=0;for(;o<=3;)try{e=await(0,r.readContract)({contract:a,method:"function getAddress(address, bytes) returns (address)",params:[n,t]});break}catch(d){if(3===o)throw d;const t=2**(o+1)*200;await new Promise(a=>setTimeout(a,t)),o++}if(!e)throw new Error("No smart account address found for admin address ".concat(n," and salt ").concat(c));return e},{cacheKey:"".concat(t.factoryContract.chain.id,"-").concat(t.factoryContract.address,"-").concat(t.adminAddress,"-").concat(t.accountSalt),cacheTime:864e5})}function d(t){const{adminAddress:a,factoryContract:e,createAccountOverride:r,accountSalt:o}=t;if(r)return r(e,a);const c=o&&(0,i.q)(o)?o:(0,s.i3)(null!==o&&void 0!==o?o:"");return(0,n.m)({contract:e,method:"function createAccount(address, bytes) returns (address)",params:[a,c]})}function l(t){const{accountContract:a,transaction:e,executeOverride:r}=t;if(r)return r(a,e);let i=e.value||0n;return 295!==e.chainId&&296!==e.chainId||(i=BigInt(i)/BigInt(10**10)),(0,n.m)({contract:a,gas:e.gas?e.gas+21000n:void 0,method:"function execute(address, uint256, bytes)",params:[e.to||"",i,e.data||"0x"]})}function u(t){var a;const{accountContract:e,transactions:r,executeBatchOverride:i}=t;if(i)return i(e,r);let s=r.map(t=>t.value||0n);const o=null===(a=r[0])||void 0===a?void 0:a.chainId;return 295!==o&&296!==o||(s=s.map(t=>BigInt(t)/BigInt(10**10))),(0,n.m)({contract:e,method:"function executeBatch(address[], uint256[], bytes[])",params:[r.map(t=>t.to||""),s,r.map(t=>t.data||"0x")]})}},93258:(t,a,e)=>{function n(t){const a=new Set;let e=t;return{getValue:()=>e,setValue(t){t!==e&&(e=t,(()=>{for(const t of a)t()})())},subscribe:t=>(a.add(t),()=>{a.delete(t)})}}e.d(a,{Kj:()=>i});const r=new Map;function i(t){const{address:a,transactionHash:e,chainId:i}=t,s=function(t){const a=r.get(t);if(a)return a;const e=n([]);return r.set(t,e),e}(a);s.setValue([...s.getValue(),{chainId:i,transactionHash:e}]),r.set(a,s)}},99832:(t,a,e)=>{e.d(a,{connectSmartAccount:()=>Ft,disconnectSmartAccount:()=>St});var n=e(8),r=e(16419),i=e(15222),s=e(9893),o=e(38736),c=e(86511);const d="0xdd62ed3e",l=[{name:"owner",type:"address"},{name:"spender",type:"address"}],u=[{type:"uint256"}];var p=e(99108),m=e(77877),y=e(59356);const v="0x095ea7b3",f=[{name:"spender",type:"address"},{name:"value",type:"uint256"}],h=[{type:"bool"}];function w(t){return function(t){const a=(0,y.O)(async()=>"asyncParams"in t?await t.asyncParams():t);return(0,m.m)({accessList:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.accessList},authorizationList:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.authorizationList},contract:t.contract,erc20Value:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.erc20Value},extraGas:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.extraGas},gas:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.gas},gasPrice:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.gasPrice},maxFeePerGas:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.maxFeePerGas},maxPriorityFeePerGas:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.maxPriorityFeePerGas},method:[v,f,h],nonce:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.nonce},params:async()=>{const t=await a();return[t.spender,t.value]},value:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.value}})}({asyncParams:async()=>{let a;if("amount"in t){const{decimals:n}=await e.e(922).then(e.bind(e,922)),r=await n(t).catch(()=>18);a=(0,p.J1)(t.amount.toString(),r)}else a=t.amountWei;return{overrides:(0,n.A)({erc20Value:{amountWei:a,tokenAddress:t.contract.address}},t.overrides),spender:t.spender,value:a}},contract:t.contract})}var A=e(28887),G=e(69961);const g="0xf15d424e",P=[{name:"signer",type:"address"}],x=[{components:[{name:"signer",type:"address"},{name:"approvedTargets",type:"address[]"},{name:"nativeTokenLimitPerTransaction",type:"uint256"},{name:"startTimestamp",type:"uint128"},{name:"endTimestamp",type:"uint128"}],name:"permissions",type:"tuple"}];const L="0x5892e236",T=[{components:[{name:"signer",type:"address"},{name:"isAdmin",type:"uint8"},{name:"approvedTargets",type:"address[]"},{name:"nativeTokenLimitPerTransaction",type:"uint256"},{name:"permissionStartTimestamp",type:"uint128"},{name:"permissionEndTimestamp",type:"uint128"},{name:"reqValidityStartTimestamp",type:"uint128"},{name:"reqValidityEndTimestamp",type:"uint128"},{name:"uid",type:"bytes32"}],name:"req",type:"tuple"},{name:"signature",type:"bytes"}],C=[];var b=e(55060);function O(){return new Date(Date.now()+31536e7)}function D(t){return(0,b.Dg)(Math.floor(t.getTime()/1e3))}var V=e(41940);const F=[{name:"signer",type:"address"},{name:"isAdmin",type:"uint8"},{name:"approvedTargets",type:"address[]"},{name:"nativeTokenLimitPerTransaction",type:"uint256"},{name:"permissionStartTimestamp",type:"uint128"},{name:"permissionEndTimestamp",type:"uint128"},{name:"reqValidityStartTimestamp",type:"uint128"},{name:"reqValidityEndTimestamp",type:"uint128"},{name:"uid",type:"bytes32"}];async function S(t){var a;const{target:e,permissions:n}=t;return{approvedTargets:"*"===n.approvedTargets?[A.cF]:n.approvedTargets,isAdmin:0,nativeTokenLimitPerTransaction:(0,p.fq)((null===(a=n.nativeTokenLimitPerTransaction)||void 0===a?void 0:a.toString())||"0"),permissionEndTimestamp:D(n.permissionEndTimestamp||O()),permissionStartTimestamp:D(n.permissionStartTimestamp||new Date(0)),reqValidityEndTimestamp:D(O()),reqValidityStartTimestamp:0n,signer:e,uid:await(0,V.O)()}}function k(t){const{contract:a,sessionKeyAddress:e,account:n,permissions:r}=t;return function(t){const a=(0,y.O)(async()=>"asyncParams"in t?await t.asyncParams():t);return(0,m.m)({accessList:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.accessList},authorizationList:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.authorizationList},contract:t.contract,erc20Value:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.erc20Value},extraGas:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.extraGas},gas:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.gas},gasPrice:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.gasPrice},maxFeePerGas:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.maxFeePerGas},maxPriorityFeePerGas:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.maxPriorityFeePerGas},method:[L,T,C],nonce:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.nonce},params:async()=>{const t=await a();return[t.req,t.signature]},value:async()=>{var t;return null===(t=(await a()).overrides)||void 0===t?void 0:t.value}})}({async asyncParams(){const{req:t,signature:i}=await async function(t){const{account:a,contract:e,req:n}=t;return{req:n,signature:await a.signTypedData({domain:{chainId:e.chain.id,name:"Account",verifyingContract:e.address,version:"1"},message:n,primaryType:"SignerPermissionRequest",types:{SignerPermissionRequest:F}})}}({account:n,contract:a,req:await S({permissions:r,target:e})});return{req:t,signature:i}},contract:a})}async function I(t){var a,e;const{accountContract:n,sessionKeyAddress:r,newPermissions:i}=t;if(!await(0,G.isContractDeployed)(n))return!0;const s=await async function(t){return(0,c.readContract)({contract:t.contract,method:[g,P,x],params:[t.signer]})}({contract:n,signer:r});return!!(s.endTimestamp&&s.endTimestamp<Math.floor(Date.now()/1e3))||(!function(t,a){if("*"===a&&1===t.length&&t[0]===A.cF)return!0;if("*"!==a)return a.map(t=>t.toLowerCase()).every(a=>t.map(t=>t.toLowerCase()).includes(a));return!1}(s.approvedTargets,i.approvedTargets)||(0,p.fq)(null!==(a=null===(e=i.nativeTokenLimitPerTransaction)||void 0===e?void 0:e.toString())&&void 0!==a?a:"0")>s.nativeTokenLimitPerTransaction)}var E=e(30293),q=e(3672),M=e(12793),H=e(83423),B=e(13287),K=e(46325),j=e(34476);const U=2n**96n-1n;var z=e(90850),W=e(92719),R=e(20635),N=e(9234),Y=e(52620);const Q="0x35567e1a",$=[{name:"sender",type:"address"},{name:"key",type:"uint192"}],J=[{name:"nonce",type:"uint256"}];const Z="0xa6193531",_=[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],X=[{type:"bytes32"}];const tt="0x22cdde4c",at=[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"accountGasLimits",type:"bytes32"},{name:"preVerificationGas",type:"uint256"},{name:"gasFees",type:"bytes32"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],et=[{type:"bytes32"}];var nt=e(48570),rt=e(79002),it=e(71760),st=e(3340),ot=e(42002),ct=e(58989),dt=e(68098),lt=e(77717),ut=e(17143),pt=e(84117);function mt(t){return t.factory?(0,Y.xW)([t.factory,t.factoryData||"0x"]):"0x"}function yt(t){return(0,Y.xW)([(0,ut.eV)((0,pt.nj)(BigInt(t.maxPriorityFeePerGas)),{size:16}),(0,ut.eV)((0,pt.nj)(BigInt(t.maxFeePerGas)),{size:16})])}function vt(t){return t.paymaster?(0,Y.xW)([t.paymaster,(0,ut.eV)((0,pt.nj)(BigInt(t.paymasterVerificationGasLimit||0)),{size:16}),(0,ut.eV)((0,pt.nj)(BigInt(t.paymasterPostOpGasLimit||0)),{size:16}),t.paymasterData||"0x"]):"0x"}const ft=t=>{return{accountGasLimits:(a=t,(0,Y.xW)([(0,ut.eV)((0,pt.nj)(BigInt(a.verificationGasLimit)),{size:16}),(0,ut.eV)((0,pt.nj)(BigInt(a.callGasLimit)),{size:16})])),callData:t.callData,gasFees:yt(t),initCode:mt(t),nonce:BigInt(t.nonce),paymasterAndData:vt(t),preVerificationGas:BigInt(t.preVerificationGas),sender:t.sender,signature:t.signature};var a};var ht=e(9659);async function wt(t){var a;const{userOp:e,paymasterOverride:n,client:r,chain:i,entrypointAddress:s}=t;if(n)return n(e);const o=null!==s&&void 0!==s?s:R.uh,c=(0,R.RZ)(i),d={id:1,jsonrpc:"2.0",method:"pm_sponsorUserOperation",params:[(0,ht.K)(e),o]},l=(0,ct.KI)(r),u=await l(c,{body:(0,lt.A)(d),headers:{"Content-Type":"application/json"},method:"POST"});if(!u.ok){const t=await u.text()||u.statusText;throw new Error("Paymaster error: ".concat(u.status," - ").concat(t))}const p=await u.json();if(p.result)return"string"===typeof p.result?{paymasterAndData:p.result}:(p.result.reason&&console.warn("Paymaster policy rejected this transaction with reason: ".concat(p.result.reason," ").concat(p.result.policyId?"(policyId: ".concat(p.result.policyId,")"):"")),{callGasLimit:p.result.callGasLimit?(0,st.uU)(p.result.callGasLimit):void 0,paymaster:p.result.paymaster,paymasterAndData:p.result.paymasterAndData,paymasterData:p.result.paymasterData,paymasterPostOpGasLimit:p.result.paymasterPostOpGasLimit?(0,st.uU)(p.result.paymasterPostOpGasLimit):void 0,paymasterVerificationGasLimit:p.result.paymasterVerificationGasLimit?(0,st.uU)(p.result.paymasterVerificationGasLimit):void 0,preVerificationGas:p.result.preVerificationGas?(0,st.uU)(p.result.preVerificationGas):void 0,verificationGasLimit:p.result.verificationGasLimit?(0,st.uU)(p.result.verificationGasLimit):void 0});const m=(null===(a=p.error)||void 0===a?void 0:a.message)||p.error||u.statusText||"unknown error";throw new Error("Paymaster error from ".concat(c,": ").concat(m))}const At=new Set,Gt=t=>"".concat(t.chain.id,":").concat(t.address),gt=t=>{At.add(Gt(t))},Pt=t=>{At.delete(Gt(t))},xt=t=>At.has(Gt(t));async function Lt(t){var a;const{transaction:e,accountContract:r,factoryContract:i,adminAddress:s,overrides:o,sponsorGas:c,waitForDeployment:d=!0,isDeployedOverride:l}=t,u=e.chain,p=e.client,m={bundlerUrl:null===o||void 0===o?void 0:o.bundlerUrl,chain:u,client:p,entrypointAddress:null===o||void 0===o?void 0:o.entrypointAddress},y=(0,R.Fn)((null===(a=t.overrides)||void 0===a?void 0:a.entrypointAddress)||R.uh),[v,f,h,w,A]=await Promise.all(["boolean"===typeof l?l:(0,G.isContractDeployed)(r).then(t=>t||xt(r)),(0,rt.encode)(e),(0,K.r)(e.gas),Tt({bundlerOptions:m,chain:u,client:p,executeTx:e}),bt({accountContract:r,chain:u,client:p,entrypointAddress:null===o||void 0===o?void 0:o.entrypointAddress,getNonceOverride:null===o||void 0===o?void 0:o.getAccountNonce})]),{maxFeePerGas:g,maxPriorityFeePerGas:P}=w;return"v0.7"===y?async function(t){const{bundlerOptions:a,isDeployed:e,factoryContract:r,accountContract:i,adminAddress:s,sponsorGas:o,overrides:c,nonce:d,callData:l,callGasLimit:u,maxFeePerGas:p,maxPriorityFeePerGas:m,waitForDeployment:y}=t,{chain:v,client:f}=a;let h,w;e?(w="0x",y&&await Ot(i)):(h=r.address,w=await(0,rt.encode)((0,W.HM)({accountSalt:null===c||void 0===c?void 0:c.accountSalt,adminAddress:s,createAccountOverride:null===c||void 0===c?void 0:c.createAccount,factoryContract:r})),y&&gt(i));const A={callData:l,callGasLimit:null!==u&&void 0!==u?u:0n,factory:h,factoryData:w,maxFeePerGas:p,maxPriorityFeePerGas:m,nonce:d,paymaster:void 0,paymasterData:"0x",paymasterPostOpGasLimit:0n,paymasterVerificationGasLimit:0n,preVerificationGas:0n,sender:i.address,signature:R.km,verificationGasLimit:0n};if(o){const t=await wt({chain:v,client:f,entrypointAddress:null===c||void 0===c?void 0:c.entrypointAddress,paymasterOverride:null===c||void 0===c?void 0:c.paymaster,userOp:A});if(t.paymaster&&t.paymasterData&&(A.paymaster=t.paymaster,A.paymasterData=t.paymasterData),t.callGasLimit&&t.verificationGasLimit&&t.preVerificationGas&&t.paymasterPostOpGasLimit&&t.paymasterVerificationGasLimit)A.callGasLimit=t.callGasLimit,A.verificationGasLimit=t.verificationGasLimit,A.preVerificationGas=t.preVerificationGas,A.paymasterPostOpGasLimit=t.paymasterPostOpGasLimit,A.paymasterVerificationGasLimit=t.paymasterVerificationGasLimit;else{const t=null!==c&&void 0!==c&&c.tokenPaymaster?{[c.tokenPaymaster.tokenAddress]:{stateDiff:{[(0,dt.S)((0,it.hd)([{type:"address"},{type:"uint256"}],[i.address,c.tokenPaymaster.balanceStorageSlot]))]:(0,st.nj)(N.EA,{size:32})}}}:void 0,e=await(0,z.yY)({options:a,userOp:A},t);A.callGasLimit=e.callGasLimit,A.verificationGasLimit=e.verificationGasLimit,A.preVerificationGas=e.preVerificationGas,A.paymasterPostOpGasLimit=null!==c&&void 0!==c&&c.tokenPaymaster?500000n:e.paymasterPostOpGasLimit||0n,A.paymasterVerificationGasLimit=e.paymasterVerificationGasLimit||0n;const n=await wt({chain:v,client:f,entrypointAddress:null===c||void 0===c?void 0:c.entrypointAddress,paymasterOverride:null===c||void 0===c?void 0:c.paymaster,userOp:A});n.paymaster&&n.paymasterData&&(A.paymaster=n.paymaster,A.paymasterData=n.paymasterData)}}else{const t=await(0,z.yY)({options:a,userOp:A});A.callGasLimit=t.callGasLimit,A.verificationGasLimit=t.verificationGasLimit,A.preVerificationGas=t.preVerificationGas,A.paymasterPostOpGasLimit=t.paymasterPostOpGasLimit||0n,A.paymasterVerificationGasLimit=t.paymasterVerificationGasLimit||0n}return(0,n.A)((0,n.A)({},A),{},{signature:"0x"})}({accountContract:r,adminAddress:s,bundlerOptions:m,callData:f,callGasLimit:h,factoryContract:i,isDeployed:v,maxFeePerGas:g,maxPriorityFeePerGas:P,nonce:A,overrides:o,sponsorGas:c,waitForDeployment:d}):async function(t){const{bundlerOptions:a,isDeployed:e,factoryContract:r,accountContract:i,adminAddress:s,sponsorGas:o,overrides:c,nonce:d,callData:l,callGasLimit:u,maxFeePerGas:p,maxPriorityFeePerGas:m,waitForDeployment:y}=t,{chain:v,client:f}=a;let h;e?(h="0x",y&&await Ot(i)):(h=await async function(t){const{factoryContract:a,adminAddress:e,accountSalt:n,createAccountOverride:r}=t,i=(0,W.HM)({accountSalt:n,adminAddress:e,createAccountOverride:r,factoryContract:a});return(0,Y.xW)([a.address,await(0,rt.encode)(i)])}({accountSalt:null===c||void 0===c?void 0:c.accountSalt,adminAddress:s,createAccountOverride:null===c||void 0===c?void 0:c.createAccount,factoryContract:r}),y&&gt(i));const w={callData:l,callGasLimit:null!==u&&void 0!==u?u:0n,initCode:h,maxFeePerGas:p,maxPriorityFeePerGas:m,nonce:d,paymasterAndData:"0x",preVerificationGas:0n,sender:i.address,signature:R.km,verificationGasLimit:0n};if(o){const t=await wt({chain:v,client:f,entrypointAddress:null===c||void 0===c?void 0:c.entrypointAddress,paymasterOverride:null===c||void 0===c?void 0:c.paymaster,userOp:w}),e="paymasterAndData"in t?t.paymasterAndData:"0x";if(e&&"0x"!==e&&(w.paymasterAndData=e),t.callGasLimit&&t.verificationGasLimit&&t.preVerificationGas)w.callGasLimit=t.callGasLimit,w.verificationGasLimit=t.verificationGasLimit,w.preVerificationGas=t.preVerificationGas;else{const t=await(0,z.yY)({options:a,userOp:w});if(w.callGasLimit=t.callGasLimit,w.verificationGasLimit=t.verificationGasLimit,w.preVerificationGas=t.preVerificationGas,e&&"0x"!==e){const t=await wt({chain:v,client:f,entrypointAddress:null===c||void 0===c?void 0:c.entrypointAddress,paymasterOverride:null===c||void 0===c?void 0:c.paymaster,userOp:w}),a="paymasterAndData"in t?t.paymasterAndData:"0x";a&&"0x"!==a&&(w.paymasterAndData=a)}}}else{const t=await(0,z.yY)({options:a,userOp:w});w.callGasLimit=t.callGasLimit,w.verificationGasLimit=t.verificationGasLimit,w.preVerificationGas=t.preVerificationGas}return(0,n.A)((0,n.A)({},w),{},{signature:"0x"})}({accountContract:r,adminAddress:s,bundlerOptions:m,callData:f,callGasLimit:h,factoryContract:i,isDeployed:v,maxFeePerGas:g,maxPriorityFeePerGas:P,nonce:A,overrides:o,sponsorGas:c,waitForDeployment:d})}async function Tt(t){var a;const{executeTx:e,bundlerOptions:n,chain:r,client:i}=t;let{maxFeePerGas:s,maxPriorityFeePerGas:o}=e;const c=null!==(a=null===n||void 0===n?void 0:n.bundlerUrl)&&void 0!==a?a:(0,R.RZ)(r);if((0,ct.Lj)(c)){const t=await(0,z.fB)({options:n});s=t.maxFeePerGas,o=t.maxPriorityFeePerGas}else{const[t,a]=await Promise.all([(0,K.r)(s),(0,K.r)(o)]);if(t&&a)s=t,o=a;else{var d,l;const e=await(0,nt.G)(i,r);o=null!==(d=null!==a&&void 0!==a?a:e.maxPriorityFeePerGas)&&void 0!==d?d:0n,s=null!==(l=null!==t&&void 0!==t?t:e.maxFeePerGas)&&void 0!==l?l:0n}}return{maxFeePerGas:s,maxPriorityFeePerGas:o}}async function Ct(t){const{userOp:a,chain:e,entrypointAddress:r,adminAccount:i}=t,s=await async function(t){const{userOp:a,chain:e,entrypointAddress:n}=t,r=(0,R.Fn)(n||R.uh);let i;if("v0.7"===r){const r=ft(a);i=await async function(t){return(0,c.readContract)({contract:t.contract,method:[tt,at,et],params:[t.userOp]})}({contract:(0,o.P)({address:n||R.nF,chain:e,client:t.client}),userOp:r})}else i=await async function(t){return(0,c.readContract)({contract:t.contract,method:[Z,_,X],params:[t.userOp]})}({contract:(0,o.P)({address:n||R.uh,chain:e,client:t.client}),userOp:a});return i}({chain:e,client:t.client,entrypointAddress:r,userOp:a});if(i.signMessage){const t=await i.signMessage({chainId:e.id,message:{raw:(0,ot.aT)(s)},originalMessage:(0,lt.A)(a)});return(0,n.A)((0,n.A)({},a),{},{signature:t})}throw new Error("signMessage not implemented in signingAccount")}async function bt(t){const{accountContract:a,chain:e,client:n,entrypointAddress:r,getNonceOverride:i}=t;return i?i(a):await async function(t){return(0,c.readContract)({contract:t.contract,method:[Q,$,J],params:[t.sender,t.key]})}({contract:(0,o.P)({address:r||R.uh,chain:e,client:n}),key:(0,ht.t)(),sender:a.address})}async function Ot(t){const a=Date.now();for(;xt(t);){if(Date.now()-a>6e4)throw Pt(t),new Error("Account deployment is taking too long (over 1 minute). Please try again.");await new Promise(t=>setTimeout(t,500))}}const Dt=new WeakMap,Vt=new WeakMap;async function Ft(t,a){var r,p,m,y,v,f,h,A;const{personalAccount:G,client:g}=t;if(!G)throw new Error("No personal account provided for smart account connection");const P=a,x=a.chain,L="gasless"in P?P.gasless:P.sponsorGas;if(await(0,B.k)(x))return[kt({chain:x,connectionOptions:t,creationOptions:a,sponsorGas:L}),x];if(P.factoryAddress&&(null===(r=P.overrides)||void 0===r||!r.entrypointAddress)){const t=await async function(t,a,e){const n=(0,o.P)({address:t,chain:e,client:a});try{return await(0,c.readContract)({contract:n,method:"function entrypoint() public view returns (address)"})}catch(r){return}}(P.factoryAddress,g,x);t&&(P.overrides=(0,n.A)((0,n.A)({},P.overrides),{},{entrypointAddress:t}))}null===(p=P.overrides)||void 0===p||!p.tokenPaymaster||null!==(m=P.overrides)&&void 0!==m&&m.entrypointAddress||(P.overrides=(0,n.A)((0,n.A)({},P.overrides),{},{entrypointAddress:R.nF}));const T=null!==(y=P.factoryAddress)&&void 0!==y?y:(0,R.Fd)(null===(v=P.overrides)||void 0===v?void 0:v.entrypointAddress),C=(0,o.P)({address:T,chain:x,client:g}),b=await(0,W.Mi)({accountAddress:null===(f=P.overrides)||void 0===f?void 0:f.accountAddress,accountSalt:null===(h=P.overrides)||void 0===h?void 0:h.accountSalt,adminAddress:G.address,factoryContract:C,predictAddressOverride:null===(A=P.overrides)||void 0===A?void 0:A.predictAddress}).then(t=>t).catch(t=>{throw new Error("Failed to get account address with factory contract ".concat(C.address," on chain ID ").concat(x.id,": ").concat((null===t||void 0===t?void 0:t.message)||"unknown error"),{cause:t})}),O=(0,o.P)({address:b,chain:x,client:g}),D=await async function(t){var a;const r=null===(a=t.overrides)||void 0===a?void 0:a.tokenPaymaster;var p;if(r&&"v0.7"!==(0,R.Fn)((null===(p=t.overrides)||void 0===p?void 0:p.entrypointAddress)||R.uh))throw new Error("Token paymaster is only supported for entrypoint version v0.7");const m=t.sponsorGas;let y=t.accountContract;const v={address:(0,H.bv)(y.address),async onTransactionRequested(a){var e,n;return null===(e=(n=t.personalAccount).onTransactionRequested)||void 0===e?void 0:e.call(n,a)},async sendBatchTransaction(a){var e,r,o;const c=(0,W.zi)({accountContract:y,executeBatchOverride:null===(e=t.overrides)||void 0===e?void 0:e.executeBatch,transactions:a});if(0===a.length)throw new Error("No transactions to send");const d=a[0];if(!d)throw new Error("No transactions to send");const l=(0,s.Q4)(d.chainId),u=await It({executeTx:c,options:(0,n.A)((0,n.A)({},t),{},{accountContract:y,chain:l})});return(0,i.E)({chainId:l.id,client:t.client,contractAddress:null!==(r=null===(o=a[0])||void 0===o?void 0:o.to)&&void 0!==r?r:void 0,transactionHash:u.transactionHash,walletAddress:t.accountContract.address,walletType:"smart"}),u},async sendTransaction(a){var e,p;let m;if(r){var f;await async function(t){var a;const{accountContract:e,erc20Paymaster:r,options:i}=t,s=r.tokenAddress,p=(0,o.P)({address:s,chain:e.chain,client:e.client}),m=await async function(t){return(0,c.readContract)({contract:t.contract,method:[d,l,u],params:[t.owner,t.spender]})}({contract:p,owner:e.address,spender:r.paymasterAddress});if(m>0n)return;const y=w({amountWei:U-1n,contract:p,spender:r.paymasterAddress}),v=await(0,q.$)({from:e.address,transaction:y}),f=(0,W.Lc)({accountContract:e,executeOverride:null===(a=i.overrides)||void 0===a?void 0:a.execute,transaction:v});await It({executeTx:f,options:(0,n.A)((0,n.A)({},i),{},{overrides:(0,n.A)((0,n.A)({},i.overrides),{},{tokenPaymaster:void 0})})})}({accountContract:y,erc20Paymaster:r,options:t});const a=async()=>({paymaster:r.paymasterAddress,paymasterData:"0x"});m=(null===(f=t.overrides)||void 0===f?void 0:f.paymaster)||a}else{var h;m=null===(h=t.overrides)||void 0===h?void 0:h.paymaster}a.chainId!==y.chain.id&&(y=(0,o.P)({address:v.address,chain:(0,s.Q4)(a.chainId),client:t.client}));const A=(0,W.Lc)({accountContract:y,executeOverride:null===(e=t.overrides)||void 0===e?void 0:e.execute,transaction:a}),G=(0,s.Q4)(a.chainId),g=await It({executeTx:A,options:(0,n.A)((0,n.A)({},t),{},{accountContract:y,chain:G,overrides:(0,n.A)((0,n.A)({},t.overrides),{},{paymaster:m})})});return(0,i.E)({chainId:G.id,client:t.client,contractAddress:null!==(p=a.to)&&void 0!==p?p:void 0,transactionHash:g.transactionHash,walletAddress:t.accountContract.address,walletType:"smart"}),g},async signMessage(a){var n;let{message:r}=a;if(null!==(n=t.overrides)&&void 0!==n&&n.signMessage)return t.overrides.signMessage({accountContract:y,adminAccount:t.personalAccount,factoryContract:t.factoryContract,message:r});const{smartAccountSignMessage:i}=await e.e(71965).then(e.bind(e,71965));return i({accountContract:y,factoryContract:t.factoryContract,message:r,options:t})},async signTypedData(a){var n;if(null!==(n=t.overrides)&&void 0!==n&&n.signTypedData)return t.overrides.signTypedData({accountContract:y,adminAccount:t.personalAccount,factoryContract:t.factoryContract,typedData:a});const{smartAccountSignTypedData:r}=await e.e(71965).then(e.bind(e,71965));return r({accountContract:y,factoryContract:t.factoryContract,options:t,typedData:a})},sendCalls:async t=>{const{inAppWalletSendCalls:a}=await e.e(62239).then(e.bind(e,17477)),n=t.calls[0];if(!n)throw new Error("No calls to send");const r=n.client,i=n.chain||t.chain;return{chain:i,client:r,id:await a({account:v,calls:t.calls,chain:i})}},getCallsStatus:async t=>{const{inAppWalletGetCallsStatus:a}=await e.e(62239).then(e.bind(e,17477));return a(t)},getCapabilities:async t=>{var a;return{[null!==(a=t.chainId)&&void 0!==a?a:1]:{atomic:{status:"supported"},paymasterService:{supported:null!==m&&void 0!==m&&m}}}}};return v}((0,n.A)((0,n.A)({},P),{},{accountContract:O,chain:x,client:g,factoryContract:C,personalAccount:G,sponsorGas:L}));if(Dt.set(G,D),Vt.set(D,G),P.sessionKey&&await I({accountContract:O,newPermissions:P.sessionKey.permissions,sessionKeyAddress:P.sessionKey.address})){const t=k({account:G,contract:O,permissions:P.sessionKey.permissions,sessionKeyAddress:P.sessionKey.address});await(0,E.sendTransaction)({account:D,transaction:t})}return[D,x]}async function St(t){const a=Vt.get(t);a&&(Dt.delete(a),Vt.delete(t))}function kt(t){const{creationOptions:a,connectionOptions:r,chain:o}=t,c={address:(0,H.bv)(r.personalAccount.address),async onTransactionRequested(t){var a,e;return null===(a=(e=r.personalAccount).onTransactionRequested)||void 0===a?void 0:a.call(e,t)},async sendTransaction(e){var d,l,u,p,m;const y={chain:(0,s.Q4)(e.chainId),client:r.client,data:e.data,eip712:e.eip712,to:null!==(d=e.to)&&void 0!==d?d:void 0,value:null!==(l=e.value)&&void 0!==l?l:0n};let v=await(0,M.f)({account:c,transaction:y});if(t.sponsorGas&&!v.paymaster){var f,h;const t=await(0,z.qq)({options:{bundlerUrl:null===(f=a.overrides)||void 0===f?void 0:f.bundlerUrl,chain:o,client:r.client,entrypointAddress:null===(h=a.overrides)||void 0===h?void 0:h.entrypointAddress},transaction:v});v=(0,n.A)((0,n.A)({},v),t)}const w=await(0,M.a)({account:c,chainId:o.id,eip712Transaction:v}),A=await(0,z.vx)({options:{bundlerUrl:null===(u=a.overrides)||void 0===u?void 0:u.bundlerUrl,chain:o,client:r.client,entrypointAddress:null===(p=a.overrides)||void 0===p?void 0:p.entrypointAddress},signedTransaction:w,transaction:v});return(0,i.E)({chainId:o.id,client:r.client,contractAddress:null!==(m=e.to)&&void 0!==m?m:void 0,transactionHash:A.transactionHash,walletAddress:c.address,walletType:"smart"}),{chain:o,client:r.client,transactionHash:A.transactionHash}},async signMessage(t){let{message:a}=t;return r.personalAccount.signMessage({message:a})},async signTypedData(t){const a=(0,j.y)(t);return r.personalAccount.signTypedData(a)},sendCalls:async t=>{const{inAppWalletSendCalls:a}=await e.e(62239).then(e.bind(e,17477)),n=t.calls[0];if(!n)throw new Error("No calls to send");const r=n.client,i=n.chain||t.chain;return{chain:i,client:r,id:await a({account:c,calls:t.calls,chain:i})}},getCallsStatus:async t=>{const{inAppWalletGetCallsStatus:a}=await e.e(62239).then(e.bind(e,17477));return a(t)},getCapabilities:async a=>{var e,n;return{[null!==(e=a.chainId)&&void 0!==e?e:1]:{atomic:{status:"unsupported"},paymasterService:{supported:null!==(n=t.sponsorGas)&&void 0!==n&&n}}}}};return c}async function It(t){const{executeTx:a,options:e}=t;try{var s,o,c,d;const t=await Lt({accountContract:e.accountContract,adminAddress:e.personalAccount.address,factoryContract:e.factoryContract,overrides:e.overrides,sponsorGas:e.sponsorGas,transaction:a}),r=await Ct({adminAccount:e.personalAccount,chain:e.chain,client:e.client,entrypointAddress:null===(s=e.overrides)||void 0===s?void 0:s.entrypointAddress,userOp:t}),l={bundlerUrl:null===(o=e.overrides)||void 0===o?void 0:o.bundlerUrl,chain:e.chain,client:e.client,entrypointAddress:null===(c=e.overrides)||void 0===c?void 0:c.entrypointAddress},u=await(0,z.Ro)({options:l,userOp:r}),p=await async function(t){const a=t.timeoutMs||12e4,e=t.intervalMs||1e3,n=Date.now()+a;for(;Date.now()<n;){const a=await(0,z.JI)(t);if(a)return a;await new Promise(t=>setTimeout(t,e))}throw new Error("Timeout waiting for userOp to be mined on chain ".concat(t.chain.id," with UserOp hash: ").concat(t.userOpHash))}((0,n.A)((0,n.A)({},l),{},{userOpHash:u}));return(0,i.E)({chainId:e.chain.id,client:e.client,contractAddress:await(0,K.r)(null!==(d=a.to)&&void 0!==d?d:void 0),transactionHash:p.transactionHash,walletAddress:e.accountContract.address,walletType:"smart"}),{chain:e.chain,client:e.client,transactionHash:p.transactionHash}}catch(u){var l;if((0,r.Y)(u))(0,i.z)({chainId:e.chain.id,client:e.client,contractAddress:await(0,K.r)(null!==(l=a.to)&&void 0!==l?l:void 0),error:u,transactionValue:await(0,K.r)(a.value),walletAddress:e.accountContract.address});throw u}finally{Pt(e.accountContract)}}}}]);
//# sourceMappingURL=99832.5f201f85.chunk.js.map